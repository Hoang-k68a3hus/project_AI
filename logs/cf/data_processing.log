2025-11-20 17:13:55 - data_layer - INFO - ================================================================================
2025-11-20 17:13:55 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 17:13:55 - data_layer - INFO - ================================================================================
2025-11-20 17:13:55 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 17:13:55 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 17:13:55 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 17:13:55 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 17:13:55 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:13:55 - data_layer - INFO - Loading interactions data...
2025-11-20 17:13:57 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:13:57 - data_layer - INFO - 
Loading products data...
2025-11-20 17:13:57 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 17:13:57 - data_layer - INFO - 
Loading attributes data...
2025-11-20 17:13:57 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 17:13:57 - data_layer - INFO - 
Loading shops data...
2025-11-20 17:13:57 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 17:13:57 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:13:57 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 17:13:57 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:13:57 - data_layer - ERROR - Test failed: Missing required columns in interactions: {'comment'}
Available columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
Traceback (most recent call last):
  File "D:\app\IAI\viecomrec\recsys\cf\data.py", line 520, in <module>
    data = load_raw_data("data/published_data")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\app\IAI\viecomrec\recsys\cf\data.py", line 146, in load_raw_data
    _validate_schema(dataframes)
  File "D:\app\IAI\viecomrec\recsys\cf\data.py", line 185, in _validate_schema
    raise ValueError(
ValueError: Missing required columns in interactions: {'comment'}
Available columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 17:14:26 - data_layer - INFO - ================================================================================
2025-11-20 17:14:26 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 17:14:26 - data_layer - INFO - ================================================================================
2025-11-20 17:14:26 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 17:14:26 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 17:14:26 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 17:14:26 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 17:14:26 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:14:26 - data_layer - INFO - Loading interactions data...
2025-11-20 17:14:28 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:14:28 - data_layer - INFO - 
Loading products data...
2025-11-20 17:14:28 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 17:14:28 - data_layer - INFO - 
Loading attributes data...
2025-11-20 17:14:28 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 17:14:28 - data_layer - INFO - 
Loading shops data...
2025-11-20 17:14:28 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 17:14:28 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:14:28 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 17:14:28 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:14:28 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 17:14:28 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 17:14:28 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 17:14:28 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 17:14:28 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 17:14:28 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 17:14:28 - data_layer - INFO - 
================================================================================
2025-11-20 17:14:28 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 17:14:28 - data_layer - INFO - ================================================================================

2025-11-20 17:14:28 - data_layer - INFO - 
================================================================================
2025-11-20 17:14:28 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:14:28 - data_layer - INFO - ================================================================================
2025-11-20 17:14:28 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:14:28 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:14:28 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:14:28 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:14:28 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:14:28 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:14:28 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:14:28 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:14:28 - data_layer - INFO - Converting rating to float...
2025-11-20 17:14:28 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:14:28 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:14:29 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:14:29 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:14:29 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:14:29 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:14:29 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:14:29 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:14:29 - data_layer - WARNING - 
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-11-20 17:14:29 - data_layer - WARNING - CRITICAL: TEMPORAL VALIDATION FAILURE
2025-11-20 17:14:29 - data_layer - WARNING - Found 369,099 rows with NaT/Null timestamps
2025-11-20 17:14:29 - data_layer - WARNING - Dropping these rows to prevent data leakage in train/test split
2025-11-20 17:14:29 - data_layer - WARNING - Reason: Model must not 'see the future' - temporal ordering is essential
2025-11-20 17:14:29 - data_layer - WARNING - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

2025-11-20 17:14:29 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:14:29 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:14:29 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:14:29 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:14:29 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:14:29 - data_layer - INFO -   Min: nan
2025-11-20 17:14:29 - data_layer - INFO -   Max: nan
2025-11-20 17:14:29 - data_layer - INFO -   Mean: nan
2025-11-20 17:14:29 - data_layer - INFO -   Median: nan
2025-11-20 17:14:29 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:14:29 - data_layer - INFO - 
================================================================================
2025-11-20 17:14:29 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:14:29 - data_layer - INFO - ================================================================================
2025-11-20 17:14:29 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:14:29 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:14:29 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:14:29 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:14:29 - data_layer - INFO - Missing timestamp:              369,099
2025-11-20 17:14:29 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:14:29 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:14:29 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:14:29 - data_layer - INFO - Total dropped:                  369,099
2025-11-20 17:14:29 - data_layer - INFO - Final rows:                           0
2025-11-20 17:14:29 - data_layer - INFO - Retention rate:                   0.00%
2025-11-20 17:14:29 - data_layer - INFO - ================================================================================

2025-11-20 17:14:29 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:14:29 - data_layer - INFO - 
================================================================================
2025-11-20 17:14:29 - data_layer - INFO - DATA QUALITY REPORT: Cleaned Interactions
2025-11-20 17:14:29 - data_layer - INFO - ================================================================================
2025-11-20 17:14:29 - data_layer - INFO - Shape: 0 rows × 10 columns
2025-11-20 17:14:29 - data_layer - INFO - Memory usage: 0.00 MB
2025-11-20 17:14:29 - data_layer - INFO - 
Missing values:
2025-11-20 17:14:29 - data_layer - INFO -   ✓ No missing values
2025-11-20 17:14:29 - data_layer - INFO - 
Data types:
2025-11-20 17:14:29 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:14:29 - data_layer - INFO -   user_id: int64
2025-11-20 17:14:29 - data_layer - INFO -   product_id: int64
2025-11-20 17:14:29 - data_layer - INFO -   rating: int64
2025-11-20 17:14:29 - data_layer - INFO -   product_name_x: object
2025-11-20 17:14:29 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:14:29 - data_layer - INFO -   shop_id: int64
2025-11-20 17:14:29 - data_layer - INFO -   variation_x: object
2025-11-20 17:14:29 - data_layer - INFO -   product_quality: float64
2025-11-20 17:14:29 - data_layer - INFO -   processed_comment: object
2025-11-20 17:14:29 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:14:29 - data_layer - INFO - ================================================================================

2025-11-20 17:14:29 - data_layer - INFO - Data hash (MD5): 96d7181dfe70707189537a4136cd69d7
2025-11-20 17:15:10 - data_layer - INFO - ================================================================================
2025-11-20 17:15:10 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 17:15:10 - data_layer - INFO - ================================================================================
2025-11-20 17:15:10 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 17:15:10 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 17:15:10 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 17:15:10 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 17:15:10 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:15:10 - data_layer - INFO - Loading interactions data...
2025-11-20 17:15:12 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:15:12 - data_layer - INFO - 
Loading products data...
2025-11-20 17:15:12 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 17:15:12 - data_layer - INFO - 
Loading attributes data...
2025-11-20 17:15:12 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 17:15:12 - data_layer - INFO - 
Loading shops data...
2025-11-20 17:15:12 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 17:15:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:15:12 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 17:15:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:15:12 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 17:15:12 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 17:15:12 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 17:15:12 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 17:15:12 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 17:15:12 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 17:15:12 - data_layer - INFO - 
================================================================================
2025-11-20 17:15:12 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 17:15:12 - data_layer - INFO - ================================================================================

2025-11-20 17:15:12 - data_layer - INFO - 
================================================================================
2025-11-20 17:15:12 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:15:12 - data_layer - INFO - ================================================================================
2025-11-20 17:15:12 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:15:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:15:12 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:15:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:15:12 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:15:12 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:15:12 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:15:12 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:15:12 - data_layer - INFO - Converting rating to float...
2025-11-20 17:15:12 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:15:12 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:15:13 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:15:13 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:15:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:15:13 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:15:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:15:13 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:15:13 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:15:13 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:15:13 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:15:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:15:13 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:15:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:15:13 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:15:13 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:15:13 - data_layer - INFO -   Min: 1.00
2025-11-20 17:15:13 - data_layer - INFO -   Max: 5.00
2025-11-20 17:15:13 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:15:13 - data_layer - INFO -   Median: 5.00
2025-11-20 17:15:13 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:15:13 - data_layer - INFO - 
================================================================================
2025-11-20 17:15:13 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:15:13 - data_layer - INFO - ================================================================================
2025-11-20 17:15:13 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:15:13 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:15:13 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:15:13 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:15:13 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:15:13 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:15:13 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:15:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:15:13 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:15:13 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:15:13 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:15:13 - data_layer - INFO - ================================================================================

2025-11-20 17:15:13 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:15:13 - data_layer - INFO - 
================================================================================
2025-11-20 17:15:13 - data_layer - INFO - DATA QUALITY REPORT: Cleaned Interactions
2025-11-20 17:15:13 - data_layer - INFO - ================================================================================
2025-11-20 17:15:13 - data_layer - INFO - Shape: 369,099 rows × 10 columns
2025-11-20 17:15:13 - data_layer - INFO - Memory usage: 205.65 MB
2025-11-20 17:15:13 - data_layer - INFO - 
Missing values:
2025-11-20 17:15:13 - data_layer - INFO -   processed_comment: 9,681 (2.62%)
2025-11-20 17:15:13 - data_layer - INFO - 
Data types:
2025-11-20 17:15:13 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:15:13 - data_layer - INFO -   user_id: int64
2025-11-20 17:15:13 - data_layer - INFO -   product_id: int64
2025-11-20 17:15:13 - data_layer - INFO -   rating: int64
2025-11-20 17:15:13 - data_layer - INFO -   product_name_x: object
2025-11-20 17:15:13 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:15:13 - data_layer - INFO -   shop_id: int64
2025-11-20 17:15:13 - data_layer - INFO -   variation_x: object
2025-11-20 17:15:13 - data_layer - INFO -   product_quality: float64
2025-11-20 17:15:13 - data_layer - INFO -   processed_comment: object
2025-11-20 17:15:13 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:15:13 - data_layer - INFO -   Rating 1: 2,271 (0.62%)
2025-11-20 17:15:13 - data_layer - INFO -   Rating 2: 1,308 (0.35%)
2025-11-20 17:15:13 - data_layer - INFO -   Rating 3: 3,207 (0.87%)
2025-11-20 17:15:13 - data_layer - INFO -   Rating 4: 9,147 (2.48%)
2025-11-20 17:15:13 - data_layer - INFO -   Rating 5: 353,166 (95.68%)
2025-11-20 17:15:13 - data_layer - INFO - ================================================================================

2025-11-20 17:15:20 - data_layer - INFO - Data hash (MD5): 1450854526d03565c85f094b917f70a3
2025-11-20 17:15:22 - data_layer - INFO - ================================================================================
2025-11-20 17:15:22 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 17:15:22 - data_layer - INFO - ================================================================================
2025-11-20 17:15:22 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 17:15:22 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 17:15:22 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 17:15:22 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 17:15:22 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:15:22 - data_layer - INFO - Loading interactions data...
2025-11-20 17:15:24 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:15:24 - data_layer - INFO - 
Loading products data...
2025-11-20 17:15:24 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 17:15:24 - data_layer - INFO - 
Loading attributes data...
2025-11-20 17:15:24 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 17:15:24 - data_layer - INFO - 
Loading shops data...
2025-11-20 17:15:24 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 17:15:24 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:15:24 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 17:15:24 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:15:24 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 17:15:24 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 17:15:24 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 17:15:24 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 17:15:24 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 17:15:24 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 17:15:24 - data_layer - INFO - 
================================================================================
2025-11-20 17:15:24 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 17:15:24 - data_layer - INFO - ================================================================================

2025-11-20 17:15:24 - data_layer - INFO - 
================================================================================
2025-11-20 17:15:24 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:15:24 - data_layer - INFO - ================================================================================
2025-11-20 17:15:24 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:15:24 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:15:24 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:15:24 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:15:24 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:15:24 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:15:24 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:15:24 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:15:24 - data_layer - INFO - Converting rating to float...
2025-11-20 17:15:24 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:15:24 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:15:25 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:15:25 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:15:25 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:15:25 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:15:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:15:25 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:15:25 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:15:25 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:15:25 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:15:25 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:15:25 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:15:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:15:25 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:15:25 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:15:25 - data_layer - INFO -   Min: 1.00
2025-11-20 17:15:25 - data_layer - INFO -   Max: 5.00
2025-11-20 17:15:25 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:15:25 - data_layer - INFO -   Median: 5.00
2025-11-20 17:15:25 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:15:25 - data_layer - INFO - 
================================================================================
2025-11-20 17:15:25 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:15:25 - data_layer - INFO - ================================================================================
2025-11-20 17:15:25 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:15:25 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:15:25 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:15:25 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:15:25 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:15:25 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:15:25 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:15:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:15:25 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:15:25 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:15:25 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:15:25 - data_layer - INFO - ================================================================================

2025-11-20 17:15:25 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:15:25 - data_layer - INFO - 
================================================================================
2025-11-20 17:15:25 - data_layer - INFO - DATA QUALITY REPORT: Cleaned Interactions
2025-11-20 17:15:25 - data_layer - INFO - ================================================================================
2025-11-20 17:15:25 - data_layer - INFO - Shape: 369,099 rows × 10 columns
2025-11-20 17:15:25 - data_layer - INFO - Memory usage: 205.65 MB
2025-11-20 17:15:25 - data_layer - INFO - 
Missing values:
2025-11-20 17:15:25 - data_layer - INFO -   processed_comment: 9,681 (2.62%)
2025-11-20 17:15:25 - data_layer - INFO - 
Data types:
2025-11-20 17:15:25 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:15:25 - data_layer - INFO -   user_id: int64
2025-11-20 17:15:25 - data_layer - INFO -   product_id: int64
2025-11-20 17:15:25 - data_layer - INFO -   rating: int64
2025-11-20 17:15:25 - data_layer - INFO -   product_name_x: object
2025-11-20 17:15:25 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:15:25 - data_layer - INFO -   shop_id: int64
2025-11-20 17:15:25 - data_layer - INFO -   variation_x: object
2025-11-20 17:15:25 - data_layer - INFO -   product_quality: float64
2025-11-20 17:15:25 - data_layer - INFO -   processed_comment: object
2025-11-20 17:15:25 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:15:25 - data_layer - INFO -   Rating 1: 2,271 (0.62%)
2025-11-20 17:15:25 - data_layer - INFO -   Rating 2: 1,308 (0.35%)
2025-11-20 17:15:25 - data_layer - INFO -   Rating 3: 3,207 (0.87%)
2025-11-20 17:15:25 - data_layer - INFO -   Rating 4: 9,147 (2.48%)
2025-11-20 17:15:25 - data_layer - INFO -   Rating 5: 353,166 (95.68%)
2025-11-20 17:15:25 - data_layer - INFO - ================================================================================

2025-11-20 17:15:31 - data_layer - INFO - Data hash (MD5): 1450854526d03565c85f094b917f70a3
2025-11-20 17:15:31 - data_layer - ERROR - Test failed: 'charmap' codec can't encode character '\u2713' in position 0: character maps to <undefined>
Traceback (most recent call last):
  File "D:\app\IAI\viecomrec\recsys\cf\data.py", line 560, in <module>
    print("✓ ALL TESTS PASSED")
  File "C:\Users\maihu\AppData\Local\Programs\Python\Python312\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u2713' in position 0: character maps to <undefined>
2025-11-20 17:16:05 - data_layer - INFO - ================================================================================
2025-11-20 17:16:05 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 17:16:05 - data_layer - INFO - ================================================================================
2025-11-20 17:16:05 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 17:16:05 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 17:16:05 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 17:16:05 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 17:16:05 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:16:05 - data_layer - INFO - Loading interactions data...
2025-11-20 17:16:07 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:16:07 - data_layer - INFO - 
Loading products data...
2025-11-20 17:16:07 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 17:16:07 - data_layer - INFO - 
Loading attributes data...
2025-11-20 17:16:07 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 17:16:07 - data_layer - INFO - 
Loading shops data...
2025-11-20 17:16:07 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 17:16:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:16:07 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 17:16:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:16:07 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 17:16:07 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 17:16:07 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 17:16:07 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 17:16:07 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 17:16:07 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 17:16:07 - data_layer - INFO - 
================================================================================
2025-11-20 17:16:07 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 17:16:07 - data_layer - INFO - ================================================================================

2025-11-20 17:16:07 - data_layer - INFO - 
================================================================================
2025-11-20 17:16:07 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:16:07 - data_layer - INFO - ================================================================================
2025-11-20 17:16:07 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:16:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:16:07 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:16:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:16:07 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:16:07 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:16:07 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:16:07 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:16:07 - data_layer - INFO - Converting rating to float...
2025-11-20 17:16:07 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:16:07 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:16:07 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:16:07 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:16:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:16:07 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:16:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:16:07 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:16:07 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:16:07 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:16:07 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:16:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:16:07 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:16:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:16:07 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:16:07 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:16:07 - data_layer - INFO -   Min: 1.00
2025-11-20 17:16:07 - data_layer - INFO -   Max: 5.00
2025-11-20 17:16:07 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:16:07 - data_layer - INFO -   Median: 5.00
2025-11-20 17:16:07 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:16:07 - data_layer - INFO - 
================================================================================
2025-11-20 17:16:07 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:16:07 - data_layer - INFO - ================================================================================
2025-11-20 17:16:07 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:16:07 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:16:07 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:16:07 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:16:07 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:16:07 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:16:07 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:16:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:16:07 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:16:07 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:16:07 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:16:07 - data_layer - INFO - ================================================================================

2025-11-20 17:16:08 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:16:08 - data_layer - INFO - 
================================================================================
2025-11-20 17:16:08 - data_layer - INFO - DATA QUALITY REPORT: Cleaned Interactions
2025-11-20 17:16:08 - data_layer - INFO - ================================================================================
2025-11-20 17:16:08 - data_layer - INFO - Shape: 369,099 rows × 10 columns
2025-11-20 17:16:08 - data_layer - INFO - Memory usage: 205.65 MB
2025-11-20 17:16:08 - data_layer - INFO - 
Missing values:
2025-11-20 17:16:08 - data_layer - INFO -   processed_comment: 9,681 (2.62%)
2025-11-20 17:16:08 - data_layer - INFO - 
Data types:
2025-11-20 17:16:08 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:16:08 - data_layer - INFO -   user_id: int64
2025-11-20 17:16:08 - data_layer - INFO -   product_id: int64
2025-11-20 17:16:08 - data_layer - INFO -   rating: int64
2025-11-20 17:16:08 - data_layer - INFO -   product_name_x: object
2025-11-20 17:16:08 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:16:08 - data_layer - INFO -   shop_id: int64
2025-11-20 17:16:08 - data_layer - INFO -   variation_x: object
2025-11-20 17:16:08 - data_layer - INFO -   product_quality: float64
2025-11-20 17:16:08 - data_layer - INFO -   processed_comment: object
2025-11-20 17:16:08 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:16:08 - data_layer - INFO -   Rating 1: 2,271 (0.62%)
2025-11-20 17:16:08 - data_layer - INFO -   Rating 2: 1,308 (0.35%)
2025-11-20 17:16:08 - data_layer - INFO -   Rating 3: 3,207 (0.87%)
2025-11-20 17:16:08 - data_layer - INFO -   Rating 4: 9,147 (2.48%)
2025-11-20 17:16:08 - data_layer - INFO -   Rating 5: 353,166 (95.68%)
2025-11-20 17:16:08 - data_layer - INFO - ================================================================================

2025-11-20 17:16:19 - data_layer - INFO - Data hash (MD5): 1450854526d03565c85f094b917f70a3
2025-11-20 17:23:34 - data_layer - INFO - Loading interactions data...
2025-11-20 17:23:36 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:23:36 - data_layer - INFO - 
================================================================================
2025-11-20 17:23:36 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:23:36 - data_layer - INFO - ================================================================================
2025-11-20 17:23:36 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:23:36 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:23:36 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:23:36 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:23:36 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:23:36 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:23:36 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:23:36 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:23:36 - data_layer - INFO - Converting rating to float...
2025-11-20 17:23:36 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:23:36 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:23:36 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:23:36 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:23:36 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:23:36 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:23:36 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:23:36 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:23:36 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:23:36 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:23:36 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:23:36 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:23:36 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:23:36 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:23:36 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:23:36 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:23:36 - data_layer - INFO -   Min: 1.00
2025-11-20 17:23:36 - data_layer - INFO -   Max: 5.00
2025-11-20 17:23:36 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:23:36 - data_layer - INFO -   Median: 5.00
2025-11-20 17:23:36 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:23:36 - data_layer - INFO - 
================================================================================
2025-11-20 17:23:36 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:23:37 - data_layer - INFO - ================================================================================
2025-11-20 17:23:37 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:23:37 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:23:37 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:23:37 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:23:37 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:23:37 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:23:37 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:23:37 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:23:37 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:23:37 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:23:37 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:23:37 - data_layer - INFO - ================================================================================

2025-11-20 17:23:37 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:23:37 - data_layer - INFO - 
================================================================================
2025-11-20 17:23:37 - data_layer - INFO - DATA QUALITY REPORT: Cleaned Interactions
2025-11-20 17:23:37 - data_layer - INFO - ================================================================================
2025-11-20 17:23:37 - data_layer - INFO - Shape: 369,099 rows × 10 columns
2025-11-20 17:23:37 - data_layer - INFO - Memory usage: 205.65 MB
2025-11-20 17:23:37 - data_layer - INFO - 
Missing values:
2025-11-20 17:23:37 - data_layer - INFO -   processed_comment: 9,681 (2.62%)
2025-11-20 17:23:37 - data_layer - INFO - 
Data types:
2025-11-20 17:23:37 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:23:37 - data_layer - INFO -   user_id: int64
2025-11-20 17:23:37 - data_layer - INFO -   product_id: int64
2025-11-20 17:23:37 - data_layer - INFO -   rating: int64
2025-11-20 17:23:37 - data_layer - INFO -   product_name_x: object
2025-11-20 17:23:37 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:23:37 - data_layer - INFO -   shop_id: int64
2025-11-20 17:23:37 - data_layer - INFO -   variation_x: object
2025-11-20 17:23:37 - data_layer - INFO -   product_quality: float64
2025-11-20 17:23:37 - data_layer - INFO -   processed_comment: object
2025-11-20 17:23:37 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:23:37 - data_layer - INFO -   Rating 1: 2,271 (0.62%)
2025-11-20 17:23:37 - data_layer - INFO -   Rating 2: 1,308 (0.35%)
2025-11-20 17:23:37 - data_layer - INFO -   Rating 3: 3,207 (0.87%)
2025-11-20 17:23:37 - data_layer - INFO -   Rating 4: 9,147 (2.48%)
2025-11-20 17:23:37 - data_layer - INFO -   Rating 5: 353,166 (95.68%)
2025-11-20 17:23:37 - data_layer - INFO - ================================================================================

2025-11-20 17:23:43 - data_layer - INFO - Data hash (MD5): 1450854526d03565c85f094b917f70a3
2025-11-20 17:27:09 - data_layer - INFO - Loading interactions data...
2025-11-20 17:27:10 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:27:10 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:10 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:27:10 - data_layer - INFO - ================================================================================
2025-11-20 17:27:10 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:27:10 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:10 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:27:10 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:10 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:27:10 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:27:10 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:27:10 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:27:10 - data_layer - INFO - Converting rating to float...
2025-11-20 17:27:10 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:27:10 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:27:11 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:11 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:11 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:11 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:27:11 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:11 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:27:11 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:27:11 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:27:11 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:27:11 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:11 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:27:11 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:11 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:27:11 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:27:11 - data_layer - INFO -   Min: 1.00
2025-11-20 17:27:11 - data_layer - INFO -   Max: 5.00
2025-11-20 17:27:11 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:27:11 - data_layer - INFO -   Median: 5.00
2025-11-20 17:27:11 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:27:11 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:11 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:27:11 - data_layer - INFO - ================================================================================
2025-11-20 17:27:11 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:27:11 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:27:11 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:27:11 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:27:11 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:27:11 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:27:11 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:27:11 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:11 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:27:11 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:27:11 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:27:11 - data_layer - INFO - ================================================================================

2025-11-20 17:27:11 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:27:11 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:11 - data_layer - INFO - DATA QUALITY REPORT: Cleaned Interactions
2025-11-20 17:27:11 - data_layer - INFO - ================================================================================
2025-11-20 17:27:11 - data_layer - INFO - Shape: 369,099 rows × 10 columns
2025-11-20 17:27:11 - data_layer - INFO - Memory usage: 205.65 MB
2025-11-20 17:27:11 - data_layer - INFO - 
Missing values:
2025-11-20 17:27:11 - data_layer - INFO -   processed_comment: 9,681 (2.62%)
2025-11-20 17:27:11 - data_layer - INFO - 
Data types:
2025-11-20 17:27:11 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:27:11 - data_layer - INFO -   user_id: int64
2025-11-20 17:27:11 - data_layer - INFO -   product_id: int64
2025-11-20 17:27:11 - data_layer - INFO -   rating: int64
2025-11-20 17:27:11 - data_layer - INFO -   product_name_x: object
2025-11-20 17:27:11 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:27:11 - data_layer - INFO -   shop_id: int64
2025-11-20 17:27:11 - data_layer - INFO -   variation_x: object
2025-11-20 17:27:11 - data_layer - INFO -   product_quality: float64
2025-11-20 17:27:11 - data_layer - INFO -   processed_comment: object
2025-11-20 17:27:11 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:27:11 - data_layer - INFO -   Rating 1: 2,271 (0.62%)
2025-11-20 17:27:11 - data_layer - INFO -   Rating 2: 1,308 (0.35%)
2025-11-20 17:27:11 - data_layer - INFO -   Rating 3: 3,207 (0.87%)
2025-11-20 17:27:11 - data_layer - INFO -   Rating 4: 9,147 (2.48%)
2025-11-20 17:27:11 - data_layer - INFO -   Rating 5: 353,166 (95.68%)
2025-11-20 17:27:11 - data_layer - INFO - ================================================================================

2025-11-20 17:27:17 - data_layer - INFO - Loading interactions data...
2025-11-20 17:27:19 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:27:19 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:19 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:27:19 - data_layer - INFO - ================================================================================
2025-11-20 17:27:19 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:27:19 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:19 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:27:19 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:19 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:27:19 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:27:19 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:27:19 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:27:19 - data_layer - INFO - Converting rating to float...
2025-11-20 17:27:19 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:27:19 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:27:19 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:19 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:19 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:19 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:27:19 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:19 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:27:19 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:27:19 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:27:19 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:27:19 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:19 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:27:19 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:19 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:27:19 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:27:19 - data_layer - INFO -   Min: 1.00
2025-11-20 17:27:19 - data_layer - INFO -   Max: 5.00
2025-11-20 17:27:19 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:27:19 - data_layer - INFO -   Median: 5.00
2025-11-20 17:27:19 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:27:19 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:19 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:27:19 - data_layer - INFO - ================================================================================
2025-11-20 17:27:19 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:27:19 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:27:19 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:27:19 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:27:19 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:27:19 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:27:19 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:27:19 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:19 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:27:19 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:27:19 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:27:19 - data_layer - INFO - ================================================================================

2025-11-20 17:27:19 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:27:19 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:19 - data_layer - INFO - DATA QUALITY REPORT: Cleaned Interactions
2025-11-20 17:27:19 - data_layer - INFO - ================================================================================
2025-11-20 17:27:19 - data_layer - INFO - Shape: 369,099 rows × 10 columns
2025-11-20 17:27:20 - data_layer - INFO - Memory usage: 205.65 MB
2025-11-20 17:27:20 - data_layer - INFO - 
Missing values:
2025-11-20 17:27:20 - data_layer - INFO -   processed_comment: 9,681 (2.62%)
2025-11-20 17:27:20 - data_layer - INFO - 
Data types:
2025-11-20 17:27:20 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:27:20 - data_layer - INFO -   user_id: int64
2025-11-20 17:27:20 - data_layer - INFO -   product_id: int64
2025-11-20 17:27:20 - data_layer - INFO -   rating: int64
2025-11-20 17:27:20 - data_layer - INFO -   product_name_x: object
2025-11-20 17:27:20 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:27:20 - data_layer - INFO -   shop_id: int64
2025-11-20 17:27:20 - data_layer - INFO -   variation_x: object
2025-11-20 17:27:20 - data_layer - INFO -   product_quality: float64
2025-11-20 17:27:20 - data_layer - INFO -   processed_comment: object
2025-11-20 17:27:20 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:27:20 - data_layer - INFO -   Rating 1: 2,271 (0.62%)
2025-11-20 17:27:20 - data_layer - INFO -   Rating 2: 1,308 (0.35%)
2025-11-20 17:27:20 - data_layer - INFO -   Rating 3: 3,207 (0.87%)
2025-11-20 17:27:20 - data_layer - INFO -   Rating 4: 9,147 (2.48%)
2025-11-20 17:27:20 - data_layer - INFO -   Rating 5: 353,166 (95.68%)
2025-11-20 17:27:20 - data_layer - INFO - ================================================================================

2025-11-20 17:27:27 - data_layer - INFO - Loading interactions data...
2025-11-20 17:27:29 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:27:29 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:29 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:27:29 - data_layer - INFO - ================================================================================
2025-11-20 17:27:29 - data_layer - INFO - Initial row count: 1,000
2025-11-20 17:27:29 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:29 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:27:29 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:29 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:27:29 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:27:29 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:27:29 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:27:29 - data_layer - INFO - Converting rating to float...
2025-11-20 17:27:29 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:27:29 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:27:29 - data_layer - INFO - ✓ Parsed 1,000 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:29 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:29 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:29 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:27:29 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:29 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:27:29 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:27:29 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:27:29 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:27:29 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:29 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:27:29 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:29 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:27:29 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:27:29 - data_layer - INFO -   Min: 1.00
2025-11-20 17:27:29 - data_layer - INFO -   Max: 5.00
2025-11-20 17:27:29 - data_layer - INFO -   Mean: 4.82
2025-11-20 17:27:29 - data_layer - INFO -   Median: 5.00
2025-11-20 17:27:29 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:27:29 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:29 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:27:29 - data_layer - INFO - ================================================================================
2025-11-20 17:27:29 - data_layer - INFO - Initial rows:                     1,000
2025-11-20 17:27:29 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:27:29 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:27:29 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:27:29 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:27:29 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:27:29 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:27:29 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:29 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:27:29 - data_layer - INFO - Final rows:                       1,000
2025-11-20 17:27:29 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:27:29 - data_layer - INFO - ================================================================================

2025-11-20 17:27:29 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:27:29 - data_layer - INFO - ================================================================================
2025-11-20 17:27:29 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 17:27:29 - data_layer - INFO - ================================================================================
2025-11-20 17:27:29 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 17:27:29 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 17:27:29 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 17:27:29 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 17:27:29 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:29 - data_layer - INFO - Loading interactions data...
2025-11-20 17:27:31 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:27:31 - data_layer - INFO - 
Loading products data...
2025-11-20 17:27:31 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 17:27:31 - data_layer - INFO - 
Loading attributes data...
2025-11-20 17:27:31 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 17:27:31 - data_layer - INFO - 
Loading shops data...
2025-11-20 17:27:31 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 17:27:31 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:31 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 17:27:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:31 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 17:27:31 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 17:27:31 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 17:27:31 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 17:27:31 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 17:27:31 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 17:27:31 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:31 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 17:27:31 - data_layer - INFO - ================================================================================

2025-11-20 17:27:31 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:31 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:27:31 - data_layer - INFO - ================================================================================
2025-11-20 17:27:31 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:27:31 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:31 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:27:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:31 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:27:31 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:27:31 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:27:31 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:27:31 - data_layer - INFO - Converting rating to float...
2025-11-20 17:27:31 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:27:31 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:27:32 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:32 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:32 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:32 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:27:32 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:32 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:27:32 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:27:32 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:27:32 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:27:32 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:32 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:27:32 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:32 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:27:32 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:27:32 - data_layer - INFO -   Min: 1.00
2025-11-20 17:27:32 - data_layer - INFO -   Max: 5.00
2025-11-20 17:27:32 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:27:32 - data_layer - INFO -   Median: 5.00
2025-11-20 17:27:32 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:27:32 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:32 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:27:32 - data_layer - INFO - ================================================================================
2025-11-20 17:27:32 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:27:32 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:27:32 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:27:32 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:27:32 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:27:32 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:27:32 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:27:32 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:32 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:27:32 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:27:32 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:27:32 - data_layer - INFO - ================================================================================

2025-11-20 17:27:32 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:27:37 - data_layer - INFO - Loading interactions data...
2025-11-20 17:27:39 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:27:39 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:39 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:27:39 - data_layer - INFO - ================================================================================
2025-11-20 17:27:39 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:27:39 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:39 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:27:39 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:39 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:27:39 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:27:39 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:27:39 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:27:39 - data_layer - INFO - Converting rating to float...
2025-11-20 17:27:39 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:27:39 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:27:39 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:39 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:39 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:39 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:27:39 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:39 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:27:39 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:27:39 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:27:39 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:27:39 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:39 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:27:39 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:39 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:27:39 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:27:39 - data_layer - INFO -   Min: 1.00
2025-11-20 17:27:39 - data_layer - INFO -   Max: 5.00
2025-11-20 17:27:39 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:27:39 - data_layer - INFO -   Median: 5.00
2025-11-20 17:27:39 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:27:39 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:39 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:27:39 - data_layer - INFO - ================================================================================
2025-11-20 17:27:39 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:27:39 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:27:39 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:27:39 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:27:39 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:27:39 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:27:39 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:27:39 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:39 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:27:39 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:27:39 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:27:39 - data_layer - INFO - ================================================================================

2025-11-20 17:27:39 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:27:39 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:39 - data_layer - INFO - DATA QUALITY REPORT: Cleaned Interactions
2025-11-20 17:27:39 - data_layer - INFO - ================================================================================
2025-11-20 17:27:39 - data_layer - INFO - Shape: 369,099 rows × 10 columns
2025-11-20 17:27:40 - data_layer - INFO - Memory usage: 205.65 MB
2025-11-20 17:27:40 - data_layer - INFO - 
Missing values:
2025-11-20 17:27:40 - data_layer - INFO -   processed_comment: 9,681 (2.62%)
2025-11-20 17:27:40 - data_layer - INFO - 
Data types:
2025-11-20 17:27:40 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:27:40 - data_layer - INFO -   user_id: int64
2025-11-20 17:27:40 - data_layer - INFO -   product_id: int64
2025-11-20 17:27:40 - data_layer - INFO -   rating: int64
2025-11-20 17:27:40 - data_layer - INFO -   product_name_x: object
2025-11-20 17:27:40 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:27:40 - data_layer - INFO -   shop_id: int64
2025-11-20 17:27:40 - data_layer - INFO -   variation_x: object
2025-11-20 17:27:40 - data_layer - INFO -   product_quality: float64
2025-11-20 17:27:40 - data_layer - INFO -   processed_comment: object
2025-11-20 17:27:40 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:27:40 - data_layer - INFO -   Rating 1: 2,271 (0.62%)
2025-11-20 17:27:40 - data_layer - INFO -   Rating 2: 1,308 (0.35%)
2025-11-20 17:27:40 - data_layer - INFO -   Rating 3: 3,207 (0.87%)
2025-11-20 17:27:40 - data_layer - INFO -   Rating 4: 9,147 (2.48%)
2025-11-20 17:27:40 - data_layer - INFO -   Rating 5: 353,166 (95.68%)
2025-11-20 17:27:40 - data_layer - INFO - ================================================================================

2025-11-20 17:27:47 - data_layer - INFO - Loading interactions data...
2025-11-20 17:27:49 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:27:49 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:49 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:27:49 - data_layer - INFO - ================================================================================
2025-11-20 17:27:49 - data_layer - INFO - Initial row count: 1,000
2025-11-20 17:27:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:49 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:27:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:49 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:27:49 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:27:49 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:27:49 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:27:49 - data_layer - INFO - Converting rating to float...
2025-11-20 17:27:49 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:27:49 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:27:49 - data_layer - INFO - ✓ Parsed 1,000 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:49 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:49 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:27:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:49 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:27:49 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:27:49 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:27:49 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:27:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:49 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:27:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:49 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:27:49 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:27:49 - data_layer - INFO -   Min: 1.00
2025-11-20 17:27:49 - data_layer - INFO -   Max: 5.00
2025-11-20 17:27:49 - data_layer - INFO -   Mean: 4.82
2025-11-20 17:27:49 - data_layer - INFO -   Median: 5.00
2025-11-20 17:27:49 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:27:49 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:49 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:27:49 - data_layer - INFO - ================================================================================
2025-11-20 17:27:49 - data_layer - INFO - Initial rows:                     1,000
2025-11-20 17:27:49 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:27:49 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:27:49 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:27:49 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:27:49 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:27:49 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:27:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:49 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:27:49 - data_layer - INFO - Final rows:                       1,000
2025-11-20 17:27:49 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:27:49 - data_layer - INFO - ================================================================================

2025-11-20 17:27:49 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:27:49 - data_layer - INFO - ================================================================================
2025-11-20 17:27:49 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 17:27:49 - data_layer - INFO - ================================================================================
2025-11-20 17:27:49 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 17:27:49 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 17:27:49 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 17:27:49 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 17:27:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:49 - data_layer - INFO - Loading interactions data...
2025-11-20 17:27:51 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:27:51 - data_layer - INFO - 
Loading products data...
2025-11-20 17:27:51 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 17:27:51 - data_layer - INFO - 
Loading attributes data...
2025-11-20 17:27:52 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 17:27:52 - data_layer - INFO - 
Loading shops data...
2025-11-20 17:27:52 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 17:27:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:52 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 17:27:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:52 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 17:27:52 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 17:27:52 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 17:27:52 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 17:27:52 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 17:27:52 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 17:27:52 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:52 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 17:27:52 - data_layer - INFO - ================================================================================

2025-11-20 17:27:52 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:52 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:27:52 - data_layer - INFO - ================================================================================
2025-11-20 17:27:52 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:27:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:52 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:27:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:52 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:27:52 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:27:52 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:27:52 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:27:52 - data_layer - INFO - Converting rating to float...
2025-11-20 17:27:52 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:27:52 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:27:52 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:52 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:27:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:52 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:27:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:52 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:27:52 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:27:52 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:27:52 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:27:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:27:52 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:27:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:52 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:27:52 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:27:52 - data_layer - INFO -   Min: 1.00
2025-11-20 17:27:52 - data_layer - INFO -   Max: 5.00
2025-11-20 17:27:52 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:27:52 - data_layer - INFO -   Median: 5.00
2025-11-20 17:27:52 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:27:52 - data_layer - INFO - 
================================================================================
2025-11-20 17:27:52 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:27:52 - data_layer - INFO - ================================================================================
2025-11-20 17:27:52 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:27:52 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:27:52 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:27:52 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:27:52 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:27:52 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:27:52 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:27:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:27:52 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:27:52 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:27:52 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:27:52 - data_layer - INFO - ================================================================================

2025-11-20 17:27:52 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:34:48 - data_layer - INFO - Loading interactions data...
2025-11-20 17:34:50 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:34:50 - data_layer - INFO - 
================================================================================
2025-11-20 17:34:50 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:34:50 - data_layer - INFO - ================================================================================
2025-11-20 17:34:50 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:34:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:34:50 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:34:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:34:50 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:34:50 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:34:50 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:34:50 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:34:50 - data_layer - INFO - Converting rating to float...
2025-11-20 17:34:50 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:34:50 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:34:51 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:34:51 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:34:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:34:51 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:34:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:34:51 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:34:51 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:34:51 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:34:51 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:34:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:34:51 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:34:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:34:51 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:34:51 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:34:51 - data_layer - INFO -   Min: 1.00
2025-11-20 17:34:51 - data_layer - INFO -   Max: 5.00
2025-11-20 17:34:51 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:34:51 - data_layer - INFO -   Median: 5.00
2025-11-20 17:34:51 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:34:51 - data_layer - INFO - 
================================================================================
2025-11-20 17:34:51 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:34:51 - data_layer - INFO - ================================================================================
2025-11-20 17:34:51 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:34:51 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:34:51 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:34:51 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:34:51 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:34:51 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:34:51 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:34:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:34:51 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:34:51 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:34:51 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:34:51 - data_layer - INFO - ================================================================================

2025-11-20 17:34:51 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:36:07 - data_layer - INFO - Loading interactions data...
2025-11-20 17:36:09 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:36:09 - data_layer - INFO - 
================================================================================
2025-11-20 17:36:09 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:36:09 - data_layer - INFO - ================================================================================
2025-11-20 17:36:09 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:36:09 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:36:09 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:36:09 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:36:09 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:36:09 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:36:09 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:36:09 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:36:09 - data_layer - INFO - Converting rating to float...
2025-11-20 17:36:09 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:36:09 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:36:09 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:36:09 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:36:09 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:36:09 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:36:09 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:36:09 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:36:09 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:36:09 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:36:09 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:36:09 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:36:09 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:36:09 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:36:09 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:36:09 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:36:09 - data_layer - INFO -   Min: 1.00
2025-11-20 17:36:09 - data_layer - INFO -   Max: 5.00
2025-11-20 17:36:09 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:36:09 - data_layer - INFO -   Median: 5.00
2025-11-20 17:36:09 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:36:09 - data_layer - INFO - 
================================================================================
2025-11-20 17:36:09 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:36:09 - data_layer - INFO - ================================================================================
2025-11-20 17:36:09 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:36:09 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:36:09 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:36:09 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:36:09 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:36:09 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:36:09 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:36:09 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:36:09 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:36:09 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:36:09 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:36:09 - data_layer - INFO - ================================================================================

2025-11-20 17:36:09 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:36:09 - data_layer - INFO - 
================================================================================
2025-11-20 17:36:09 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:36:09 - data_layer - INFO - ================================================================================
2025-11-20 17:36:09 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:36:09 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:36:09 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:36:10 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:36:10 - data_layer - INFO - 
================================================================================
2025-11-20 17:36:10 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:36:10 - data_layer - INFO - ================================================================================
2025-11-20 17:36:10 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:36:10 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:36:10 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:36:10 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:36:10 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:36:10 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:36:10 - data_layer - INFO - ================================================================================

2025-11-20 17:36:10 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:36:10 - data_layer - INFO - 
================================================================================
2025-11-20 17:36:10 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:36:10 - data_layer - INFO - ================================================================================
2025-11-20 17:36:10 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:36:10 - data_layer - INFO - Configuration:
2025-11-20 17:36:10 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:36:10 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:36:10 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:36:10 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:36:10 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:36:10 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:36:10 - data_layer - INFO - User interaction statistics:
2025-11-20 17:36:10 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:36:10 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:36:10 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:36:10 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:36:10 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:36:10 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:36:10 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:36:10 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:36:10 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:36:10 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:36:10 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:36:10 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:36:10 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:36:10 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:36:10 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:36:10 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:36:10 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:36:10 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:36:10 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:36:10 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:36:10 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:36:10 - data_layer - INFO - Rating distribution:
2025-11-20 17:36:10 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:36:10 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:36:10 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:36:10 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:36:10 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:36:10 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:36:10 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:36:10 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:36:10 - data_layer - WARNING -   This may indicate:
2025-11-20 17:36:10 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:36:10 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:36:10 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:36:10 - data_layer - INFO - 
================================================================================
2025-11-20 17:36:10 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:36:10 - data_layer - INFO - ================================================================================
2025-11-20 17:36:10 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:36:10 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:36:10 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:36:10 - data_layer - INFO - ================================================================================

2025-11-20 17:36:10 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:36:10 - data_layer - INFO - 
================================================================================
2025-11-20 17:36:10 - data_layer - INFO - DATA QUALITY REPORT: Final Cleaned Data (Step 1 Complete)
2025-11-20 17:36:10 - data_layer - INFO - ================================================================================
2025-11-20 17:36:10 - data_layer - INFO - Shape: 338,044 rows × 10 columns
2025-11-20 17:36:10 - data_layer - INFO - Memory usage: 190.83 MB
2025-11-20 17:36:10 - data_layer - INFO - 
Missing values:
2025-11-20 17:36:10 - data_layer - INFO -   processed_comment: 8,978 (2.66%)
2025-11-20 17:36:10 - data_layer - INFO - 
Data types:
2025-11-20 17:36:10 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:36:10 - data_layer - INFO -   user_id: int64
2025-11-20 17:36:10 - data_layer - INFO -   product_id: int64
2025-11-20 17:36:10 - data_layer - INFO -   rating: int64
2025-11-20 17:36:10 - data_layer - INFO -   product_name_x: object
2025-11-20 17:36:10 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:36:10 - data_layer - INFO -   shop_id: int64
2025-11-20 17:36:10 - data_layer - INFO -   variation_x: object
2025-11-20 17:36:10 - data_layer - INFO -   product_quality: float64
2025-11-20 17:36:10 - data_layer - INFO -   processed_comment: object
2025-11-20 17:36:10 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:37:08 - data_layer - INFO - Loading interactions data...
2025-11-20 17:37:09 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:37:09 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:09 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:37:09 - data_layer - INFO - ================================================================================
2025-11-20 17:37:09 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:37:09 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:09 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:37:09 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:09 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:37:09 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:37:09 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:37:10 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:37:10 - data_layer - INFO - Converting rating to float...
2025-11-20 17:37:10 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:37:10 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:37:10 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:37:10 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:37:10 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:10 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:37:10 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:10 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:37:10 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:37:10 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:37:10 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:37:10 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:10 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:37:10 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:10 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:37:10 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:37:10 - data_layer - INFO -   Min: 1.00
2025-11-20 17:37:10 - data_layer - INFO -   Max: 5.00
2025-11-20 17:37:10 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:37:10 - data_layer - INFO -   Median: 5.00
2025-11-20 17:37:10 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:37:10 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:10 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:37:10 - data_layer - INFO - ================================================================================
2025-11-20 17:37:10 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:37:10 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:37:10 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:37:10 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:37:10 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:37:10 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:37:10 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:37:10 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:10 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:37:10 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:37:10 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:37:10 - data_layer - INFO - ================================================================================

2025-11-20 17:37:10 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:37:10 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:10 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:37:10 - data_layer - INFO - ================================================================================
2025-11-20 17:37:10 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:37:10 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:37:10 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:37:10 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:37:10 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:10 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:37:10 - data_layer - INFO - ================================================================================
2025-11-20 17:37:10 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:37:10 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:37:10 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:37:10 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:37:10 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:37:10 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:37:10 - data_layer - INFO - ================================================================================

2025-11-20 17:37:10 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:37:10 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:10 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:37:10 - data_layer - INFO - ================================================================================
2025-11-20 17:37:10 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:37:10 - data_layer - INFO - Configuration:
2025-11-20 17:37:10 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:37:10 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:37:10 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:37:10 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:10 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:37:10 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:10 - data_layer - INFO - User interaction statistics:
2025-11-20 17:37:10 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:37:10 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:37:10 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:37:10 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:37:10 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:37:10 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:10 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:37:10 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:10 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:37:10 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:37:10 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:37:10 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:37:10 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:37:10 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:37:11 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:37:11 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:37:11 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:37:11 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:37:11 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:11 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:37:11 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:11 - data_layer - INFO - Rating distribution:
2025-11-20 17:37:11 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:37:11 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:37:11 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:37:11 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:37:11 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:37:11 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:37:11 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:37:11 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:37:11 - data_layer - WARNING -   This may indicate:
2025-11-20 17:37:11 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:37:11 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:37:11 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:37:11 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:11 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:37:11 - data_layer - INFO - ================================================================================
2025-11-20 17:37:11 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:37:11 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:37:11 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:37:11 - data_layer - INFO - ================================================================================

2025-11-20 17:37:11 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:37:11 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:11 - data_layer - INFO - DATA QUALITY REPORT: Final Cleaned Data (Step 1 Complete)
2025-11-20 17:37:11 - data_layer - INFO - ================================================================================
2025-11-20 17:37:11 - data_layer - INFO - Shape: 338,044 rows × 10 columns
2025-11-20 17:37:11 - data_layer - INFO - Memory usage: 190.83 MB
2025-11-20 17:37:11 - data_layer - INFO - 
Missing values:
2025-11-20 17:37:11 - data_layer - INFO -   processed_comment: 8,978 (2.66%)
2025-11-20 17:37:11 - data_layer - INFO - 
Data types:
2025-11-20 17:37:11 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:37:11 - data_layer - INFO -   user_id: int64
2025-11-20 17:37:11 - data_layer - INFO -   product_id: int64
2025-11-20 17:37:11 - data_layer - INFO -   rating: int64
2025-11-20 17:37:11 - data_layer - INFO -   product_name_x: object
2025-11-20 17:37:11 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:37:11 - data_layer - INFO -   shop_id: int64
2025-11-20 17:37:11 - data_layer - INFO -   variation_x: object
2025-11-20 17:37:11 - data_layer - INFO -   product_quality: float64
2025-11-20 17:37:11 - data_layer - INFO -   processed_comment: object
2025-11-20 17:37:11 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:37:11 - data_layer - INFO -   Rating 1: 2,235 (0.66%)
2025-11-20 17:37:11 - data_layer - INFO -   Rating 2: 1,262 (0.37%)
2025-11-20 17:37:11 - data_layer - INFO -   Rating 3: 3,107 (0.92%)
2025-11-20 17:37:11 - data_layer - INFO -   Rating 4: 8,658 (2.56%)
2025-11-20 17:37:11 - data_layer - INFO -   Rating 5: 322,782 (95.49%)
2025-11-20 17:37:11 - data_layer - INFO - ================================================================================

2025-11-20 17:37:17 - data_layer - INFO - ================================================================================
2025-11-20 17:37:17 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 17:37:17 - data_layer - INFO - ================================================================================
2025-11-20 17:37:17 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 17:37:17 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 17:37:17 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 17:37:17 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 17:37:17 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:17 - data_layer - INFO - Loading interactions data...
2025-11-20 17:37:19 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:37:19 - data_layer - INFO - 
Loading products data...
2025-11-20 17:37:19 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 17:37:19 - data_layer - INFO - 
Loading attributes data...
2025-11-20 17:37:19 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 17:37:19 - data_layer - INFO - 
Loading shops data...
2025-11-20 17:37:19 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 17:37:19 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:19 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 17:37:19 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:19 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 17:37:19 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 17:37:19 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 17:37:19 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 17:37:19 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 17:37:19 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 17:37:19 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:19 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 17:37:19 - data_layer - INFO - ================================================================================

2025-11-20 17:37:19 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:19 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:37:19 - data_layer - INFO - ================================================================================
2025-11-20 17:37:19 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:37:19 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:19 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:37:19 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:19 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:37:19 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:37:19 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:37:19 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:37:19 - data_layer - INFO - Converting rating to float...
2025-11-20 17:37:19 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:37:19 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:37:19 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:37:19 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:37:19 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:19 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:37:19 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:19 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:37:19 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:37:19 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:37:19 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:37:19 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:19 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:37:19 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:19 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:37:19 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:37:19 - data_layer - INFO -   Min: 1.00
2025-11-20 17:37:19 - data_layer - INFO -   Max: 5.00
2025-11-20 17:37:19 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:37:19 - data_layer - INFO -   Median: 5.00
2025-11-20 17:37:19 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:37:19 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:19 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:37:19 - data_layer - INFO - ================================================================================
2025-11-20 17:37:19 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:37:19 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:37:19 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:37:19 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:37:19 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:37:19 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:37:19 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:37:19 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:19 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:37:19 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:37:19 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:37:19 - data_layer - INFO - ================================================================================

2025-11-20 17:37:19 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:37:19 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:19 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:37:19 - data_layer - INFO - ================================================================================
2025-11-20 17:37:19 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:37:19 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:37:19 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:37:20 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:37:20 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:20 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:37:20 - data_layer - INFO - ================================================================================
2025-11-20 17:37:20 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:37:20 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:37:20 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:37:20 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:37:20 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:37:20 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:37:20 - data_layer - INFO - ================================================================================

2025-11-20 17:37:20 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:37:20 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:20 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:37:20 - data_layer - INFO - ================================================================================
2025-11-20 17:37:20 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:37:20 - data_layer - INFO - Configuration:
2025-11-20 17:37:20 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:37:20 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:37:20 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:37:20 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:20 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:37:20 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:20 - data_layer - INFO - User interaction statistics:
2025-11-20 17:37:20 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:37:20 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:37:20 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:37:20 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:37:20 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:37:20 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:20 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:37:20 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:20 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:37:20 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:37:20 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:37:20 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:37:20 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:37:20 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:37:20 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:37:20 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:37:20 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:37:20 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:37:20 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:20 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:37:20 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:20 - data_layer - INFO - Rating distribution:
2025-11-20 17:37:20 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:37:20 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:37:20 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:37:20 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:37:20 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:37:20 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:37:20 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:37:20 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:37:20 - data_layer - WARNING -   This may indicate:
2025-11-20 17:37:20 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:37:20 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:37:20 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:37:20 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:20 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:37:20 - data_layer - INFO - ================================================================================
2025-11-20 17:37:20 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:37:20 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:37:20 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:37:20 - data_layer - INFO - ================================================================================

2025-11-20 17:37:20 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:37:20 - data_layer - INFO - Loading interactions data...
2025-11-20 17:37:24 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:37:24 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:24 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:37:24 - data_layer - INFO - ================================================================================
2025-11-20 17:37:24 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:37:24 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:24 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:37:24 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:24 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:37:24 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:37:24 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:37:24 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:37:24 - data_layer - INFO - Converting rating to float...
2025-11-20 17:37:24 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:37:24 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:37:24 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:37:24 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:37:24 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:24 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:37:24 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:24 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:37:24 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:37:24 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:37:24 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:37:24 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:24 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:37:24 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:24 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:37:24 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:37:24 - data_layer - INFO -   Min: 1.00
2025-11-20 17:37:24 - data_layer - INFO -   Max: 5.00
2025-11-20 17:37:24 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:37:24 - data_layer - INFO -   Median: 5.00
2025-11-20 17:37:24 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:37:24 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:24 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:37:24 - data_layer - INFO - ================================================================================
2025-11-20 17:37:24 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:37:24 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:37:24 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:37:24 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:37:24 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:37:24 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:37:24 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:37:24 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:24 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:37:24 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:37:24 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:37:24 - data_layer - INFO - ================================================================================

2025-11-20 17:37:24 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:37:24 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:24 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:37:24 - data_layer - INFO - ================================================================================
2025-11-20 17:37:24 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:37:24 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:37:24 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:37:25 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:37:25 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:25 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:37:25 - data_layer - INFO - ================================================================================
2025-11-20 17:37:25 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:37:25 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:37:25 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:37:25 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:37:25 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:37:25 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:37:25 - data_layer - INFO - ================================================================================

2025-11-20 17:37:25 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:37:25 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:25 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:37:25 - data_layer - INFO - ================================================================================
2025-11-20 17:37:25 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:37:25 - data_layer - INFO - Configuration:
2025-11-20 17:37:25 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:37:25 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:37:25 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:37:25 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:25 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:37:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:25 - data_layer - INFO - User interaction statistics:
2025-11-20 17:37:25 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:37:25 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:37:25 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:37:25 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:37:25 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:37:25 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:25 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:37:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:25 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:37:25 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:37:25 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:37:25 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:37:25 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:37:25 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:37:25 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:37:25 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:37:25 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:37:25 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:37:25 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:25 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:37:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:25 - data_layer - INFO - Rating distribution:
2025-11-20 17:37:25 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:37:25 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:37:25 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:37:25 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:37:25 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:37:25 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:37:25 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:37:25 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:37:25 - data_layer - WARNING -   This may indicate:
2025-11-20 17:37:25 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:37:25 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:37:25 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:37:25 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:25 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:37:25 - data_layer - INFO - ================================================================================
2025-11-20 17:37:25 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:37:25 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:37:25 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:37:25 - data_layer - INFO - ================================================================================

2025-11-20 17:37:25 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:37:50 - data_layer - INFO - Loading interactions data...
2025-11-20 17:37:52 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:37:52 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:52 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:37:52 - data_layer - INFO - ================================================================================
2025-11-20 17:37:52 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:37:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:52 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:37:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:52 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:37:52 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:37:52 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:37:52 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:37:52 - data_layer - INFO - Converting rating to float...
2025-11-20 17:37:52 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:37:52 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:37:53 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:37:53 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:37:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:37:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:37:53 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:37:53 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:37:53 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:37:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:37:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:37:53 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:37:53 - data_layer - INFO -   Min: 1.00
2025-11-20 17:37:53 - data_layer - INFO -   Max: 5.00
2025-11-20 17:37:53 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:37:53 - data_layer - INFO -   Median: 5.00
2025-11-20 17:37:53 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:37:53 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:53 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:37:53 - data_layer - INFO - ================================================================================
2025-11-20 17:37:53 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:37:53 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:37:53 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:37:53 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:37:53 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:37:53 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:37:53 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:37:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:37:53 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:37:53 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:37:53 - data_layer - INFO - ================================================================================

2025-11-20 17:37:53 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:37:53 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:53 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:37:53 - data_layer - INFO - ================================================================================
2025-11-20 17:37:53 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:37:53 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:37:53 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:37:53 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:37:53 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:53 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:37:53 - data_layer - INFO - ================================================================================
2025-11-20 17:37:53 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:37:53 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:37:53 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:37:53 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:37:53 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:37:53 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:37:53 - data_layer - INFO - ================================================================================

2025-11-20 17:37:53 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:37:53 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:53 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:37:53 - data_layer - INFO - ================================================================================
2025-11-20 17:37:53 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:37:53 - data_layer - INFO - Configuration:
2025-11-20 17:37:53 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:37:53 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:37:53 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:37:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:37:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - User interaction statistics:
2025-11-20 17:37:53 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:37:53 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:37:53 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:37:53 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:37:53 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:37:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:37:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:37:53 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:37:53 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:37:53 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:37:53 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:37:53 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:37:53 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:37:53 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:37:53 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:37:53 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:37:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:37:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:37:53 - data_layer - INFO - Rating distribution:
2025-11-20 17:37:53 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:37:53 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:37:53 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:37:53 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:37:53 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:37:53 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:37:53 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:37:53 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:37:53 - data_layer - WARNING -   This may indicate:
2025-11-20 17:37:53 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:37:53 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:37:53 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:37:53 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:53 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:37:53 - data_layer - INFO - ================================================================================
2025-11-20 17:37:53 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:37:53 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:37:53 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:37:53 - data_layer - INFO - ================================================================================

2025-11-20 17:37:53 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:37:53 - data_layer - INFO - 
================================================================================
2025-11-20 17:37:53 - data_layer - INFO - DATA QUALITY REPORT: Final Cleaned Data (Step 1 Complete)
2025-11-20 17:37:53 - data_layer - INFO - ================================================================================
2025-11-20 17:37:53 - data_layer - INFO - Shape: 338,044 rows × 10 columns
2025-11-20 17:37:54 - data_layer - INFO - Memory usage: 190.83 MB
2025-11-20 17:37:54 - data_layer - INFO - 
Missing values:
2025-11-20 17:37:54 - data_layer - INFO -   processed_comment: 8,978 (2.66%)
2025-11-20 17:37:54 - data_layer - INFO - 
Data types:
2025-11-20 17:37:54 - data_layer - INFO -   Unnamed: 0: int64
2025-11-20 17:37:54 - data_layer - INFO -   user_id: int64
2025-11-20 17:37:54 - data_layer - INFO -   product_id: int64
2025-11-20 17:37:54 - data_layer - INFO -   rating: int64
2025-11-20 17:37:54 - data_layer - INFO -   product_name_x: object
2025-11-20 17:37:54 - data_layer - INFO -   cmt_date: datetime64[ns]
2025-11-20 17:37:54 - data_layer - INFO -   shop_id: int64
2025-11-20 17:37:54 - data_layer - INFO -   variation_x: object
2025-11-20 17:37:54 - data_layer - INFO -   product_quality: float64
2025-11-20 17:37:54 - data_layer - INFO -   processed_comment: object
2025-11-20 17:37:54 - data_layer - INFO - 
Rating distribution:
2025-11-20 17:37:54 - data_layer - INFO -   Rating 1: 2,235 (0.66%)
2025-11-20 17:37:54 - data_layer - INFO -   Rating 2: 1,262 (0.37%)
2025-11-20 17:37:54 - data_layer - INFO -   Rating 3: 3,107 (0.92%)
2025-11-20 17:37:54 - data_layer - INFO -   Rating 4: 8,658 (2.56%)
2025-11-20 17:37:54 - data_layer - INFO -   Rating 5: 322,782 (95.49%)
2025-11-20 17:37:54 - data_layer - INFO - ================================================================================

2025-11-20 17:37:59 - data_layer - INFO - ================================================================================
2025-11-20 17:37:59 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 17:37:59 - data_layer - INFO - ================================================================================
2025-11-20 17:37:59 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 17:37:59 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 17:37:59 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 17:37:59 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 17:37:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:37:59 - data_layer - INFO - Loading interactions data...
2025-11-20 17:38:01 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:38:01 - data_layer - INFO - 
Loading products data...
2025-11-20 17:38:01 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 17:38:01 - data_layer - INFO - 
Loading attributes data...
2025-11-20 17:38:01 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 17:38:01 - data_layer - INFO - 
Loading shops data...
2025-11-20 17:38:01 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 17:38:01 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:01 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 17:38:01 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:01 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 17:38:01 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 17:38:01 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 17:38:01 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 17:38:01 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 17:38:01 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 17:38:01 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:01 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 17:38:01 - data_layer - INFO - ================================================================================

2025-11-20 17:38:01 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:01 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:38:01 - data_layer - INFO - ================================================================================
2025-11-20 17:38:01 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:38:01 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:01 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:38:01 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:01 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:38:01 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:38:01 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:38:01 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:38:01 - data_layer - INFO - Converting rating to float...
2025-11-20 17:38:01 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:38:01 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:38:02 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:38:02 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:38:02 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:38:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:38:02 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:38:02 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:38:02 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:38:02 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:38:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:38:02 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:38:02 - data_layer - INFO -   Min: 1.00
2025-11-20 17:38:02 - data_layer - INFO -   Max: 5.00
2025-11-20 17:38:02 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:38:02 - data_layer - INFO -   Median: 5.00
2025-11-20 17:38:02 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:38:02 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:02 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:38:02 - data_layer - INFO - ================================================================================
2025-11-20 17:38:02 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:38:02 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:38:02 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:38:02 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:38:02 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:38:02 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:38:02 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:38:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:38:02 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:38:02 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:38:02 - data_layer - INFO - ================================================================================

2025-11-20 17:38:02 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:38:02 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:02 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:38:02 - data_layer - INFO - ================================================================================
2025-11-20 17:38:02 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:38:02 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:38:02 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:38:02 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:38:02 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:02 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:38:02 - data_layer - INFO - ================================================================================
2025-11-20 17:38:02 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:38:02 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:38:02 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:38:02 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:38:02 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:38:02 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:38:02 - data_layer - INFO - ================================================================================

2025-11-20 17:38:02 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:38:02 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:02 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:38:02 - data_layer - INFO - ================================================================================
2025-11-20 17:38:02 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:38:02 - data_layer - INFO - Configuration:
2025-11-20 17:38:02 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:38:02 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:38:02 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:38:02 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:38:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - User interaction statistics:
2025-11-20 17:38:02 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:38:02 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:38:02 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:38:02 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:38:02 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:38:02 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:38:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:38:02 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:38:02 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:38:02 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:38:02 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:38:02 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:38:02 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:38:02 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:38:02 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:38:02 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:38:02 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:38:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:02 - data_layer - INFO - Rating distribution:
2025-11-20 17:38:02 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:38:02 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:38:02 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:38:02 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:38:02 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:38:02 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:38:02 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:38:02 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:38:02 - data_layer - WARNING -   This may indicate:
2025-11-20 17:38:02 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:38:02 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:38:02 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:38:02 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:02 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:38:02 - data_layer - INFO - ================================================================================
2025-11-20 17:38:02 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:38:02 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:38:02 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:38:02 - data_layer - INFO - ================================================================================

2025-11-20 17:38:02 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:38:02 - data_layer - INFO - Loading interactions data...
2025-11-20 17:38:04 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:38:04 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:04 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:38:04 - data_layer - INFO - ================================================================================
2025-11-20 17:38:04 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:38:04 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:04 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:38:04 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:04 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:38:04 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:38:04 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:38:04 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:38:04 - data_layer - INFO - Converting rating to float...
2025-11-20 17:38:04 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:38:04 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:38:05 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:38:05 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:38:05 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:38:05 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:38:05 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:38:05 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:38:05 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:38:05 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:38:05 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:38:05 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:38:05 - data_layer - INFO -   Min: 1.00
2025-11-20 17:38:05 - data_layer - INFO -   Max: 5.00
2025-11-20 17:38:05 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:38:05 - data_layer - INFO -   Median: 5.00
2025-11-20 17:38:05 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:38:05 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:05 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:38:05 - data_layer - INFO - ================================================================================
2025-11-20 17:38:05 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:38:05 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:38:05 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:38:05 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:38:05 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:38:05 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:38:05 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:38:05 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:38:05 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:38:05 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:38:05 - data_layer - INFO - ================================================================================

2025-11-20 17:38:05 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:38:05 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:05 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:38:05 - data_layer - INFO - ================================================================================
2025-11-20 17:38:05 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:38:05 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:38:05 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:38:05 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:38:05 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:05 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:38:05 - data_layer - INFO - ================================================================================
2025-11-20 17:38:05 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:38:05 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:38:05 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:38:05 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:38:05 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:38:05 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:38:05 - data_layer - INFO - ================================================================================

2025-11-20 17:38:05 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:38:05 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:05 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:38:05 - data_layer - INFO - ================================================================================
2025-11-20 17:38:05 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:38:05 - data_layer - INFO - Configuration:
2025-11-20 17:38:05 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:38:05 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:38:05 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:38:05 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:38:05 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - User interaction statistics:
2025-11-20 17:38:05 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:38:05 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:38:05 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:38:05 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:38:05 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:38:05 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:38:05 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:38:05 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:38:05 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:38:05 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:38:05 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:38:05 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:38:05 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:38:05 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:38:05 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:38:05 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:38:05 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:38:05 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:38:05 - data_layer - INFO - Rating distribution:
2025-11-20 17:38:05 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:38:05 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:38:05 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:38:05 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:38:05 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:38:05 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:38:05 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:38:05 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:38:05 - data_layer - WARNING -   This may indicate:
2025-11-20 17:38:05 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:38:05 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:38:05 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:38:05 - data_layer - INFO - 
================================================================================
2025-11-20 17:38:05 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:38:05 - data_layer - INFO - ================================================================================
2025-11-20 17:38:05 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:38:05 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:38:05 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:38:05 - data_layer - INFO - ================================================================================

2025-11-20 17:38:05 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:47:13 - data_layer - INFO - Loading interactions data...
2025-11-20 17:47:15 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:47:15 - data_layer - INFO - 
================================================================================
2025-11-20 17:47:15 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:47:15 - data_layer - INFO - ================================================================================
2025-11-20 17:47:15 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:47:15 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:47:15 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:47:15 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:47:15 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:47:16 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:47:16 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:47:16 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:47:16 - data_layer - INFO - Converting rating to float...
2025-11-20 17:47:16 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:47:16 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:47:16 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:47:16 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:47:16 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:47:16 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:47:16 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:47:16 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:47:16 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:47:16 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:47:16 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:47:16 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:47:16 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:47:16 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:47:16 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:47:16 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:47:16 - data_layer - INFO -   Min: 1.00
2025-11-20 17:47:16 - data_layer - INFO -   Max: 5.00
2025-11-20 17:47:16 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:47:16 - data_layer - INFO -   Median: 5.00
2025-11-20 17:47:16 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:47:16 - data_layer - INFO - 
================================================================================
2025-11-20 17:47:16 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:47:16 - data_layer - INFO - ================================================================================
2025-11-20 17:47:16 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:47:16 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:47:16 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:47:16 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:47:16 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:47:16 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:47:16 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:47:16 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:47:16 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:47:16 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:47:16 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:47:16 - data_layer - INFO - ================================================================================

2025-11-20 17:47:16 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:47:16 - data_layer - INFO - 
================================================================================
2025-11-20 17:47:16 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:47:16 - data_layer - INFO - ================================================================================
2025-11-20 17:47:16 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:47:16 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:47:16 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:47:16 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:47:16 - data_layer - INFO - 
================================================================================
2025-11-20 17:47:16 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:47:16 - data_layer - INFO - ================================================================================
2025-11-20 17:47:16 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:47:16 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:47:16 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:47:16 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:47:16 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:47:16 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:47:16 - data_layer - INFO - ================================================================================

2025-11-20 17:47:16 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:47:16 - data_layer - INFO - 
================================================================================
2025-11-20 17:47:16 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:47:16 - data_layer - INFO - ================================================================================
2025-11-20 17:47:16 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:47:16 - data_layer - INFO - Configuration:
2025-11-20 17:47:16 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:47:16 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:47:16 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:47:16 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:47:16 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:47:16 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:47:16 - data_layer - INFO - User interaction statistics:
2025-11-20 17:47:16 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:47:16 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:47:16 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:47:16 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:47:16 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:47:16 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:47:16 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:47:16 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:47:17 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:47:17 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:47:17 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:47:17 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:47:17 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:47:17 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:47:17 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:47:17 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:47:17 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:47:17 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:47:17 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:47:17 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:47:17 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:47:17 - data_layer - INFO - Rating distribution:
2025-11-20 17:47:17 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:47:17 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:47:17 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:47:17 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:47:17 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:47:17 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:47:17 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:47:17 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:47:17 - data_layer - WARNING -   This may indicate:
2025-11-20 17:47:17 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:47:17 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:47:17 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:47:17 - data_layer - INFO - 
================================================================================
2025-11-20 17:47:17 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:47:17 - data_layer - INFO - ================================================================================
2025-11-20 17:47:17 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:47:17 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:47:17 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:47:17 - data_layer - INFO - ================================================================================

2025-11-20 17:47:17 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:47:17 - data_layer - INFO - 
================================================================================
2025-11-20 17:47:17 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 17:47:17 - data_layer - INFO - ================================================================================
2025-11-20 17:47:17 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 17:47:17 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 17:47:17 - data_layer - INFO - Processing 338,044 interactions
2025-11-20 17:47:17 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 17:47:17 - data_layer - INFO - Quality scoring criteria:
2025-11-20 17:47:17 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 17:47:17 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 17:47:17 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 17:47:21 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 17:47:21 - data_layer - INFO - 
================================================================================
2025-11-20 17:47:21 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 17:47:21 - data_layer - INFO - ================================================================================
2025-11-20 17:47:21 - data_layer - INFO - Total interactions:             338,044
2025-11-20 17:47:21 - data_layer - INFO - Rows with comments:             329,066 (97.34%)
2025-11-20 17:47:21 - data_layer - INFO - Rows without comments:            8,978 (2.66%)
2025-11-20 17:47:21 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 17:47:21 - data_layer - INFO -   Min:    0.000
2025-11-20 17:47:21 - data_layer - INFO -   Mean:   0.223
2025-11-20 17:47:21 - data_layer - INFO -   Median: 0.200
2025-11-20 17:47:21 - data_layer - INFO -   Max:    0.500
2025-11-20 17:47:21 - data_layer - INFO -   Std:    0.101
2025-11-20 17:47:21 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 17:47:21 - data_layer - INFO -   Min:    1.000
2025-11-20 17:47:21 - data_layer - INFO -   Mean:   5.141
2025-11-20 17:47:21 - data_layer - INFO -   Median: 5.200
2025-11-20 17:47:21 - data_layer - INFO -   Max:    5.500
2025-11-20 17:47:21 - data_layer - INFO -   Std:    0.456
2025-11-20 17:47:21 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 17:47:21 - data_layer - INFO -   Zero quality (0.0):              26,170 (7.74%)
2025-11-20 17:47:21 - data_layer - INFO -   Low quality (0.0-0.2):          194,059 (57.41%)
2025-11-20 17:47:21 - data_layer - INFO -   Medium quality (0.2-0.5):       117,815 (34.85%)
2025-11-20 17:47:21 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 17:47:21 - data_layer - INFO - ================================================================================

2025-11-20 17:47:21 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 17:47:22 - data_layer - INFO - Loading interactions data...
2025-11-20 17:47:23 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:47:23 - data_layer - INFO - 
================================================================================
2025-11-20 17:47:23 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 17:47:23 - data_layer - INFO - ================================================================================
2025-11-20 17:47:23 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 17:47:23 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 17:47:23 - data_layer - INFO - Processing 1,000 interactions
2025-11-20 17:47:23 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 17:47:23 - data_layer - INFO - Quality scoring criteria:
2025-11-20 17:47:23 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 17:47:23 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 17:47:23 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 17:47:23 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 17:47:23 - data_layer - INFO - 
================================================================================
2025-11-20 17:47:23 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 17:47:23 - data_layer - INFO - ================================================================================
2025-11-20 17:47:23 - data_layer - INFO - Total interactions:               1,000
2025-11-20 17:47:23 - data_layer - INFO - Rows with comments:                 973 (97.30%)
2025-11-20 17:47:23 - data_layer - INFO - Rows without comments:               27 (2.70%)
2025-11-20 17:47:23 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 17:47:23 - data_layer - INFO -   Min:    0.000
2025-11-20 17:47:23 - data_layer - INFO -   Mean:   0.225
2025-11-20 17:47:23 - data_layer - INFO -   Median: 0.200
2025-11-20 17:47:23 - data_layer - INFO -   Max:    0.500
2025-11-20 17:47:23 - data_layer - INFO -   Std:    0.103
2025-11-20 17:47:23 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 17:47:23 - data_layer - INFO -   Min:    1.100
2025-11-20 17:47:23 - data_layer - INFO -   Mean:   5.144
2025-11-20 17:47:23 - data_layer - INFO -   Median: 5.200
2025-11-20 17:47:23 - data_layer - INFO -   Max:    5.500
2025-11-20 17:47:23 - data_layer - INFO -   Std:    0.456
2025-11-20 17:47:23 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 17:47:23 - data_layer - INFO -   Zero quality (0.0):                  74 (7.40%)
2025-11-20 17:47:23 - data_layer - INFO -   Low quality (0.0-0.2):              570 (57.00%)
2025-11-20 17:47:23 - data_layer - INFO -   Medium quality (0.2-0.5):           356 (35.60%)
2025-11-20 17:47:23 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 17:47:23 - data_layer - INFO - ================================================================================

2025-11-20 17:47:23 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 17:49:51 - data_layer - INFO - Loading interactions data...
2025-11-20 17:49:54 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:49:54 - data_layer - INFO - 
================================================================================
2025-11-20 17:49:54 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:49:54 - data_layer - INFO - ================================================================================
2025-11-20 17:49:54 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:49:54 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:49:54 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:49:54 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:49:54 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:49:54 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:49:54 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:49:54 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:49:54 - data_layer - INFO - Converting rating to float...
2025-11-20 17:49:54 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:49:54 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:49:54 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:49:54 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:49:54 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:49:54 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:49:54 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:49:54 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:49:54 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:49:54 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:49:54 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:49:54 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:49:54 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:49:54 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:49:54 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:49:54 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:49:54 - data_layer - INFO -   Min: 1.00
2025-11-20 17:49:54 - data_layer - INFO -   Max: 5.00
2025-11-20 17:49:54 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:49:54 - data_layer - INFO -   Median: 5.00
2025-11-20 17:49:54 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:49:54 - data_layer - INFO - 
================================================================================
2025-11-20 17:49:54 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:49:54 - data_layer - INFO - ================================================================================
2025-11-20 17:49:54 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:49:54 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:49:54 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:49:54 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:49:54 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:49:54 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:49:54 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:49:54 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:49:54 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:49:54 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:49:54 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:49:54 - data_layer - INFO - ================================================================================

2025-11-20 17:49:54 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:49:54 - data_layer - INFO - 
================================================================================
2025-11-20 17:49:54 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:49:54 - data_layer - INFO - ================================================================================
2025-11-20 17:49:54 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:49:54 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:49:54 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:49:55 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:49:55 - data_layer - INFO - 
================================================================================
2025-11-20 17:49:55 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:49:55 - data_layer - INFO - ================================================================================
2025-11-20 17:49:55 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:49:55 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:49:55 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:49:55 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:49:55 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:49:55 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:49:55 - data_layer - INFO - ================================================================================

2025-11-20 17:49:55 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:49:55 - data_layer - INFO - 
================================================================================
2025-11-20 17:49:55 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:49:55 - data_layer - INFO - ================================================================================
2025-11-20 17:49:55 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:49:55 - data_layer - INFO - Configuration:
2025-11-20 17:49:55 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:49:55 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:49:55 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:49:55 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:49:55 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:49:55 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:49:55 - data_layer - INFO - User interaction statistics:
2025-11-20 17:49:55 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:49:55 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:49:55 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:49:55 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:49:55 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:49:55 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:49:55 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:49:55 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:49:55 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:49:55 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:49:55 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:49:55 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:49:55 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:49:55 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:49:55 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:49:55 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:49:55 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:49:55 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:49:55 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:49:55 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:49:55 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:49:55 - data_layer - INFO - Rating distribution:
2025-11-20 17:49:55 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:49:55 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:49:55 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:49:55 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:49:55 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:49:55 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:49:55 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:49:55 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:49:55 - data_layer - WARNING -   This may indicate:
2025-11-20 17:49:55 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:49:55 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:49:55 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:49:55 - data_layer - INFO - 
================================================================================
2025-11-20 17:49:55 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:49:55 - data_layer - INFO - ================================================================================
2025-11-20 17:49:55 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:49:55 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:49:55 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:49:55 - data_layer - INFO - ================================================================================

2025-11-20 17:49:55 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:49:55 - data_layer - INFO - 
================================================================================
2025-11-20 17:49:55 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 17:49:55 - data_layer - INFO - ================================================================================
2025-11-20 17:49:55 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 17:49:55 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 17:49:55 - data_layer - INFO - Processing 338,044 interactions
2025-11-20 17:49:55 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 17:49:55 - data_layer - INFO - Quality scoring criteria:
2025-11-20 17:49:55 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 17:49:55 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 17:49:55 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 17:49:59 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 17:49:59 - data_layer - INFO - 
================================================================================
2025-11-20 17:49:59 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 17:49:59 - data_layer - INFO - ================================================================================
2025-11-20 17:49:59 - data_layer - INFO - Total interactions:             338,044
2025-11-20 17:49:59 - data_layer - INFO - Rows with comments:             329,066 (97.34%)
2025-11-20 17:49:59 - data_layer - INFO - Rows without comments:            8,978 (2.66%)
2025-11-20 17:49:59 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 17:49:59 - data_layer - INFO -   Min:    0.000
2025-11-20 17:49:59 - data_layer - INFO -   Mean:   0.223
2025-11-20 17:49:59 - data_layer - INFO -   Median: 0.200
2025-11-20 17:49:59 - data_layer - INFO -   Max:    0.500
2025-11-20 17:49:59 - data_layer - INFO -   Std:    0.101
2025-11-20 17:49:59 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 17:49:59 - data_layer - INFO -   Min:    1.000
2025-11-20 17:49:59 - data_layer - INFO -   Mean:   5.141
2025-11-20 17:49:59 - data_layer - INFO -   Median: 5.200
2025-11-20 17:49:59 - data_layer - INFO -   Max:    5.500
2025-11-20 17:49:59 - data_layer - INFO -   Std:    0.456
2025-11-20 17:49:59 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 17:49:59 - data_layer - INFO -   Zero quality (0.0):              26,170 (7.74%)
2025-11-20 17:49:59 - data_layer - INFO -   Low quality (0.0-0.2):          194,059 (57.41%)
2025-11-20 17:49:59 - data_layer - INFO -   Medium quality (0.2-0.5):       117,815 (34.85%)
2025-11-20 17:49:59 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 17:49:59 - data_layer - INFO - ================================================================================

2025-11-20 17:49:59 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 17:50:00 - data_layer - INFO - Loading interactions data...
2025-11-20 17:50:02 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:50:02 - data_layer - INFO - 
================================================================================
2025-11-20 17:50:02 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 17:50:02 - data_layer - INFO - ================================================================================
2025-11-20 17:50:02 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 17:50:02 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 17:50:02 - data_layer - INFO - Processing 1,000 interactions
2025-11-20 17:50:02 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 17:50:02 - data_layer - INFO - Quality scoring criteria:
2025-11-20 17:50:02 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 17:50:02 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 17:50:02 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 17:50:02 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 17:50:02 - data_layer - INFO - 
================================================================================
2025-11-20 17:50:02 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 17:50:02 - data_layer - INFO - ================================================================================
2025-11-20 17:50:02 - data_layer - INFO - Total interactions:               1,000
2025-11-20 17:50:02 - data_layer - INFO - Rows with comments:                 973 (97.30%)
2025-11-20 17:50:02 - data_layer - INFO - Rows without comments:               27 (2.70%)
2025-11-20 17:50:02 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 17:50:02 - data_layer - INFO -   Min:    0.000
2025-11-20 17:50:02 - data_layer - INFO -   Mean:   0.225
2025-11-20 17:50:02 - data_layer - INFO -   Median: 0.200
2025-11-20 17:50:02 - data_layer - INFO -   Max:    0.500
2025-11-20 17:50:02 - data_layer - INFO -   Std:    0.103
2025-11-20 17:50:02 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 17:50:02 - data_layer - INFO -   Min:    1.100
2025-11-20 17:50:02 - data_layer - INFO -   Mean:   5.144
2025-11-20 17:50:02 - data_layer - INFO -   Median: 5.200
2025-11-20 17:50:02 - data_layer - INFO -   Max:    5.500
2025-11-20 17:50:02 - data_layer - INFO -   Std:    0.456
2025-11-20 17:50:02 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 17:50:02 - data_layer - INFO -   Zero quality (0.0):                  74 (7.40%)
2025-11-20 17:50:02 - data_layer - INFO -   Low quality (0.0-0.2):              570 (57.00%)
2025-11-20 17:50:02 - data_layer - INFO -   Medium quality (0.2-0.5):           356 (35.60%)
2025-11-20 17:50:02 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 17:50:02 - data_layer - INFO - ================================================================================

2025-11-20 17:50:02 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 17:57:50 - data_layer - INFO - Loading interactions data...
2025-11-20 17:57:52 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:57:52 - data_layer - INFO - 
================================================================================
2025-11-20 17:57:52 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:57:52 - data_layer - INFO - ================================================================================
2025-11-20 17:57:52 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:57:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:57:52 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:57:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:57:52 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:57:52 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:57:52 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:57:53 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:57:53 - data_layer - INFO - Converting rating to float...
2025-11-20 17:57:53 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:57:53 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:57:53 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:57:53 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:57:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:57:53 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:57:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:57:53 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:57:53 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:57:53 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:57:53 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:57:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:57:53 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:57:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:57:53 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:57:53 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:57:53 - data_layer - INFO -   Min: 1.00
2025-11-20 17:57:53 - data_layer - INFO -   Max: 5.00
2025-11-20 17:57:53 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:57:53 - data_layer - INFO -   Median: 5.00
2025-11-20 17:57:53 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:57:53 - data_layer - INFO - 
================================================================================
2025-11-20 17:57:53 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:57:53 - data_layer - INFO - ================================================================================
2025-11-20 17:57:53 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:57:53 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:57:53 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:57:53 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:57:53 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:57:53 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:57:53 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:57:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:57:53 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:57:53 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:57:53 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:57:53 - data_layer - INFO - ================================================================================

2025-11-20 17:57:53 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:57:53 - data_layer - INFO - 
================================================================================
2025-11-20 17:57:53 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:57:53 - data_layer - INFO - ================================================================================
2025-11-20 17:57:53 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:57:53 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:57:53 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:57:53 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:57:54 - data_layer - INFO - 
================================================================================
2025-11-20 17:57:54 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:57:54 - data_layer - INFO - ================================================================================
2025-11-20 17:57:54 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:57:54 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:57:54 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:57:54 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:57:54 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:57:54 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:57:54 - data_layer - INFO - ================================================================================

2025-11-20 17:57:54 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:57:54 - data_layer - INFO - 
================================================================================
2025-11-20 17:57:54 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:57:54 - data_layer - INFO - ================================================================================
2025-11-20 17:57:54 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:57:54 - data_layer - INFO - Configuration:
2025-11-20 17:57:54 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:57:54 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:57:54 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:57:54 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:57:54 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:57:54 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:57:54 - data_layer - INFO - User interaction statistics:
2025-11-20 17:57:54 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:57:54 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:57:54 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:57:54 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:57:54 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:57:54 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:57:54 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:57:54 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:57:54 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:57:54 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:57:54 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:57:54 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:57:54 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:57:54 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:57:54 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:57:54 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:57:54 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:57:54 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:57:54 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:57:54 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:57:54 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:57:54 - data_layer - INFO - Rating distribution:
2025-11-20 17:57:54 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:57:54 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:57:54 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:57:54 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:57:54 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:57:54 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:57:54 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:57:54 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:57:54 - data_layer - WARNING -   This may indicate:
2025-11-20 17:57:54 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:57:54 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:57:54 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:57:54 - data_layer - INFO - 
================================================================================
2025-11-20 17:57:54 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:57:54 - data_layer - INFO - ================================================================================
2025-11-20 17:57:54 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:57:54 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:57:54 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:57:54 - data_layer - INFO - ================================================================================

2025-11-20 17:57:54 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:57:54 - data_layer - INFO - 
================================================================================
2025-11-20 17:57:54 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 17:57:54 - data_layer - INFO - ================================================================================
2025-11-20 17:57:54 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 17:57:54 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 17:57:54 - data_layer - INFO - Processing 338,044 interactions
2025-11-20 17:57:54 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 17:57:54 - data_layer - INFO - Quality scoring criteria:
2025-11-20 17:57:54 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 17:57:54 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 17:57:54 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 17:57:58 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 17:57:58 - data_layer - INFO - 
================================================================================
2025-11-20 17:57:58 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 17:57:58 - data_layer - INFO - ================================================================================
2025-11-20 17:57:58 - data_layer - INFO - Total interactions:             338,044
2025-11-20 17:57:58 - data_layer - INFO - Rows with comments:             329,066 (97.34%)
2025-11-20 17:57:58 - data_layer - INFO - Rows without comments:            8,978 (2.66%)
2025-11-20 17:57:58 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 17:57:58 - data_layer - INFO -   Min:    0.000
2025-11-20 17:57:58 - data_layer - INFO -   Mean:   0.223
2025-11-20 17:57:58 - data_layer - INFO -   Median: 0.200
2025-11-20 17:57:58 - data_layer - INFO -   Max:    0.500
2025-11-20 17:57:58 - data_layer - INFO -   Std:    0.101
2025-11-20 17:57:58 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 17:57:58 - data_layer - INFO -   Min:    1.000
2025-11-20 17:57:58 - data_layer - INFO -   Mean:   5.141
2025-11-20 17:57:58 - data_layer - INFO -   Median: 5.200
2025-11-20 17:57:58 - data_layer - INFO -   Max:    5.500
2025-11-20 17:57:58 - data_layer - INFO -   Std:    0.456
2025-11-20 17:57:58 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 17:57:58 - data_layer - INFO -   Zero quality (0.0):              26,170 (7.74%)
2025-11-20 17:57:58 - data_layer - INFO -   Low quality (0.0-0.2):          194,059 (57.41%)
2025-11-20 17:57:58 - data_layer - INFO -   Medium quality (0.2-0.5):       117,815 (34.85%)
2025-11-20 17:57:58 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 17:57:58 - data_layer - INFO - ================================================================================

2025-11-20 17:57:58 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 17:57:59 - data_layer - INFO - 
================================================================================
2025-11-20 17:57:59 - data_layer - INFO - STEP 2.1: ALS CONFIDENCE-WEIGHTED MATRIX
2025-11-20 17:57:59 - data_layer - INFO - ================================================================================
2025-11-20 17:57:59 - data_layer - INFO - Building explicit feedback matrix with sentiment-based weighting
2025-11-20 17:57:59 - data_layer - INFO - Processing 338,044 interactions
2025-11-20 17:57:59 - data_layer - INFO - Matrix shape: (304,708, 2,231)
2025-11-20 17:57:59 - data_layer - INFO - Confidence score range: [1.000, 5.500]
2025-11-20 17:57:59 - data_layer - INFO - Building CSR sparse matrix...
2025-11-20 17:57:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:57:59 - data_layer - INFO - ALS MATRIX SUMMARY
2025-11-20 17:57:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:57:59 - data_layer - INFO - Matrix shape:           (304708, 2231)
2025-11-20 17:57:59 - data_layer - INFO - Non-zero entries:       338,044
2025-11-20 17:57:59 - data_layer - INFO - Sparsity:               99.9503%
2025-11-20 17:57:59 - data_layer - INFO - Mean confidence:        5.141
2025-11-20 17:57:59 - data_layer - INFO - Median confidence:      5.200
2025-11-20 17:57:59 - data_layer - INFO - Std confidence:         0.456
2025-11-20 17:57:59 - data_layer - INFO - Confidence range:       [1.000, 5.500]
2025-11-20 17:57:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:57:59 - data_layer - INFO - ✓ ALS confidence matrix ready for training
2025-11-20 17:57:59 - data_layer - INFO - 
================================================================================
2025-11-20 17:57:59 - data_layer - INFO - CONFIDENCE SCORE DISTRIBUTION ANALYSIS
2025-11-20 17:57:59 - data_layer - INFO - ================================================================================
2025-11-20 17:57:59 - data_layer - INFO - 
Rating 1 (⭐)
2025-11-20 17:57:59 - data_layer - INFO -   Count:       2,235 (0.66%)
2025-11-20 17:57:59 - data_layer - INFO -   Confidence:  1.198 ± 0.082
2025-11-20 17:57:59 - data_layer - INFO -   Range:       [1.000, 1.500]
2025-11-20 17:57:59 - data_layer - INFO -   Quartiles:   Q1=1.200, Q3=1.200
2025-11-20 17:58:28 - data_layer - INFO - Loading interactions data...
2025-11-20 17:58:30 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 17:58:30 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:30 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 17:58:30 - data_layer - INFO - ================================================================================
2025-11-20 17:58:30 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:58:30 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:58:30 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 17:58:30 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:30 - data_layer - INFO - Converting user_id to integer...
2025-11-20 17:58:30 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 17:58:30 - data_layer - INFO - Converting product_id to integer...
2025-11-20 17:58:30 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 17:58:30 - data_layer - INFO - Converting rating to float...
2025-11-20 17:58:30 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 17:58:30 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 17:58:31 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 17:58:31 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 17:58:31 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 17:58:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 17:58:31 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 17:58:31 - data_layer - INFO - ✓ No missing rating values
2025-11-20 17:58:31 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 17:58:31 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 17:58:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 17:58:31 - data_layer - INFO - Rating statistics before validation:
2025-11-20 17:58:31 - data_layer - INFO -   Min: 1.00
2025-11-20 17:58:31 - data_layer - INFO -   Max: 5.00
2025-11-20 17:58:31 - data_layer - INFO -   Mean: 4.92
2025-11-20 17:58:31 - data_layer - INFO -   Median: 5.00
2025-11-20 17:58:31 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 17:58:31 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:31 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 17:58:31 - data_layer - INFO - ================================================================================
2025-11-20 17:58:31 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:58:31 - data_layer - INFO - Missing user_id:                      0
2025-11-20 17:58:31 - data_layer - INFO - Missing product_id:                   0
2025-11-20 17:58:31 - data_layer - INFO - Missing rating:                       0
2025-11-20 17:58:31 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 17:58:31 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 17:58:31 - data_layer - INFO - Type conversion errors:               0
2025-11-20 17:58:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - Total dropped:                        0
2025-11-20 17:58:31 - data_layer - INFO - Final rows:                     369,099
2025-11-20 17:58:31 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 17:58:31 - data_layer - INFO - ================================================================================

2025-11-20 17:58:31 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 17:58:31 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:31 - data_layer - INFO - STEP 1.2: DEDUPLICATION
2025-11-20 17:58:31 - data_layer - INFO - ================================================================================
2025-11-20 17:58:31 - data_layer - INFO - Initial row count: 369,099
2025-11-20 17:58:31 - data_layer - INFO - Found 54,921 duplicate rows involving 23,866 unique (user_id, product_id) pairs
2025-11-20 17:58:31 - data_layer - INFO - Sorting by cmt_date (desc) and rating (desc)...
2025-11-20 17:58:31 - data_layer - INFO - Removing duplicates (keeping most recent interaction with highest rating)...
2025-11-20 17:58:31 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:31 - data_layer - INFO - DEDUPLICATION SUMMARY
2025-11-20 17:58:31 - data_layer - INFO - ================================================================================
2025-11-20 17:58:31 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 17:58:31 - data_layer - INFO - Duplicate rows found:            54,921
2025-11-20 17:58:31 - data_layer - INFO - Unique pairs affected:           23,866
2025-11-20 17:58:31 - data_layer - INFO - Duplicates removed:              31,055
2025-11-20 17:58:31 - data_layer - INFO - Final rows:                     338,044
2025-11-20 17:58:31 - data_layer - INFO - Retention rate:                  91.59%
2025-11-20 17:58:31 - data_layer - INFO - ================================================================================

2025-11-20 17:58:31 - data_layer - INFO - ✓ Deduplication validation passed - no duplicates remaining
2025-11-20 17:58:31 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:31 - data_layer - INFO - STEP 1.3: OUTLIER DETECTION
2025-11-20 17:58:31 - data_layer - INFO - ================================================================================
2025-11-20 17:58:31 - data_layer - INFO - NOTE: This step only IDENTIFIES outliers, does not filter them
2025-11-20 17:58:31 - data_layer - INFO - Configuration:
2025-11-20 17:58:31 - data_layer - INFO -   - Max user interactions: 500
2025-11-20 17:58:31 - data_layer - INFO -   - Min item interactions: 3
2025-11-20 17:58:31 - data_layer - INFO -   - Rating bias threshold: 90%
2025-11-20 17:58:31 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - 1. USER ACTIVITY ANALYSIS (Bot Detection)
2025-11-20 17:58:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - User interaction statistics:
2025-11-20 17:58:31 - data_layer - INFO -   Total users: 304,708
2025-11-20 17:58:31 - data_layer - INFO -   Mean interactions per user: 1.11
2025-11-20 17:58:31 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 17:58:31 - data_layer - INFO -   Max interactions per user: 12
2025-11-20 17:58:31 - data_layer - INFO - ✓ No bot users detected (all users have ≤500 interactions)
2025-11-20 17:58:31 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - 2. ITEM POPULARITY ANALYSIS (Cold Item Detection)
2025-11-20 17:58:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - Item interaction statistics:
2025-11-20 17:58:31 - data_layer - INFO -   Total items: 2,231
2025-11-20 17:58:31 - data_layer - INFO -   Mean interactions per item: 151.52
2025-11-20 17:58:31 - data_layer - INFO -   Median interactions per item: 23.0
2025-11-20 17:58:31 - data_layer - INFO -   Min interactions per item: 1
2025-11-20 17:58:31 - data_layer - WARNING - 
⚠ Found 210 very cold items (<3 interactions)
2025-11-20 17:58:31 - data_layer - WARNING -   These items account for 319 interactions
2025-11-20 17:58:31 - data_layer - WARNING -   Cold item distribution:
2025-11-20 17:58:31 - data_layer - WARNING -     101 items with exactly 1 interaction(s)
2025-11-20 17:58:31 - data_layer - WARNING -     109 items with exactly 2 interaction(s)
2025-11-20 17:58:31 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - 3. RATING DISTRIBUTION ANALYSIS (Bias Detection)
2025-11-20 17:58:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:31 - data_layer - INFO - Rating distribution:
2025-11-20 17:58:31 - data_layer - INFO -   ★ (1.0):    2,235 ( 0.66%)
2025-11-20 17:58:31 - data_layer - INFO -   ★★ (2.0):    1,262 ( 0.37%)
2025-11-20 17:58:31 - data_layer - INFO -   ★★★ (3.0):    3,107 ( 0.92%)
2025-11-20 17:58:31 - data_layer - INFO -   ★★★★ (4.0):    8,658 ( 2.56%)
2025-11-20 17:58:31 - data_layer - INFO -   ★★★★★ (5.0):  322,782 (95.49%)
2025-11-20 17:58:31 - data_layer - WARNING - 
⚠ RATING BIAS DETECTED!
2025-11-20 17:58:31 - data_layer - WARNING -   Rating 5.0 accounts for 95.49% of all ratings
2025-11-20 17:58:31 - data_layer - WARNING -   This exceeds the bias threshold of 90%
2025-11-20 17:58:31 - data_layer - WARNING -   This may indicate:
2025-11-20 17:58:31 - data_layer - WARNING -     - Authentic product quality (if high rating)
2025-11-20 17:58:31 - data_layer - WARNING -     - Review manipulation
2025-11-20 17:58:31 - data_layer - WARNING -     - Limited discriminative power for recommendations
2025-11-20 17:58:31 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:31 - data_layer - INFO - OUTLIER DETECTION SUMMARY
2025-11-20 17:58:31 - data_layer - INFO - ================================================================================
2025-11-20 17:58:31 - data_layer - INFO - Potential bot users:                  0 (0.00%)
2025-11-20 17:58:31 - data_layer - INFO - Very cold items:                    210 (9.41%)
2025-11-20 17:58:31 - data_layer - INFO - Rating bias detected:              True
2025-11-20 17:58:31 - data_layer - INFO - ================================================================================

2025-11-20 17:58:31 - data_layer - INFO - ✓ Outlier detection completed (no filtering applied)
2025-11-20 17:58:31 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:31 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 17:58:31 - data_layer - INFO - ================================================================================
2025-11-20 17:58:31 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 17:58:31 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 17:58:31 - data_layer - INFO - Processing 338,044 interactions
2025-11-20 17:58:31 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 17:58:31 - data_layer - INFO - Quality scoring criteria:
2025-11-20 17:58:31 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 17:58:31 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 17:58:31 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 17:58:35 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 17:58:35 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:35 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 17:58:35 - data_layer - INFO - ================================================================================
2025-11-20 17:58:35 - data_layer - INFO - Total interactions:             338,044
2025-11-20 17:58:35 - data_layer - INFO - Rows with comments:             329,066 (97.34%)
2025-11-20 17:58:35 - data_layer - INFO - Rows without comments:            8,978 (2.66%)
2025-11-20 17:58:35 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 17:58:35 - data_layer - INFO -   Min:    0.000
2025-11-20 17:58:35 - data_layer - INFO -   Mean:   0.223
2025-11-20 17:58:35 - data_layer - INFO -   Median: 0.200
2025-11-20 17:58:35 - data_layer - INFO -   Max:    0.500
2025-11-20 17:58:35 - data_layer - INFO -   Std:    0.101
2025-11-20 17:58:35 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 17:58:35 - data_layer - INFO -   Min:    1.000
2025-11-20 17:58:35 - data_layer - INFO -   Mean:   5.141
2025-11-20 17:58:35 - data_layer - INFO -   Median: 5.200
2025-11-20 17:58:35 - data_layer - INFO -   Max:    5.500
2025-11-20 17:58:35 - data_layer - INFO -   Std:    0.456
2025-11-20 17:58:35 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 17:58:35 - data_layer - INFO -   Zero quality (0.0):              26,170 (7.74%)
2025-11-20 17:58:35 - data_layer - INFO -   Low quality (0.0-0.2):          194,059 (57.41%)
2025-11-20 17:58:35 - data_layer - INFO -   Medium quality (0.2-0.5):       117,815 (34.85%)
2025-11-20 17:58:35 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 17:58:35 - data_layer - INFO - ================================================================================

2025-11-20 17:58:35 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 17:58:36 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:36 - data_layer - INFO - STEP 2.1: ALS CONFIDENCE-WEIGHTED MATRIX
2025-11-20 17:58:36 - data_layer - INFO - ================================================================================
2025-11-20 17:58:36 - data_layer - INFO - Building explicit feedback matrix with sentiment-based weighting
2025-11-20 17:58:36 - data_layer - INFO - Processing 338,044 interactions
2025-11-20 17:58:36 - data_layer - INFO - Matrix shape: (304,708, 2,231)
2025-11-20 17:58:36 - data_layer - INFO - Confidence score range: [1.000, 5.500]
2025-11-20 17:58:36 - data_layer - INFO - Building CSR sparse matrix...
2025-11-20 17:58:36 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:58:36 - data_layer - INFO - ALS MATRIX SUMMARY
2025-11-20 17:58:36 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:36 - data_layer - INFO - Matrix shape:           (304708, 2231)
2025-11-20 17:58:36 - data_layer - INFO - Non-zero entries:       338,044
2025-11-20 17:58:36 - data_layer - INFO - Sparsity:               99.9503%
2025-11-20 17:58:36 - data_layer - INFO - Mean confidence:        5.141
2025-11-20 17:58:36 - data_layer - INFO - Median confidence:      5.200
2025-11-20 17:58:36 - data_layer - INFO - Std confidence:         0.456
2025-11-20 17:58:36 - data_layer - INFO - Confidence range:       [1.000, 5.500]
2025-11-20 17:58:36 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:36 - data_layer - INFO - ✓ ALS confidence matrix ready for training
2025-11-20 17:58:36 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:36 - data_layer - INFO - CONFIDENCE SCORE DISTRIBUTION ANALYSIS
2025-11-20 17:58:36 - data_layer - INFO - ================================================================================
2025-11-20 17:58:36 - data_layer - INFO - 
Rating 1 (⭐)
2025-11-20 17:58:36 - data_layer - INFO -   Count:       2,235 (0.66%)
2025-11-20 17:58:36 - data_layer - INFO -   Confidence:  1.198 ± 0.082
2025-11-20 17:58:36 - data_layer - INFO -   Range:       [1.000, 1.500]
2025-11-20 17:58:36 - data_layer - INFO -   Quartiles:   Q1=1.200, Q3=1.200
2025-11-20 17:58:36 - data_layer - INFO - 
Rating 2 (⭐⭐)
2025-11-20 17:58:36 - data_layer - INFO -   Count:       1,262 (0.37%)
2025-11-20 17:58:36 - data_layer - INFO -   Confidence:  2.202 ± 0.084
2025-11-20 17:58:36 - data_layer - INFO -   Range:       [2.000, 2.500]
2025-11-20 17:58:36 - data_layer - INFO -   Quartiles:   Q1=2.200, Q3=2.200
2025-11-20 17:58:36 - data_layer - INFO - 
Rating 3 (⭐⭐⭐)
2025-11-20 17:58:36 - data_layer - INFO -   Count:       3,107 (0.92%)
2025-11-20 17:58:36 - data_layer - INFO -   Confidence:  3.209 ± 0.085
2025-11-20 17:58:36 - data_layer - INFO -   Range:       [3.000, 3.500]
2025-11-20 17:58:36 - data_layer - INFO -   Quartiles:   Q1=3.200, Q3=3.300
2025-11-20 17:58:36 - data_layer - INFO - 
Rating 4 (⭐⭐⭐⭐)
2025-11-20 17:58:36 - data_layer - INFO -   Count:       8,658 (2.56%)
2025-11-20 17:58:36 - data_layer - INFO -   Confidence:  4.213 ± 0.093
2025-11-20 17:58:36 - data_layer - INFO -   Range:       [4.000, 4.500]
2025-11-20 17:58:36 - data_layer - INFO -   Quartiles:   Q1=4.200, Q3=4.300
2025-11-20 17:58:36 - data_layer - INFO - 
Rating 5 (⭐⭐⭐⭐⭐)
2025-11-20 17:58:36 - data_layer - INFO -   Count:       322,782 (95.49%)
2025-11-20 17:58:36 - data_layer - INFO -   Confidence:  5.224 ± 0.101
2025-11-20 17:58:36 - data_layer - INFO -   Range:       [5.000, 5.500]
2025-11-20 17:58:36 - data_layer - INFO -   Quartiles:   Q1=5.200, Q3=5.300
2025-11-20 17:58:36 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:36 - data_layer - INFO - Loading products data...
2025-11-20 17:58:36 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 17:58:36 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:36 - data_layer - INFO - STEP 2.2: BPR POSITIVE LABELS
2025-11-20 17:58:36 - data_layer - INFO - ================================================================================
2025-11-20 17:58:36 - data_layer - INFO - Positive threshold: rating >= 4.0
2025-11-20 17:58:36 - data_layer - INFO - 
Positive interactions:  331,440 (98.05%)
2025-11-20 17:58:36 - data_layer - INFO - Negative interactions:  6,604 (1.95%)
2025-11-20 17:58:36 - data_layer - INFO - 
Positive label distribution by rating:
2025-11-20 17:58:36 - data_layer - INFO -   Rating 1: 0/2,235 positive (0.0%)
2025-11-20 17:58:36 - data_layer - INFO -   Rating 2: 0/1,262 positive (0.0%)
2025-11-20 17:58:36 - data_layer - INFO -   Rating 3: 0/3,107 positive (0.0%)
2025-11-20 17:58:36 - data_layer - INFO -   Rating 4: 8,658/8,658 positive (100.0%)
2025-11-20 17:58:36 - data_layer - INFO -   Rating 5: 322,782/322,782 positive (100.0%)
2025-11-20 17:58:36 - data_layer - INFO - ✓ Positive labels created
2025-11-20 17:58:36 - data_layer - INFO - 
================================================================================
2025-11-20 17:58:36 - data_layer - INFO - STEP 2.2: HARD NEGATIVE MINING
2025-11-20 17:58:36 - data_layer - INFO - ================================================================================
2025-11-20 17:58:36 - data_layer - INFO - Dual strategy: Explicit (low ratings) + Implicit (popular items not bought)
2025-11-20 17:58:36 - data_layer - INFO - 
Strategy 1: Explicit hard negatives (rating <= 3.0)
2025-11-20 17:58:36 - data_layer - INFO -   Found 6,604 explicit hard negatives
2025-11-20 17:58:36 - data_layer - INFO - 
Strategy 2: Implicit hard negatives (Top-50 popular items)
2025-11-20 17:58:36 - data_layer - INFO -     Popular items range: 12900 - 185700 sales
2025-11-20 17:58:36 - data_layer - INFO -   Top-50 popular items identified
2025-11-20 17:58:44 - data_layer - INFO -   Generated 15,189,361 implicit hard negatives
2025-11-20 17:58:44 - data_layer - INFO -   Average 49.8 per user
2025-11-20 17:58:45 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 17:58:45 - data_layer - INFO - HARD NEGATIVE MINING SUMMARY
2025-11-20 17:58:45 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:45 - data_layer - INFO - Total hard negatives:      6,604 (1.95%)
2025-11-20 17:58:45 - data_layer - INFO -   - Explicit (low rating): 6,604
2025-11-20 17:58:45 - data_layer - INFO -   - Implicit (popularity): 0
2025-11-20 17:58:45 - data_layer - INFO - Users with hard negatives: 304,708
2025-11-20 17:58:45 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 17:58:45 - data_layer - INFO - ✓ Hard negative mining completed
2025-11-20 17:58:45 - data_layer - INFO - 
Validating BPR labels...
2025-11-20 17:58:45 - data_layer - INFO - ✓ BPR labels validation passed
2025-11-20 17:58:45 - data_layer - INFO - 
Building user positive item sets...
2025-11-20 17:58:51 - data_layer - INFO -   Users with positives: 298,910
2025-11-20 17:58:51 - data_layer - INFO -   Average positives per user: 1.11
2025-11-20 17:58:51 - data_layer - INFO - ✓ Positive sets built
2025-11-20 18:05:47 - data_layer - INFO - ================================================================================
2025-11-20 18:05:47 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 18:05:47 - data_layer - INFO - ================================================================================
2025-11-20 18:05:47 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 18:05:47 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 18:05:47 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 18:05:47 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 18:05:47 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:05:47 - data_layer - INFO - Loading interactions data...
2025-11-20 18:05:49 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 18:05:49 - data_layer - INFO - 
Loading products data...
2025-11-20 18:05:49 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 18:05:49 - data_layer - INFO - 
Loading attributes data...
2025-11-20 18:05:49 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 18:05:49 - data_layer - INFO - 
Loading shops data...
2025-11-20 18:05:49 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 18:05:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:05:49 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 18:05:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:05:49 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 18:05:49 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 18:05:49 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 18:05:49 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 18:05:49 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 18:05:49 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 18:05:49 - data_layer - INFO - 
================================================================================
2025-11-20 18:05:49 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 18:05:49 - data_layer - INFO - ================================================================================

2025-11-20 18:05:49 - data_layer - INFO - 
================================================================================
2025-11-20 18:05:49 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 18:05:49 - data_layer - INFO - ================================================================================
2025-11-20 18:05:49 - data_layer - INFO - Initial row count: 369,099
2025-11-20 18:05:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:05:49 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 18:05:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:05:49 - data_layer - INFO - Converting user_id to integer...
2025-11-20 18:05:49 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 18:05:49 - data_layer - INFO - Converting product_id to integer...
2025-11-20 18:05:49 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 18:05:49 - data_layer - INFO - Converting rating to float...
2025-11-20 18:05:49 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 18:05:49 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 18:05:49 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 18:05:49 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 18:05:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:05:49 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 18:05:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:05:49 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 18:05:49 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 18:05:49 - data_layer - INFO - ✓ No missing rating values
2025-11-20 18:05:49 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 18:05:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:05:49 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 18:05:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:05:49 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 18:05:49 - data_layer - INFO - Rating statistics before validation:
2025-11-20 18:05:49 - data_layer - INFO -   Min: 1.00
2025-11-20 18:05:49 - data_layer - INFO -   Max: 5.00
2025-11-20 18:05:49 - data_layer - INFO -   Mean: 4.92
2025-11-20 18:05:49 - data_layer - INFO -   Median: 5.00
2025-11-20 18:05:49 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 18:05:49 - data_layer - INFO - 
================================================================================
2025-11-20 18:05:49 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 18:05:49 - data_layer - INFO - ================================================================================
2025-11-20 18:05:49 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 18:05:49 - data_layer - INFO - Missing user_id:                      0
2025-11-20 18:05:49 - data_layer - INFO - Missing product_id:                   0
2025-11-20 18:05:49 - data_layer - INFO - Missing rating:                       0
2025-11-20 18:05:49 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 18:05:49 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 18:05:49 - data_layer - INFO - Type conversion errors:               0
2025-11-20 18:05:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:05:49 - data_layer - INFO - Total dropped:                        0
2025-11-20 18:05:49 - data_layer - INFO - Final rows:                     369,099
2025-11-20 18:05:49 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 18:05:49 - data_layer - INFO - ================================================================================

2025-11-20 18:05:49 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 18:07:00 - data_layer - INFO - ================================================================================
2025-11-20 18:07:00 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 18:07:00 - data_layer - INFO - ================================================================================
2025-11-20 18:07:00 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 18:07:00 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 18:07:00 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 18:07:00 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 18:07:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:07:00 - data_layer - INFO - Loading interactions data...
2025-11-20 18:07:02 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 18:07:02 - data_layer - INFO - 
Loading products data...
2025-11-20 18:07:02 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 18:07:02 - data_layer - INFO - 
Loading attributes data...
2025-11-20 18:07:02 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 18:07:02 - data_layer - INFO - 
Loading shops data...
2025-11-20 18:07:02 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 18:07:02 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:07:02 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 18:07:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:07:02 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 18:07:02 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 18:07:02 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 18:07:02 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 18:07:02 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 18:07:02 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 18:07:02 - data_layer - INFO - 
================================================================================
2025-11-20 18:07:02 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 18:07:02 - data_layer - INFO - ================================================================================

2025-11-20 18:07:02 - data_layer - INFO - 
================================================================================
2025-11-20 18:07:02 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 18:07:02 - data_layer - INFO - ================================================================================
2025-11-20 18:07:02 - data_layer - INFO - Initial row count: 369,099
2025-11-20 18:07:02 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:07:02 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 18:07:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:07:02 - data_layer - INFO - Converting user_id to integer...
2025-11-20 18:07:02 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 18:07:02 - data_layer - INFO - Converting product_id to integer...
2025-11-20 18:07:02 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 18:07:02 - data_layer - INFO - Converting rating to float...
2025-11-20 18:07:02 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 18:07:02 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 18:07:02 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 18:07:02 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 18:07:02 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:07:02 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 18:07:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:07:02 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 18:07:02 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 18:07:02 - data_layer - INFO - ✓ No missing rating values
2025-11-20 18:07:02 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 18:07:02 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:07:02 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 18:07:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:07:02 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 18:07:02 - data_layer - INFO - Rating statistics before validation:
2025-11-20 18:07:02 - data_layer - INFO -   Min: 1.00
2025-11-20 18:07:02 - data_layer - INFO -   Max: 5.00
2025-11-20 18:07:02 - data_layer - INFO -   Mean: 4.92
2025-11-20 18:07:02 - data_layer - INFO -   Median: 5.00
2025-11-20 18:07:02 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 18:07:02 - data_layer - INFO - 
================================================================================
2025-11-20 18:07:02 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 18:07:02 - data_layer - INFO - ================================================================================
2025-11-20 18:07:02 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 18:07:02 - data_layer - INFO - Missing user_id:                      0
2025-11-20 18:07:02 - data_layer - INFO - Missing product_id:                   0
2025-11-20 18:07:02 - data_layer - INFO - Missing rating:                       0
2025-11-20 18:07:02 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 18:07:02 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 18:07:02 - data_layer - INFO - Type conversion errors:               0
2025-11-20 18:07:02 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:07:02 - data_layer - INFO - Total dropped:                        0
2025-11-20 18:07:02 - data_layer - INFO - Final rows:                     369,099
2025-11-20 18:07:02 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 18:07:02 - data_layer - INFO - ================================================================================

2025-11-20 18:07:02 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 18:07:02 - data_layer - INFO - 
================================================================================
2025-11-20 18:07:02 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 18:07:02 - data_layer - INFO - ================================================================================
2025-11-20 18:07:02 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 18:07:02 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 18:07:02 - data_layer - INFO - Processing 369,099 interactions
2025-11-20 18:07:02 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 18:07:02 - data_layer - INFO - Quality scoring criteria:
2025-11-20 18:07:02 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 18:07:02 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 18:07:02 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 18:07:07 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 18:07:07 - data_layer - INFO - 
================================================================================
2025-11-20 18:07:07 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 18:07:07 - data_layer - INFO - ================================================================================
2025-11-20 18:07:07 - data_layer - INFO - Total interactions:             369,099
2025-11-20 18:07:07 - data_layer - INFO - Rows with comments:             359,418 (97.38%)
2025-11-20 18:07:07 - data_layer - INFO - Rows without comments:            9,681 (2.62%)
2025-11-20 18:07:07 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 18:07:07 - data_layer - INFO -   Min:    0.000
2025-11-20 18:07:07 - data_layer - INFO -   Mean:   0.223
2025-11-20 18:07:07 - data_layer - INFO -   Median: 0.200
2025-11-20 18:07:07 - data_layer - INFO -   Max:    0.500
2025-11-20 18:07:07 - data_layer - INFO -   Std:    0.100
2025-11-20 18:07:07 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 18:07:07 - data_layer - INFO -   Min:    1.000
2025-11-20 18:07:07 - data_layer - INFO -   Mean:   5.146
2025-11-20 18:07:07 - data_layer - INFO -   Median: 5.200
2025-11-20 18:07:07 - data_layer - INFO -   Max:    5.500
2025-11-20 18:07:07 - data_layer - INFO -   Std:    0.443
2025-11-20 18:07:07 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 18:07:07 - data_layer - INFO -   Zero quality (0.0):              27,957 (7.57%)
2025-11-20 18:07:07 - data_layer - INFO -   Low quality (0.0-0.2):          212,076 (57.46%)
2025-11-20 18:07:07 - data_layer - INFO -   Medium quality (0.2-0.5):       129,066 (34.97%)
2025-11-20 18:07:07 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 18:07:07 - data_layer - INFO - ================================================================================

2025-11-20 18:07:07 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 18:11:33 - data_layer - INFO - ================================================================================
2025-11-20 18:11:33 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 18:11:33 - data_layer - INFO - ================================================================================
2025-11-20 18:11:33 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 18:11:33 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 18:11:33 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 18:11:33 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 18:11:33 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:11:33 - data_layer - INFO - Loading interactions data...
2025-11-20 18:11:35 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 18:11:35 - data_layer - INFO - 
Loading products data...
2025-11-20 18:11:35 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 18:11:35 - data_layer - INFO - 
Loading attributes data...
2025-11-20 18:11:35 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 18:11:35 - data_layer - INFO - 
Loading shops data...
2025-11-20 18:11:35 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 18:11:35 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:11:35 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 18:11:35 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:11:35 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 18:11:35 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 18:11:35 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 18:11:36 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 18:11:36 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 18:11:36 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 18:11:36 - data_layer - INFO - 
================================================================================
2025-11-20 18:11:36 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 18:11:36 - data_layer - INFO - ================================================================================

2025-11-20 18:11:36 - data_layer - INFO - 
================================================================================
2025-11-20 18:11:36 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 18:11:36 - data_layer - INFO - ================================================================================
2025-11-20 18:11:36 - data_layer - INFO - Initial row count: 369,099
2025-11-20 18:11:36 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:11:36 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 18:11:36 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:11:36 - data_layer - INFO - Converting user_id to integer...
2025-11-20 18:11:36 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 18:11:36 - data_layer - INFO - Converting product_id to integer...
2025-11-20 18:11:36 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 18:11:36 - data_layer - INFO - Converting rating to float...
2025-11-20 18:11:36 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 18:11:36 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 18:11:36 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 18:11:36 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 18:11:36 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:11:36 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 18:11:36 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:11:36 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 18:11:36 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 18:11:36 - data_layer - INFO - ✓ No missing rating values
2025-11-20 18:11:36 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 18:11:36 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:11:36 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 18:11:36 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:11:36 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 18:11:36 - data_layer - INFO - Rating statistics before validation:
2025-11-20 18:11:36 - data_layer - INFO -   Min: 1.00
2025-11-20 18:11:36 - data_layer - INFO -   Max: 5.00
2025-11-20 18:11:36 - data_layer - INFO -   Mean: 4.92
2025-11-20 18:11:36 - data_layer - INFO -   Median: 5.00
2025-11-20 18:11:36 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 18:11:36 - data_layer - INFO - 
================================================================================
2025-11-20 18:11:36 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 18:11:36 - data_layer - INFO - ================================================================================
2025-11-20 18:11:36 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 18:11:36 - data_layer - INFO - Missing user_id:                      0
2025-11-20 18:11:36 - data_layer - INFO - Missing product_id:                   0
2025-11-20 18:11:36 - data_layer - INFO - Missing rating:                       0
2025-11-20 18:11:36 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 18:11:36 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 18:11:36 - data_layer - INFO - Type conversion errors:               0
2025-11-20 18:11:36 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:11:36 - data_layer - INFO - Total dropped:                        0
2025-11-20 18:11:36 - data_layer - INFO - Final rows:                     369,099
2025-11-20 18:11:36 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 18:11:36 - data_layer - INFO - ================================================================================

2025-11-20 18:11:36 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 18:11:36 - data_layer - INFO - 
================================================================================
2025-11-20 18:11:36 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 18:11:36 - data_layer - INFO - ================================================================================
2025-11-20 18:11:36 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 18:11:36 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 18:11:36 - data_layer - INFO - Processing 369,099 interactions
2025-11-20 18:11:36 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 18:11:36 - data_layer - INFO - Quality scoring criteria:
2025-11-20 18:11:36 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 18:11:36 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 18:11:36 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 18:11:41 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 18:11:41 - data_layer - INFO - 
================================================================================
2025-11-20 18:11:41 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 18:11:41 - data_layer - INFO - ================================================================================
2025-11-20 18:11:41 - data_layer - INFO - Total interactions:             369,099
2025-11-20 18:11:41 - data_layer - INFO - Rows with comments:             359,418 (97.38%)
2025-11-20 18:11:41 - data_layer - INFO - Rows without comments:            9,681 (2.62%)
2025-11-20 18:11:41 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 18:11:41 - data_layer - INFO -   Min:    0.000
2025-11-20 18:11:42 - data_layer - INFO -   Mean:   0.223
2025-11-20 18:11:42 - data_layer - INFO -   Median: 0.200
2025-11-20 18:11:42 - data_layer - INFO -   Max:    0.500
2025-11-20 18:11:42 - data_layer - INFO -   Std:    0.100
2025-11-20 18:11:42 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 18:11:42 - data_layer - INFO -   Min:    1.000
2025-11-20 18:11:42 - data_layer - INFO -   Mean:   5.146
2025-11-20 18:11:42 - data_layer - INFO -   Median: 5.200
2025-11-20 18:11:42 - data_layer - INFO -   Max:    5.500
2025-11-20 18:11:42 - data_layer - INFO -   Std:    0.443
2025-11-20 18:11:42 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 18:11:42 - data_layer - INFO -   Zero quality (0.0):              27,957 (7.57%)
2025-11-20 18:11:42 - data_layer - INFO -   Low quality (0.0-0.2):          212,076 (57.46%)
2025-11-20 18:11:42 - data_layer - INFO -   Medium quality (0.2-0.5):       129,066 (34.97%)
2025-11-20 18:11:42 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 18:11:42 - data_layer - INFO - ================================================================================

2025-11-20 18:11:42 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 18:11:42 - data_layer - INFO - 
================================================================================
2025-11-20 18:11:42 - data_layer - INFO - STEP 2.2: BPR POSITIVE LABELS
2025-11-20 18:11:42 - data_layer - INFO - ================================================================================
2025-11-20 18:11:42 - data_layer - INFO - Positive threshold: rating >= 4.0
2025-11-20 18:11:42 - data_layer - INFO - 
Positive interactions:  362,313 (98.16%)
2025-11-20 18:11:42 - data_layer - INFO - Negative interactions:  6,786 (1.84%)
2025-11-20 18:11:42 - data_layer - INFO - 
Positive label distribution by rating:
2025-11-20 18:11:42 - data_layer - INFO -   Rating 1: 0/2,271 positive (0.0%)
2025-11-20 18:11:42 - data_layer - INFO -   Rating 2: 0/1,308 positive (0.0%)
2025-11-20 18:11:42 - data_layer - INFO -   Rating 3: 0/3,207 positive (0.0%)
2025-11-20 18:11:42 - data_layer - INFO -   Rating 4: 9,147/9,147 positive (100.0%)
2025-11-20 18:11:42 - data_layer - INFO -   Rating 5: 353,166/353,166 positive (100.0%)
2025-11-20 18:11:42 - data_layer - INFO - ✓ Positive labels created
2025-11-20 18:11:42 - data_layer - INFO - 
================================================================================
2025-11-20 18:11:42 - data_layer - INFO - STEP 2.2: HARD NEGATIVE MINING
2025-11-20 18:11:42 - data_layer - INFO - ================================================================================
2025-11-20 18:11:42 - data_layer - INFO - Dual strategy: Explicit (low ratings) + Implicit (popular items not bought)
2025-11-20 18:11:42 - data_layer - INFO - 
Strategy 1: Explicit hard negatives (rating <= 3.0)
2025-11-20 18:11:42 - data_layer - INFO -   Found 6,786 explicit hard negatives
2025-11-20 18:11:42 - data_layer - INFO - 
Strategy 2: Implicit hard negatives (Top-50 popular items)
2025-11-20 18:11:42 - data_layer - WARNING - ⚠ Products DataFrame not provided - skipping implicit negatives
2025-11-20 18:14:30 - data_layer - INFO - ================================================================================
2025-11-20 18:14:30 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 18:14:30 - data_layer - INFO - ================================================================================
2025-11-20 18:14:30 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 18:14:30 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 18:14:30 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 18:14:30 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 18:14:30 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:14:30 - data_layer - INFO - Loading interactions data...
2025-11-20 18:14:32 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 18:14:32 - data_layer - INFO - 
Loading products data...
2025-11-20 18:14:32 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 18:14:32 - data_layer - INFO - 
Loading attributes data...
2025-11-20 18:14:32 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 18:14:32 - data_layer - INFO - 
Loading shops data...
2025-11-20 18:14:32 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 18:14:32 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:14:32 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 18:14:32 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:14:32 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 18:14:32 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 18:14:32 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 18:14:32 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 18:14:32 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 18:14:32 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 18:14:32 - data_layer - INFO - 
================================================================================
2025-11-20 18:14:32 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 18:14:32 - data_layer - INFO - ================================================================================

2025-11-20 18:14:32 - data_layer - INFO - 
================================================================================
2025-11-20 18:14:32 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 18:14:32 - data_layer - INFO - ================================================================================
2025-11-20 18:14:32 - data_layer - INFO - Initial row count: 369,099
2025-11-20 18:14:32 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:14:32 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 18:14:32 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:14:32 - data_layer - INFO - Converting user_id to integer...
2025-11-20 18:14:32 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 18:14:32 - data_layer - INFO - Converting product_id to integer...
2025-11-20 18:14:32 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 18:14:32 - data_layer - INFO - Converting rating to float...
2025-11-20 18:14:32 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 18:14:32 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 18:14:32 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 18:14:32 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 18:14:32 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:14:32 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 18:14:32 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:14:32 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 18:14:32 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 18:14:32 - data_layer - INFO - ✓ No missing rating values
2025-11-20 18:14:32 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 18:14:32 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:14:32 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 18:14:32 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:14:32 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 18:14:33 - data_layer - INFO - Rating statistics before validation:
2025-11-20 18:14:33 - data_layer - INFO -   Min: 1.00
2025-11-20 18:14:33 - data_layer - INFO -   Max: 5.00
2025-11-20 18:14:33 - data_layer - INFO -   Mean: 4.92
2025-11-20 18:14:33 - data_layer - INFO -   Median: 5.00
2025-11-20 18:14:33 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 18:14:33 - data_layer - INFO - 
================================================================================
2025-11-20 18:14:33 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 18:14:33 - data_layer - INFO - ================================================================================
2025-11-20 18:14:33 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 18:14:33 - data_layer - INFO - Missing user_id:                      0
2025-11-20 18:14:33 - data_layer - INFO - Missing product_id:                   0
2025-11-20 18:14:33 - data_layer - INFO - Missing rating:                       0
2025-11-20 18:14:33 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 18:14:33 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 18:14:33 - data_layer - INFO - Type conversion errors:               0
2025-11-20 18:14:33 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:14:33 - data_layer - INFO - Total dropped:                        0
2025-11-20 18:14:33 - data_layer - INFO - Final rows:                     369,099
2025-11-20 18:14:33 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 18:14:33 - data_layer - INFO - ================================================================================

2025-11-20 18:14:33 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 18:14:33 - data_layer - INFO - 
================================================================================
2025-11-20 18:14:33 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 18:14:33 - data_layer - INFO - ================================================================================
2025-11-20 18:14:33 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 18:14:33 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 18:14:33 - data_layer - INFO - Processing 369,099 interactions
2025-11-20 18:14:33 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 18:14:33 - data_layer - INFO - Quality scoring criteria:
2025-11-20 18:14:33 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 18:14:33 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 18:14:33 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 18:14:38 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 18:14:39 - data_layer - INFO - 
================================================================================
2025-11-20 18:14:39 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 18:14:39 - data_layer - INFO - ================================================================================
2025-11-20 18:14:39 - data_layer - INFO - Total interactions:             369,099
2025-11-20 18:14:39 - data_layer - INFO - Rows with comments:             359,418 (97.38%)
2025-11-20 18:14:39 - data_layer - INFO - Rows without comments:            9,681 (2.62%)
2025-11-20 18:14:39 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 18:14:39 - data_layer - INFO -   Min:    0.000
2025-11-20 18:14:39 - data_layer - INFO -   Mean:   0.223
2025-11-20 18:14:39 - data_layer - INFO -   Median: 0.200
2025-11-20 18:14:39 - data_layer - INFO -   Max:    0.500
2025-11-20 18:14:39 - data_layer - INFO -   Std:    0.100
2025-11-20 18:14:39 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 18:14:39 - data_layer - INFO -   Min:    1.000
2025-11-20 18:14:39 - data_layer - INFO -   Mean:   5.146
2025-11-20 18:14:39 - data_layer - INFO -   Median: 5.200
2025-11-20 18:14:39 - data_layer - INFO -   Max:    5.500
2025-11-20 18:14:39 - data_layer - INFO -   Std:    0.443
2025-11-20 18:14:39 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 18:14:39 - data_layer - INFO -   Zero quality (0.0):              27,957 (7.57%)
2025-11-20 18:14:39 - data_layer - INFO -   Low quality (0.0-0.2):          212,076 (57.46%)
2025-11-20 18:14:39 - data_layer - INFO -   Medium quality (0.2-0.5):       129,066 (34.97%)
2025-11-20 18:14:39 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 18:14:39 - data_layer - INFO - ================================================================================

2025-11-20 18:14:39 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 18:14:39 - data_layer - INFO - 
================================================================================
2025-11-20 18:14:39 - data_layer - INFO - STEP 2.2: BPR POSITIVE LABELS
2025-11-20 18:14:39 - data_layer - INFO - ================================================================================
2025-11-20 18:14:39 - data_layer - INFO - Positive threshold: rating >= 4.0
2025-11-20 18:14:39 - data_layer - INFO - 
Positive interactions:  362,313 (98.16%)
2025-11-20 18:14:39 - data_layer - INFO - Negative interactions:  6,786 (1.84%)
2025-11-20 18:14:39 - data_layer - INFO - 
Positive label distribution by rating:
2025-11-20 18:14:39 - data_layer - INFO -   Rating 1: 0/2,271 positive (0.0%)
2025-11-20 18:14:39 - data_layer - INFO -   Rating 2: 0/1,308 positive (0.0%)
2025-11-20 18:14:39 - data_layer - INFO -   Rating 3: 0/3,207 positive (0.0%)
2025-11-20 18:14:39 - data_layer - INFO -   Rating 4: 9,147/9,147 positive (100.0%)
2025-11-20 18:14:39 - data_layer - INFO -   Rating 5: 353,166/353,166 positive (100.0%)
2025-11-20 18:14:39 - data_layer - INFO - ✓ Positive labels created
2025-11-20 18:14:39 - data_layer - INFO - 
================================================================================
2025-11-20 18:14:39 - data_layer - INFO - STEP 2.2: HARD NEGATIVE MINING
2025-11-20 18:14:39 - data_layer - INFO - ================================================================================
2025-11-20 18:14:39 - data_layer - INFO - Dual strategy: Explicit (low ratings) + Implicit (popular items not bought)
2025-11-20 18:14:39 - data_layer - INFO - 
Strategy 1: Explicit hard negatives (rating <= 3.0)
2025-11-20 18:14:39 - data_layer - INFO -   Found 6,786 explicit hard negatives
2025-11-20 18:14:39 - data_layer - INFO - 
Strategy 2: Implicit hard negatives (Top-50 popular items)
2025-11-20 18:14:39 - data_layer - WARNING - ⚠ Products DataFrame not provided - skipping implicit negatives
2025-11-20 18:14:39 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:14:39 - data_layer - INFO - HARD NEGATIVE MINING SUMMARY
2025-11-20 18:14:39 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:14:39 - data_layer - INFO - Total hard negatives:      6,786 (1.84%)
2025-11-20 18:14:39 - data_layer - INFO -   - Explicit (low rating): 6,786
2025-11-20 18:14:39 - data_layer - INFO - Users with hard negatives: 6,694
2025-11-20 18:14:39 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:14:39 - data_layer - INFO - ✓ Hard negative mining completed
2025-11-20 18:14:39 - data_layer - INFO - 
Validating BPR labels...
2025-11-20 18:14:39 - data_layer - INFO - ✓ BPR labels validation passed
2025-11-20 18:15:23 - data_layer - INFO - ================================================================================
2025-11-20 18:15:23 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 18:15:23 - data_layer - INFO - ================================================================================
2025-11-20 18:15:23 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 18:15:23 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 18:15:23 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 18:15:23 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 18:15:23 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:15:23 - data_layer - INFO - Loading interactions data...
2025-11-20 18:15:25 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 18:15:25 - data_layer - INFO - 
Loading products data...
2025-11-20 18:15:25 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 18:15:25 - data_layer - INFO - 
Loading attributes data...
2025-11-20 18:15:25 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 18:15:25 - data_layer - INFO - 
Loading shops data...
2025-11-20 18:15:25 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 18:15:25 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:15:25 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 18:15:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:15:25 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 18:15:25 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 18:15:25 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 18:15:25 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 18:15:25 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 18:15:25 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 18:15:25 - data_layer - INFO - 
================================================================================
2025-11-20 18:15:25 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 18:15:25 - data_layer - INFO - ================================================================================

2025-11-20 18:15:25 - data_layer - INFO - 
================================================================================
2025-11-20 18:15:25 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 18:15:25 - data_layer - INFO - ================================================================================
2025-11-20 18:15:25 - data_layer - INFO - Initial row count: 369,099
2025-11-20 18:15:25 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:15:25 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 18:15:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:15:25 - data_layer - INFO - Converting user_id to integer...
2025-11-20 18:15:25 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 18:15:25 - data_layer - INFO - Converting product_id to integer...
2025-11-20 18:15:25 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 18:15:25 - data_layer - INFO - Converting rating to float...
2025-11-20 18:15:25 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 18:15:25 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 18:15:25 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 18:15:25 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 18:15:25 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:15:25 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 18:15:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:15:25 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 18:15:25 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 18:15:25 - data_layer - INFO - ✓ No missing rating values
2025-11-20 18:15:25 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 18:15:25 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:15:25 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 18:15:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:15:25 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 18:15:25 - data_layer - INFO - Rating statistics before validation:
2025-11-20 18:15:25 - data_layer - INFO -   Min: 1.00
2025-11-20 18:15:25 - data_layer - INFO -   Max: 5.00
2025-11-20 18:15:25 - data_layer - INFO -   Mean: 4.92
2025-11-20 18:15:25 - data_layer - INFO -   Median: 5.00
2025-11-20 18:15:25 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 18:15:25 - data_layer - INFO - 
================================================================================
2025-11-20 18:15:25 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 18:15:25 - data_layer - INFO - ================================================================================
2025-11-20 18:15:25 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 18:15:25 - data_layer - INFO - Missing user_id:                      0
2025-11-20 18:15:25 - data_layer - INFO - Missing product_id:                   0
2025-11-20 18:15:25 - data_layer - INFO - Missing rating:                       0
2025-11-20 18:15:25 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 18:15:25 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 18:15:25 - data_layer - INFO - Type conversion errors:               0
2025-11-20 18:15:25 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:15:25 - data_layer - INFO - Total dropped:                        0
2025-11-20 18:15:25 - data_layer - INFO - Final rows:                     369,099
2025-11-20 18:15:25 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 18:15:25 - data_layer - INFO - ================================================================================

2025-11-20 18:15:25 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 18:15:26 - data_layer - INFO - 
================================================================================
2025-11-20 18:15:26 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 18:15:26 - data_layer - INFO - ================================================================================
2025-11-20 18:15:26 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 18:15:26 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 18:15:26 - data_layer - INFO - Processing 369,099 interactions
2025-11-20 18:15:26 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 18:15:26 - data_layer - INFO - Quality scoring criteria:
2025-11-20 18:15:26 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 18:15:26 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 18:15:26 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 18:15:30 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 18:15:31 - data_layer - INFO - 
================================================================================
2025-11-20 18:15:31 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 18:15:31 - data_layer - INFO - ================================================================================
2025-11-20 18:15:31 - data_layer - INFO - Total interactions:             369,099
2025-11-20 18:15:31 - data_layer - INFO - Rows with comments:             359,418 (97.38%)
2025-11-20 18:15:31 - data_layer - INFO - Rows without comments:            9,681 (2.62%)
2025-11-20 18:15:31 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 18:15:31 - data_layer - INFO -   Min:    0.000
2025-11-20 18:15:31 - data_layer - INFO -   Mean:   0.223
2025-11-20 18:15:31 - data_layer - INFO -   Median: 0.200
2025-11-20 18:15:31 - data_layer - INFO -   Max:    0.500
2025-11-20 18:15:31 - data_layer - INFO -   Std:    0.100
2025-11-20 18:15:31 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 18:15:31 - data_layer - INFO -   Min:    1.000
2025-11-20 18:15:31 - data_layer - INFO -   Mean:   5.146
2025-11-20 18:15:31 - data_layer - INFO -   Median: 5.200
2025-11-20 18:15:31 - data_layer - INFO -   Max:    5.500
2025-11-20 18:15:31 - data_layer - INFO -   Std:    0.443
2025-11-20 18:15:31 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 18:15:31 - data_layer - INFO -   Zero quality (0.0):              27,957 (7.57%)
2025-11-20 18:15:31 - data_layer - INFO -   Low quality (0.0-0.2):          212,076 (57.46%)
2025-11-20 18:15:31 - data_layer - INFO -   Medium quality (0.2-0.5):       129,066 (34.97%)
2025-11-20 18:15:31 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 18:15:31 - data_layer - INFO - ================================================================================

2025-11-20 18:15:31 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 18:15:31 - data_layer - INFO - 
================================================================================
2025-11-20 18:15:31 - data_layer - INFO - STEP 2.2: BPR POSITIVE LABELS
2025-11-20 18:15:31 - data_layer - INFO - ================================================================================
2025-11-20 18:15:31 - data_layer - INFO - Positive threshold: rating >= 4.0
2025-11-20 18:15:31 - data_layer - INFO - 
Positive interactions:  362,313 (98.16%)
2025-11-20 18:15:31 - data_layer - INFO - Negative interactions:  6,786 (1.84%)
2025-11-20 18:15:31 - data_layer - INFO - 
Positive label distribution by rating:
2025-11-20 18:15:31 - data_layer - INFO -   Rating 1: 0/2,271 positive (0.0%)
2025-11-20 18:15:31 - data_layer - INFO -   Rating 2: 0/1,308 positive (0.0%)
2025-11-20 18:15:31 - data_layer - INFO -   Rating 3: 0/3,207 positive (0.0%)
2025-11-20 18:15:31 - data_layer - INFO -   Rating 4: 9,147/9,147 positive (100.0%)
2025-11-20 18:15:31 - data_layer - INFO -   Rating 5: 353,166/353,166 positive (100.0%)
2025-11-20 18:15:31 - data_layer - INFO - ✓ Positive labels created
2025-11-20 18:15:31 - data_layer - INFO - 
================================================================================
2025-11-20 18:15:31 - data_layer - INFO - STEP 2.2: HARD NEGATIVE MINING
2025-11-20 18:15:31 - data_layer - INFO - ================================================================================
2025-11-20 18:15:31 - data_layer - INFO - Dual strategy: Explicit (low ratings) + Implicit (popular items not bought)
2025-11-20 18:15:31 - data_layer - INFO - 
Strategy 1: Explicit hard negatives (rating <= 3.0)
2025-11-20 18:15:31 - data_layer - INFO -   Found 6,786 explicit hard negatives
2025-11-20 18:15:31 - data_layer - INFO - 
Strategy 2: Implicit hard negatives (Top-50 popular items)
2025-11-20 18:15:31 - data_layer - WARNING - ⚠ Products DataFrame not provided - skipping implicit negatives
2025-11-20 18:15:31 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:15:31 - data_layer - INFO - HARD NEGATIVE MINING SUMMARY
2025-11-20 18:15:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:15:31 - data_layer - INFO - Total hard negatives:      6,786 (1.84%)
2025-11-20 18:15:31 - data_layer - INFO -   - Explicit (low rating): 6,786
2025-11-20 18:15:31 - data_layer - INFO - Users with hard negatives: 6,694
2025-11-20 18:15:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:15:31 - data_layer - INFO - ✓ Hard negative mining completed
2025-11-20 18:15:31 - data_layer - INFO - 
Validating BPR labels...
2025-11-20 18:15:31 - data_layer - INFO - ✓ BPR labels validation passed
2025-11-20 18:15:31 - data_layer - INFO - 
================================================================================
2025-11-20 18:15:31 - data_layer - INFO - STEP 2.3: USER FILTERING & SEGMENTATION
2025-11-20 18:15:31 - data_layer - INFO - ================================================================================
2025-11-20 18:15:31 - data_layer - INFO - Segmenting users: Trainable (≥2 interactions, ≥1 positive) vs Cold-start
2025-11-20 18:15:31 - data_layer - INFO - Configuration:
2025-11-20 18:15:31 - data_layer - INFO -   - Min user interactions: 2
2025-11-20 18:15:31 - data_layer - INFO -   - Min user positives: 1
2025-11-20 18:15:31 - data_layer - INFO -   - Positive threshold: rating ≥ 4.0
2025-11-20 18:16:09 - data_layer - INFO - ================================================================================
2025-11-20 18:16:09 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 18:16:09 - data_layer - INFO - ================================================================================
2025-11-20 18:16:09 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 18:16:09 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 18:16:09 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 18:16:09 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 18:16:09 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:09 - data_layer - INFO - Loading interactions data...
2025-11-20 18:16:11 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 18:16:11 - data_layer - INFO - 
Loading products data...
2025-11-20 18:16:11 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 18:16:11 - data_layer - INFO - 
Loading attributes data...
2025-11-20 18:16:11 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 18:16:11 - data_layer - INFO - 
Loading shops data...
2025-11-20 18:16:11 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 18:16:11 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:11 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 18:16:11 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:11 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 18:16:11 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 18:16:11 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 18:16:11 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 18:16:11 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 18:16:11 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 18:16:11 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:11 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 18:16:11 - data_layer - INFO - ================================================================================

2025-11-20 18:16:11 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:11 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 18:16:11 - data_layer - INFO - ================================================================================
2025-11-20 18:16:11 - data_layer - INFO - Initial row count: 369,099
2025-11-20 18:16:11 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:11 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 18:16:11 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:11 - data_layer - INFO - Converting user_id to integer...
2025-11-20 18:16:11 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 18:16:11 - data_layer - INFO - Converting product_id to integer...
2025-11-20 18:16:11 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 18:16:11 - data_layer - INFO - Converting rating to float...
2025-11-20 18:16:11 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 18:16:11 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 18:16:12 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 18:16:12 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 18:16:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:12 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 18:16:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:12 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 18:16:12 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 18:16:12 - data_layer - INFO - ✓ No missing rating values
2025-11-20 18:16:12 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 18:16:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:12 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 18:16:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:12 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 18:16:12 - data_layer - INFO - Rating statistics before validation:
2025-11-20 18:16:12 - data_layer - INFO -   Min: 1.00
2025-11-20 18:16:12 - data_layer - INFO -   Max: 5.00
2025-11-20 18:16:12 - data_layer - INFO -   Mean: 4.92
2025-11-20 18:16:12 - data_layer - INFO -   Median: 5.00
2025-11-20 18:16:12 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 18:16:12 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:12 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 18:16:12 - data_layer - INFO - ================================================================================
2025-11-20 18:16:12 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 18:16:12 - data_layer - INFO - Missing user_id:                      0
2025-11-20 18:16:12 - data_layer - INFO - Missing product_id:                   0
2025-11-20 18:16:12 - data_layer - INFO - Missing rating:                       0
2025-11-20 18:16:12 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 18:16:12 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 18:16:12 - data_layer - INFO - Type conversion errors:               0
2025-11-20 18:16:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:12 - data_layer - INFO - Total dropped:                        0
2025-11-20 18:16:12 - data_layer - INFO - Final rows:                     369,099
2025-11-20 18:16:12 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 18:16:12 - data_layer - INFO - ================================================================================

2025-11-20 18:16:12 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 18:16:12 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:12 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 18:16:12 - data_layer - INFO - ================================================================================
2025-11-20 18:16:12 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 18:16:12 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 18:16:12 - data_layer - INFO - Processing 369,099 interactions
2025-11-20 18:16:12 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 18:16:12 - data_layer - INFO - Quality scoring criteria:
2025-11-20 18:16:12 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 18:16:12 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 18:16:12 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 18:16:15 - data_layer - INFO - ================================================================================
2025-11-20 18:16:15 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 18:16:15 - data_layer - INFO - ================================================================================
2025-11-20 18:16:15 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 18:16:15 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 18:16:15 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 18:16:15 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 18:16:15 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:15 - data_layer - INFO - Loading interactions data...
2025-11-20 18:16:16 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 18:16:16 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:16 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 18:16:16 - data_layer - INFO - ================================================================================
2025-11-20 18:16:16 - data_layer - INFO - Total interactions:             369,099
2025-11-20 18:16:16 - data_layer - INFO - Rows with comments:             359,418 (97.38%)
2025-11-20 18:16:16 - data_layer - INFO - Rows without comments:            9,681 (2.62%)
2025-11-20 18:16:16 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 18:16:16 - data_layer - INFO -   Min:    0.000
2025-11-20 18:16:16 - data_layer - INFO -   Mean:   0.223
2025-11-20 18:16:16 - data_layer - INFO -   Median: 0.200
2025-11-20 18:16:16 - data_layer - INFO -   Max:    0.500
2025-11-20 18:16:16 - data_layer - INFO -   Std:    0.100
2025-11-20 18:16:16 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 18:16:16 - data_layer - INFO -   Min:    1.000
2025-11-20 18:16:16 - data_layer - INFO -   Mean:   5.146
2025-11-20 18:16:16 - data_layer - INFO -   Median: 5.200
2025-11-20 18:16:16 - data_layer - INFO -   Max:    5.500
2025-11-20 18:16:16 - data_layer - INFO -   Std:    0.443
2025-11-20 18:16:16 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 18:16:16 - data_layer - INFO -   Zero quality (0.0):              27,957 (7.57%)
2025-11-20 18:16:16 - data_layer - INFO -   Low quality (0.0-0.2):          212,076 (57.46%)
2025-11-20 18:16:16 - data_layer - INFO -   Medium quality (0.2-0.5):       129,066 (34.97%)
2025-11-20 18:16:16 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 18:16:16 - data_layer - INFO - ================================================================================

2025-11-20 18:16:16 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 18:16:16 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:16 - data_layer - INFO - STEP 2.2: BPR POSITIVE LABELS
2025-11-20 18:16:16 - data_layer - INFO - ================================================================================
2025-11-20 18:16:16 - data_layer - INFO - Positive threshold: rating >= 4.0
2025-11-20 18:16:16 - data_layer - INFO - 
Positive interactions:  362,313 (98.16%)
2025-11-20 18:16:16 - data_layer - INFO - Negative interactions:  6,786 (1.84%)
2025-11-20 18:16:16 - data_layer - INFO - 
Positive label distribution by rating:
2025-11-20 18:16:16 - data_layer - INFO -   Rating 1: 0/2,271 positive (0.0%)
2025-11-20 18:16:16 - data_layer - INFO -   Rating 2: 0/1,308 positive (0.0%)
2025-11-20 18:16:16 - data_layer - INFO -   Rating 3: 0/3,207 positive (0.0%)
2025-11-20 18:16:16 - data_layer - INFO -   Rating 4: 9,147/9,147 positive (100.0%)
2025-11-20 18:16:16 - data_layer - INFO -   Rating 5: 353,166/353,166 positive (100.0%)
2025-11-20 18:16:16 - data_layer - INFO - ✓ Positive labels created
2025-11-20 18:16:16 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:16 - data_layer - INFO - STEP 2.2: HARD NEGATIVE MINING
2025-11-20 18:16:16 - data_layer - INFO - ================================================================================
2025-11-20 18:16:16 - data_layer - INFO - Dual strategy: Explicit (low ratings) + Implicit (popular items not bought)
2025-11-20 18:16:16 - data_layer - INFO - 
Strategy 1: Explicit hard negatives (rating <= 3.0)
2025-11-20 18:16:16 - data_layer - INFO -   Found 6,786 explicit hard negatives
2025-11-20 18:16:16 - data_layer - INFO - 
Strategy 2: Implicit hard negatives (Top-50 popular items)
2025-11-20 18:16:16 - data_layer - WARNING - ⚠ Products DataFrame not provided - skipping implicit negatives
2025-11-20 18:16:17 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 18:16:17 - data_layer - INFO - 
Loading products data...
2025-11-20 18:16:17 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - HARD NEGATIVE MINING SUMMARY
2025-11-20 18:16:17 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - Total hard negatives:      6,786 (1.84%)
2025-11-20 18:16:17 - data_layer - INFO -   - Explicit (low rating): 6,786
2025-11-20 18:16:17 - data_layer - INFO - Users with hard negatives: 6,694
2025-11-20 18:16:17 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - ✓ Hard negative mining completed
2025-11-20 18:16:17 - data_layer - INFO - 
Validating BPR labels...
2025-11-20 18:16:17 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 18:16:17 - data_layer - INFO - 
Loading attributes data...
2025-11-20 18:16:17 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 18:16:17 - data_layer - INFO - 
Loading shops data...
2025-11-20 18:16:17 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 18:16:17 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 18:16:17 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 18:16:17 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 18:16:17 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 18:16:17 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 18:16:17 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 18:16:17 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 18:16:17 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:17 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 18:16:17 - data_layer - INFO - ================================================================================

2025-11-20 18:16:17 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:17 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 18:16:17 - data_layer - INFO - ================================================================================
2025-11-20 18:16:17 - data_layer - INFO - Initial row count: 369,099
2025-11-20 18:16:17 - data_layer - INFO - ✓ BPR labels validation passed
2025-11-20 18:16:17 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:17 - data_layer - INFO - STEP 2.3: USER FILTERING & SEGMENTATION
2025-11-20 18:16:17 - data_layer - INFO - ================================================================================
2025-11-20 18:16:17 - data_layer - INFO - Segmenting users: Trainable (≥2 interactions, ≥1 positive) vs Cold-start
2025-11-20 18:16:17 - data_layer - INFO - Configuration:
2025-11-20 18:16:17 - data_layer - INFO -   - Min user interactions: 2
2025-11-20 18:16:17 - data_layer - INFO -   - Min user positives: 1
2025-11-20 18:16:17 - data_layer - INFO -   - Positive threshold: rating ≥ 4.0
2025-11-20 18:16:17 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 18:16:17 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - Converting user_id to integer...
2025-11-20 18:16:17 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 18:16:17 - data_layer - INFO - Converting product_id to integer...
2025-11-20 18:16:17 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 18:16:17 - data_layer - INFO - Converting rating to float...
2025-11-20 18:16:17 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 18:16:17 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 18:16:17 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 18:16:17 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 18:16:17 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 18:16:17 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 18:16:17 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 18:16:17 - data_layer - INFO - ✓ No missing rating values
2025-11-20 18:16:17 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 18:16:17 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 18:16:17 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 18:16:17 - data_layer - INFO - Rating statistics before validation:
2025-11-20 18:16:17 - data_layer - INFO -   Min: 1.00
2025-11-20 18:16:17 - data_layer - INFO -   Max: 5.00
2025-11-20 18:16:17 - data_layer - INFO -   Mean: 4.92
2025-11-20 18:16:17 - data_layer - INFO -   Median: 5.00
2025-11-20 18:16:17 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 18:16:17 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:17 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 18:16:17 - data_layer - INFO - ================================================================================
2025-11-20 18:16:17 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 18:16:17 - data_layer - INFO - Missing user_id:                      0
2025-11-20 18:16:17 - data_layer - INFO - Missing product_id:                   0
2025-11-20 18:16:17 - data_layer - INFO - Missing rating:                       0
2025-11-20 18:16:17 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 18:16:17 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 18:16:17 - data_layer - INFO - Type conversion errors:               0
2025-11-20 18:16:17 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:17 - data_layer - INFO - Total dropped:                        0
2025-11-20 18:16:17 - data_layer - INFO - Final rows:                     369,099
2025-11-20 18:16:17 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 18:16:17 - data_layer - INFO - ================================================================================

2025-11-20 18:16:17 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 18:16:17 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:17 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 18:16:17 - data_layer - INFO - ================================================================================
2025-11-20 18:16:17 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 18:16:17 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 18:16:17 - data_layer - INFO - Processing 369,099 interactions
2025-11-20 18:16:17 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 18:16:17 - data_layer - INFO - Quality scoring criteria:
2025-11-20 18:16:17 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 18:16:17 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 18:16:17 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 18:16:21 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 18:16:22 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:22 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 18:16:22 - data_layer - INFO - ================================================================================
2025-11-20 18:16:22 - data_layer - INFO - Total interactions:             369,099
2025-11-20 18:16:22 - data_layer - INFO - Rows with comments:             359,418 (97.38%)
2025-11-20 18:16:22 - data_layer - INFO - Rows without comments:            9,681 (2.62%)
2025-11-20 18:16:22 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 18:16:22 - data_layer - INFO -   Min:    0.000
2025-11-20 18:16:22 - data_layer - INFO -   Mean:   0.223
2025-11-20 18:16:22 - data_layer - INFO -   Median: 0.200
2025-11-20 18:16:22 - data_layer - INFO -   Max:    0.500
2025-11-20 18:16:22 - data_layer - INFO -   Std:    0.100
2025-11-20 18:16:22 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 18:16:22 - data_layer - INFO -   Min:    1.000
2025-11-20 18:16:22 - data_layer - INFO -   Mean:   5.146
2025-11-20 18:16:22 - data_layer - INFO -   Median: 5.200
2025-11-20 18:16:22 - data_layer - INFO -   Max:    5.500
2025-11-20 18:16:22 - data_layer - INFO -   Std:    0.443
2025-11-20 18:16:22 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 18:16:22 - data_layer - INFO -   Zero quality (0.0):              27,957 (7.57%)
2025-11-20 18:16:22 - data_layer - INFO -   Low quality (0.0-0.2):          212,076 (57.46%)
2025-11-20 18:16:22 - data_layer - INFO -   Medium quality (0.2-0.5):       129,066 (34.97%)
2025-11-20 18:16:22 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 18:16:22 - data_layer - INFO - ================================================================================

2025-11-20 18:16:22 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 18:16:22 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:22 - data_layer - INFO - STEP 2.2: BPR POSITIVE LABELS
2025-11-20 18:16:22 - data_layer - INFO - ================================================================================
2025-11-20 18:16:22 - data_layer - INFO - Positive threshold: rating >= 4.0
2025-11-20 18:16:22 - data_layer - INFO - 
Positive interactions:  362,313 (98.16%)
2025-11-20 18:16:22 - data_layer - INFO - Negative interactions:  6,786 (1.84%)
2025-11-20 18:16:22 - data_layer - INFO - 
Positive label distribution by rating:
2025-11-20 18:16:22 - data_layer - INFO -   Rating 1: 0/2,271 positive (0.0%)
2025-11-20 18:16:22 - data_layer - INFO -   Rating 2: 0/1,308 positive (0.0%)
2025-11-20 18:16:22 - data_layer - INFO -   Rating 3: 0/3,207 positive (0.0%)
2025-11-20 18:16:22 - data_layer - INFO -   Rating 4: 9,147/9,147 positive (100.0%)
2025-11-20 18:16:22 - data_layer - INFO -   Rating 5: 353,166/353,166 positive (100.0%)
2025-11-20 18:16:22 - data_layer - INFO - ✓ Positive labels created
2025-11-20 18:16:22 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:22 - data_layer - INFO - STEP 2.2: HARD NEGATIVE MINING
2025-11-20 18:16:22 - data_layer - INFO - ================================================================================
2025-11-20 18:16:22 - data_layer - INFO - Dual strategy: Explicit (low ratings) + Implicit (popular items not bought)
2025-11-20 18:16:22 - data_layer - INFO - 
Strategy 1: Explicit hard negatives (rating <= 3.0)
2025-11-20 18:16:22 - data_layer - INFO -   Found 6,786 explicit hard negatives
2025-11-20 18:16:22 - data_layer - INFO - 
Strategy 2: Implicit hard negatives (Top-50 popular items)
2025-11-20 18:16:22 - data_layer - WARNING - ⚠ Products DataFrame not provided - skipping implicit negatives
2025-11-20 18:16:22 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:16:22 - data_layer - INFO - HARD NEGATIVE MINING SUMMARY
2025-11-20 18:16:22 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:22 - data_layer - INFO - Total hard negatives:      6,786 (1.84%)
2025-11-20 18:16:22 - data_layer - INFO -   - Explicit (low rating): 6,786
2025-11-20 18:16:22 - data_layer - INFO - Users with hard negatives: 6,694
2025-11-20 18:16:22 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:16:22 - data_layer - INFO - ✓ Hard negative mining completed
2025-11-20 18:16:22 - data_layer - INFO - 
Validating BPR labels...
2025-11-20 18:16:22 - data_layer - INFO - ✓ BPR labels validation passed
2025-11-20 18:16:22 - data_layer - INFO - 
================================================================================
2025-11-20 18:16:22 - data_layer - INFO - STEP 2.3: USER FILTERING & SEGMENTATION
2025-11-20 18:16:22 - data_layer - INFO - ================================================================================
2025-11-20 18:16:22 - data_layer - INFO - Segmenting users: Trainable (≥2 interactions, ≥1 positive) vs Cold-start
2025-11-20 18:16:22 - data_layer - INFO - Configuration:
2025-11-20 18:16:22 - data_layer - INFO -   - Min user interactions: 2
2025-11-20 18:16:22 - data_layer - INFO -   - Min user positives: 1
2025-11-20 18:16:22 - data_layer - INFO -   - Positive threshold: rating ≥ 4.0
2025-11-20 18:17:19 - data_layer - INFO - 
User interaction statistics:
2025-11-20 18:17:19 - data_layer - INFO -   Total unique users: 304,708
2025-11-20 18:17:19 - data_layer - INFO -   Mean interactions per user: 1.21
2025-11-20 18:17:19 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 18:17:19 - data_layer - INFO -   Max interactions per user: 20
2025-11-20 18:17:19 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:17:19 - data_layer - INFO - TRAINABLE USER CRITERIA
2025-11-20 18:17:19 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:17:19 - data_layer - INFO - Trainable users: 46,319 (15.20%)
2025-11-20 18:17:19 - data_layer - INFO -   Criteria: ≥2 interactions AND ≥1 positive
2025-11-20 18:17:19 - data_layer - INFO - Cold-start users: 258,389 (84.80%)
2025-11-20 18:17:19 - data_layer - INFO -   Criteria: <2 interactions OR no positives
2025-11-20 18:17:19 - data_layer - INFO - 
Special cases (forced to cold-start): 54
2025-11-20 18:17:19 - data_layer - INFO -   Users with exactly 2 interactions, both negative (rating < 4.0)
2025-11-20 18:17:20 - data_layer - INFO - 
Trainable user details:
2025-11-20 18:17:20 - data_layer - INFO -   Interactions from trainable users: 110,643
2025-11-20 18:17:20 - data_layer - INFO -   Average interactions per trainable user: 2.39
2025-11-20 18:17:20 - data_layer - INFO -   Positive rate among trainable users: 99.04%
2025-11-20 18:17:20 - data_layer - INFO - 
Estimated CF matrix density:
2025-11-20 18:17:20 - data_layer - INFO -   Trainable users: 46,319
2025-11-20 18:17:20 - data_layer - INFO -   Total items: 2,231
2025-11-20 18:17:20 - data_layer - INFO -   Interactions: 110,643
2025-11-20 18:17:20 - data_layer - INFO -   Density: 0.1071%
2025-11-20 18:17:20 - data_layer - INFO - 
================================================================================
2025-11-20 18:17:20 - data_layer - INFO - ✓ User segmentation completed
2025-11-20 18:17:20 - data_layer - INFO - 
################################################################################
2025-11-20 18:17:20 - data_layer - INFO - # STEP 2.3: COMPLETE USER & ITEM FILTERING PIPELINE
2025-11-20 18:17:20 - data_layer - INFO - ################################################################################
2025-11-20 18:17:20 - data_layer - INFO - 
================================================================================
2025-11-20 18:17:20 - data_layer - INFO - STEP 2.3: USER FILTERING & SEGMENTATION
2025-11-20 18:17:20 - data_layer - INFO - ================================================================================
2025-11-20 18:17:20 - data_layer - INFO - Segmenting users: Trainable (≥2 interactions, ≥1 positive) vs Cold-start
2025-11-20 18:17:20 - data_layer - INFO - Configuration:
2025-11-20 18:17:20 - data_layer - INFO -   - Min user interactions: 2
2025-11-20 18:17:20 - data_layer - INFO -   - Min user positives: 1
2025-11-20 18:17:20 - data_layer - INFO -   - Positive threshold: rating ≥ 4.0
2025-11-20 18:18:15 - data_layer - INFO - 
User interaction statistics:
2025-11-20 18:18:15 - data_layer - INFO -   Total unique users: 304,708
2025-11-20 18:18:15 - data_layer - INFO -   Mean interactions per user: 1.21
2025-11-20 18:18:15 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 18:18:15 - data_layer - INFO -   Max interactions per user: 20
2025-11-20 18:18:15 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:18:15 - data_layer - INFO - TRAINABLE USER CRITERIA
2025-11-20 18:18:15 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:18:15 - data_layer - INFO - Trainable users: 46,319 (15.20%)
2025-11-20 18:18:15 - data_layer - INFO -   Criteria: ≥2 interactions AND ≥1 positive
2025-11-20 18:18:15 - data_layer - INFO - Cold-start users: 258,389 (84.80%)
2025-11-20 18:18:15 - data_layer - INFO -   Criteria: <2 interactions OR no positives
2025-11-20 18:18:15 - data_layer - INFO - 
Special cases (forced to cold-start): 54
2025-11-20 18:18:15 - data_layer - INFO -   Users with exactly 2 interactions, both negative (rating < 4.0)
2025-11-20 18:18:18 - data_layer - INFO - ================================================================================
2025-11-20 18:18:18 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 18:18:18 - data_layer - INFO - ================================================================================
2025-11-20 18:18:18 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 18:18:18 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 18:18:18 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 18:18:18 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 18:18:18 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:18:18 - data_layer - INFO - Loading interactions data...
2025-11-20 18:18:20 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 18:18:20 - data_layer - INFO - 
Loading products data...
2025-11-20 18:18:21 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 18:18:21 - data_layer - INFO - 
Loading attributes data...
2025-11-20 18:18:21 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 18:18:21 - data_layer - INFO - 
Loading shops data...
2025-11-20 18:18:21 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 18:18:21 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:18:21 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 18:18:21 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:18:21 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 18:18:21 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 18:18:21 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 18:18:21 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 18:18:21 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 18:18:21 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 18:18:21 - data_layer - INFO - 
================================================================================
2025-11-20 18:18:21 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 18:18:21 - data_layer - INFO - ================================================================================

2025-11-20 18:18:21 - data_layer - INFO - 
================================================================================
2025-11-20 18:18:21 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 18:18:21 - data_layer - INFO - ================================================================================
2025-11-20 18:18:21 - data_layer - INFO - Initial row count: 369,099
2025-11-20 18:18:21 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:18:21 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 18:18:21 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:18:21 - data_layer - INFO - Converting user_id to integer...
2025-11-20 18:18:21 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 18:18:21 - data_layer - INFO - Converting product_id to integer...
2025-11-20 18:18:21 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 18:18:21 - data_layer - INFO - Converting rating to float...
2025-11-20 18:18:21 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 18:18:21 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 18:18:21 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 18:18:21 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 18:18:21 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:18:21 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 18:18:21 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:18:21 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 18:18:21 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 18:18:21 - data_layer - INFO - ✓ No missing rating values
2025-11-20 18:18:21 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 18:18:21 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:18:21 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 18:18:21 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:18:21 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 18:18:21 - data_layer - INFO - Rating statistics before validation:
2025-11-20 18:18:21 - data_layer - INFO -   Min: 1.00
2025-11-20 18:18:21 - data_layer - INFO -   Max: 5.00
2025-11-20 18:18:21 - data_layer - INFO -   Mean: 4.92
2025-11-20 18:18:21 - data_layer - INFO -   Median: 5.00
2025-11-20 18:18:21 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 18:18:21 - data_layer - INFO - 
================================================================================
2025-11-20 18:18:21 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 18:18:21 - data_layer - INFO - ================================================================================
2025-11-20 18:18:21 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 18:18:21 - data_layer - INFO - Missing user_id:                      0
2025-11-20 18:18:21 - data_layer - INFO - Missing product_id:                   0
2025-11-20 18:18:21 - data_layer - INFO - Missing rating:                       0
2025-11-20 18:18:21 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 18:18:21 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 18:18:21 - data_layer - INFO - Type conversion errors:               0
2025-11-20 18:18:21 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:18:21 - data_layer - INFO - Total dropped:                        0
2025-11-20 18:18:21 - data_layer - INFO - Final rows:                     369,099
2025-11-20 18:18:21 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 18:18:21 - data_layer - INFO - ================================================================================

2025-11-20 18:18:21 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 18:18:21 - data_layer - INFO - 
================================================================================
2025-11-20 18:18:21 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 18:18:21 - data_layer - INFO - ================================================================================
2025-11-20 18:18:21 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 18:18:21 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 18:18:21 - data_layer - INFO - Processing 369,099 interactions
2025-11-20 18:18:21 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 18:18:21 - data_layer - INFO - Quality scoring criteria:
2025-11-20 18:18:21 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 18:18:21 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 18:18:21 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 18:18:26 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 18:18:27 - data_layer - INFO - 
================================================================================
2025-11-20 18:18:27 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 18:18:27 - data_layer - INFO - ================================================================================
2025-11-20 18:18:27 - data_layer - INFO - Total interactions:             369,099
2025-11-20 18:18:27 - data_layer - INFO - Rows with comments:             359,418 (97.38%)
2025-11-20 18:18:27 - data_layer - INFO - Rows without comments:            9,681 (2.62%)
2025-11-20 18:18:27 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 18:18:27 - data_layer - INFO -   Min:    0.000
2025-11-20 18:18:27 - data_layer - INFO -   Mean:   0.223
2025-11-20 18:18:27 - data_layer - INFO -   Median: 0.200
2025-11-20 18:18:27 - data_layer - INFO -   Max:    0.500
2025-11-20 18:18:27 - data_layer - INFO -   Std:    0.100
2025-11-20 18:18:27 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 18:18:27 - data_layer - INFO -   Min:    1.000
2025-11-20 18:18:27 - data_layer - INFO -   Mean:   5.146
2025-11-20 18:18:27 - data_layer - INFO -   Median: 5.200
2025-11-20 18:18:27 - data_layer - INFO -   Max:    5.500
2025-11-20 18:18:27 - data_layer - INFO -   Std:    0.443
2025-11-20 18:18:27 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 18:18:27 - data_layer - INFO -   Zero quality (0.0):              27,957 (7.57%)
2025-11-20 18:18:27 - data_layer - INFO -   Low quality (0.0-0.2):          212,076 (57.46%)
2025-11-20 18:18:27 - data_layer - INFO -   Medium quality (0.2-0.5):       129,066 (34.97%)
2025-11-20 18:18:27 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 18:18:27 - data_layer - INFO - ================================================================================

2025-11-20 18:18:27 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 18:18:27 - data_layer - INFO - 
================================================================================
2025-11-20 18:18:27 - data_layer - INFO - STEP 2.2: BPR POSITIVE LABELS
2025-11-20 18:18:27 - data_layer - INFO - ================================================================================
2025-11-20 18:18:27 - data_layer - INFO - Positive threshold: rating >= 4.0
2025-11-20 18:18:27 - data_layer - INFO - 
Positive interactions:  362,313 (98.16%)
2025-11-20 18:18:27 - data_layer - INFO - Negative interactions:  6,786 (1.84%)
2025-11-20 18:18:27 - data_layer - INFO - 
Positive label distribution by rating:
2025-11-20 18:18:27 - data_layer - INFO -   Rating 1: 0/2,271 positive (0.0%)
2025-11-20 18:18:27 - data_layer - INFO -   Rating 2: 0/1,308 positive (0.0%)
2025-11-20 18:18:27 - data_layer - INFO -   Rating 3: 0/3,207 positive (0.0%)
2025-11-20 18:18:27 - data_layer - INFO -   Rating 4: 9,147/9,147 positive (100.0%)
2025-11-20 18:18:27 - data_layer - INFO -   Rating 5: 353,166/353,166 positive (100.0%)
2025-11-20 18:18:27 - data_layer - INFO - ✓ Positive labels created
2025-11-20 18:18:27 - data_layer - INFO - 
================================================================================
2025-11-20 18:18:27 - data_layer - INFO - STEP 2.2: HARD NEGATIVE MINING
2025-11-20 18:18:27 - data_layer - INFO - ================================================================================
2025-11-20 18:18:27 - data_layer - INFO - Dual strategy: Explicit (low ratings) + Implicit (popular items not bought)
2025-11-20 18:18:27 - data_layer - INFO - 
Strategy 1: Explicit hard negatives (rating <= 3.0)
2025-11-20 18:18:27 - data_layer - INFO -   Found 6,786 explicit hard negatives
2025-11-20 18:18:27 - data_layer - INFO - 
Strategy 2: Implicit hard negatives (Top-50 popular items)
2025-11-20 18:18:27 - data_layer - WARNING - ⚠ Products DataFrame not provided - skipping implicit negatives
2025-11-20 18:18:27 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:18:27 - data_layer - INFO - HARD NEGATIVE MINING SUMMARY
2025-11-20 18:18:27 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:18:27 - data_layer - INFO - Total hard negatives:      6,786 (1.84%)
2025-11-20 18:18:27 - data_layer - INFO -   - Explicit (low rating): 6,786
2025-11-20 18:18:27 - data_layer - INFO - Users with hard negatives: 6,694
2025-11-20 18:18:27 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:18:27 - data_layer - INFO - ✓ Hard negative mining completed
2025-11-20 18:18:27 - data_layer - INFO - 
Validating BPR labels...
2025-11-20 18:18:27 - data_layer - INFO - ✓ BPR labels validation passed
2025-11-20 18:18:27 - data_layer - INFO - 
================================================================================
2025-11-20 18:18:27 - data_layer - INFO - STEP 2.3: USER FILTERING & SEGMENTATION
2025-11-20 18:18:27 - data_layer - INFO - ================================================================================
2025-11-20 18:18:27 - data_layer - INFO - Segmenting users: Trainable (≥2 interactions, ≥1 positive) vs Cold-start
2025-11-20 18:18:27 - data_layer - INFO - Configuration:
2025-11-20 18:18:27 - data_layer - INFO -   - Min user interactions: 2
2025-11-20 18:18:27 - data_layer - INFO -   - Min user positives: 1
2025-11-20 18:18:27 - data_layer - INFO -   - Positive threshold: rating ≥ 4.0
2025-11-20 18:18:46 - data_layer - INFO - 
User interaction statistics:
2025-11-20 18:18:46 - data_layer - INFO -   Total unique users: 304,708
2025-11-20 18:18:46 - data_layer - INFO -   Mean interactions per user: 1.21
2025-11-20 18:18:46 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 18:18:46 - data_layer - INFO -   Max interactions per user: 20
2025-11-20 18:18:46 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:18:46 - data_layer - INFO - TRAINABLE USER CRITERIA
2025-11-20 18:18:46 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:18:46 - data_layer - INFO - Trainable users: 46,319 (15.20%)
2025-11-20 18:18:46 - data_layer - INFO -   Criteria: ≥2 interactions AND ≥1 positive
2025-11-20 18:18:46 - data_layer - INFO - Cold-start users: 258,389 (84.80%)
2025-11-20 18:18:46 - data_layer - INFO -   Criteria: <2 interactions OR no positives
2025-11-20 18:18:46 - data_layer - INFO - 
Special cases (forced to cold-start): 54
2025-11-20 18:18:46 - data_layer - INFO -   Users with exactly 2 interactions, both negative (rating < 4.0)
2025-11-20 18:18:47 - data_layer - INFO - 
Trainable user details:
2025-11-20 18:18:47 - data_layer - INFO -   Interactions from trainable users: 110,643
2025-11-20 18:18:47 - data_layer - INFO -   Average interactions per trainable user: 2.39
2025-11-20 18:18:47 - data_layer - INFO -   Positive rate among trainable users: 99.04%
2025-11-20 18:18:47 - data_layer - INFO - 
Estimated CF matrix density:
2025-11-20 18:18:47 - data_layer - INFO -   Trainable users: 46,319
2025-11-20 18:18:47 - data_layer - INFO -   Total items: 2,231
2025-11-20 18:18:47 - data_layer - INFO -   Interactions: 110,643
2025-11-20 18:18:47 - data_layer - INFO -   Density: 0.1071%
2025-11-20 18:18:47 - data_layer - INFO - 
================================================================================
2025-11-20 18:18:47 - data_layer - INFO - ✓ User segmentation completed
2025-11-20 18:18:47 - data_layer - INFO - 
################################################################################
2025-11-20 18:18:47 - data_layer - INFO - # STEP 2.3: COMPLETE USER & ITEM FILTERING PIPELINE
2025-11-20 18:18:47 - data_layer - INFO - ################################################################################
2025-11-20 18:18:47 - data_layer - INFO - 
================================================================================
2025-11-20 18:18:47 - data_layer - INFO - STEP 2.3: USER FILTERING & SEGMENTATION
2025-11-20 18:18:47 - data_layer - INFO - ================================================================================
2025-11-20 18:18:47 - data_layer - INFO - Segmenting users: Trainable (≥2 interactions, ≥1 positive) vs Cold-start
2025-11-20 18:18:47 - data_layer - INFO - Configuration:
2025-11-20 18:18:47 - data_layer - INFO -   - Min user interactions: 2
2025-11-20 18:18:47 - data_layer - INFO -   - Min user positives: 1
2025-11-20 18:18:47 - data_layer - INFO -   - Positive threshold: rating ≥ 4.0
2025-11-20 18:19:06 - data_layer - INFO - 
User interaction statistics:
2025-11-20 18:19:06 - data_layer - INFO -   Total unique users: 304,708
2025-11-20 18:19:06 - data_layer - INFO -   Mean interactions per user: 1.21
2025-11-20 18:19:06 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 18:19:06 - data_layer - INFO -   Max interactions per user: 20
2025-11-20 18:19:06 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:19:06 - data_layer - INFO - TRAINABLE USER CRITERIA
2025-11-20 18:19:06 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:19:06 - data_layer - INFO - Trainable users: 46,319 (15.20%)
2025-11-20 18:19:06 - data_layer - INFO -   Criteria: ≥2 interactions AND ≥1 positive
2025-11-20 18:19:06 - data_layer - INFO - Cold-start users: 258,389 (84.80%)
2025-11-20 18:19:06 - data_layer - INFO -   Criteria: <2 interactions OR no positives
2025-11-20 18:19:06 - data_layer - INFO - 
Special cases (forced to cold-start): 54
2025-11-20 18:19:06 - data_layer - INFO -   Users with exactly 2 interactions, both negative (rating < 4.0)
2025-11-20 18:19:58 - data_layer - INFO - ================================================================================
2025-11-20 18:19:58 - data_layer - INFO - STARTING DATA LOADING PROCESS
2025-11-20 18:19:58 - data_layer - INFO - ================================================================================
2025-11-20 18:19:58 - data_layer - INFO - Found interactions file: data/published_data\data_reviews_purchase.csv
2025-11-20 18:19:58 - data_layer - INFO - Found products file: data/published_data\data_product.csv
2025-11-20 18:19:58 - data_layer - INFO - Found attributes file: data/published_data\data_product_attribute.csv
2025-11-20 18:19:58 - data_layer - INFO - Found shops file: data/published_data\data_shop.csv
2025-11-20 18:19:58 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:19:58 - data_layer - INFO - Loading interactions data...
2025-11-20 18:20:00 - data_layer - INFO - ✓ Loaded 369099 interaction records
2025-11-20 18:20:00 - data_layer - INFO - 
Loading products data...
2025-11-20 18:20:00 - data_layer - INFO - ✓ Loaded 2244 product records
2025-11-20 18:20:00 - data_layer - INFO - 
Loading attributes data...
2025-11-20 18:20:00 - data_layer - INFO - ✓ Loaded 2244 attribute records
2025-11-20 18:20:00 - data_layer - INFO - 
Loading shops data...
2025-11-20 18:20:00 - data_layer - INFO - ✓ Loaded 1291 shop records
2025-11-20 18:20:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:20:00 - data_layer - INFO - VALIDATING DATA SCHEMA
2025-11-20 18:20:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:00 - data_layer - INFO - ✓ interactions: All required columns present
2025-11-20 18:20:00 - data_layer - INFO -   Columns: ['Unnamed: 0', 'user_id', 'product_id', 'rating', 'product_name_x', 'cmt_date', 'shop_id', 'variation_x', 'product_quality', 'processed_comment']
2025-11-20 18:20:00 - data_layer - INFO - ✓ products: All required columns present
2025-11-20 18:20:00 - data_layer - INFO -   Columns: ['avg_star', 'num_sold_time', 'price', 'variation', 'product_id', 'shop_id', 'product_name', 'brand', 'storage', 'origin']...
2025-11-20 18:20:00 - data_layer - INFO - ✓ attributes: All required columns present
2025-11-20 18:20:00 - data_layer - INFO -   Columns: ['product_id', 'shop_id', 'product_name', 'ingredient', 'feature', 'skin_type', 'capacity', 'design', 'brand', 'expiry']...
2025-11-20 18:20:00 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:00 - data_layer - INFO - DATA LOADING COMPLETED SUCCESSFULLY
2025-11-20 18:20:00 - data_layer - INFO - ================================================================================

2025-11-20 18:20:00 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:00 - data_layer - INFO - STEP 1.1: DATA VALIDATION & CLEANING
2025-11-20 18:20:00 - data_layer - INFO - ================================================================================
2025-11-20 18:20:00 - data_layer - INFO - Initial row count: 369,099
2025-11-20 18:20:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:20:00 - data_layer - INFO - 1. TYPE ENFORCEMENT
2025-11-20 18:20:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:00 - data_layer - INFO - Converting user_id to integer...
2025-11-20 18:20:00 - data_layer - INFO - ✓ All user_id values are valid integers
2025-11-20 18:20:00 - data_layer - INFO - Converting product_id to integer...
2025-11-20 18:20:00 - data_layer - INFO - ✓ All product_id values are valid integers
2025-11-20 18:20:00 - data_layer - INFO - Converting rating to float...
2025-11-20 18:20:00 - data_layer - INFO - ✓ All rating values are valid floats
2025-11-20 18:20:00 - data_layer - INFO - Parsing cmt_date to datetime...
2025-11-20 18:20:00 - data_layer - INFO - ✓ Parsed 369,099 dates using format: %Y-%m-%d %H:%M:%S
2025-11-20 18:20:00 - data_layer - INFO - ✓ Successfully parsed dates using: %Y-%m-%d %H:%M:%S
2025-11-20 18:20:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:20:00 - data_layer - INFO - 2. MISSING VALUES HANDLING
2025-11-20 18:20:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:00 - data_layer - INFO - ✓ No missing user_id values
2025-11-20 18:20:00 - data_layer - INFO - ✓ No missing product_id values
2025-11-20 18:20:00 - data_layer - INFO - ✓ No missing rating values
2025-11-20 18:20:00 - data_layer - INFO - ✓ No missing timestamp values (temporal validation passed)
2025-11-20 18:20:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:20:00 - data_layer - INFO - 3. RATING RANGE VALIDATION
2025-11-20 18:20:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:00 - data_layer - INFO - Valid rating range: [1.0, 5.0]
2025-11-20 18:20:00 - data_layer - INFO - Rating statistics before validation:
2025-11-20 18:20:00 - data_layer - INFO -   Min: 1.00
2025-11-20 18:20:00 - data_layer - INFO -   Max: 5.00
2025-11-20 18:20:00 - data_layer - INFO -   Mean: 4.92
2025-11-20 18:20:00 - data_layer - INFO -   Median: 5.00
2025-11-20 18:20:00 - data_layer - INFO - ✓ All ratings within valid range [1.0, 5.0]
2025-11-20 18:20:00 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:00 - data_layer - INFO - CLEANING SUMMARY
2025-11-20 18:20:00 - data_layer - INFO - ================================================================================
2025-11-20 18:20:00 - data_layer - INFO - Initial rows:                   369,099
2025-11-20 18:20:00 - data_layer - INFO - Missing user_id:                      0
2025-11-20 18:20:00 - data_layer - INFO - Missing product_id:                   0
2025-11-20 18:20:00 - data_layer - INFO - Missing rating:                       0
2025-11-20 18:20:00 - data_layer - INFO - Missing timestamp:                    0
2025-11-20 18:20:00 - data_layer - INFO - Invalid rating range:                 0
2025-11-20 18:20:00 - data_layer - INFO - Type conversion errors:               0
2025-11-20 18:20:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:00 - data_layer - INFO - Total dropped:                        0
2025-11-20 18:20:00 - data_layer - INFO - Final rows:                     369,099
2025-11-20 18:20:00 - data_layer - INFO - Retention rate:                 100.00%
2025-11-20 18:20:00 - data_layer - INFO - ================================================================================

2025-11-20 18:20:00 - data_layer - INFO - ✓ All validation checks passed
2025-11-20 18:20:00 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:00 - data_layer - INFO - STEP 2.0: COMMENT QUALITY ANALYSIS
2025-11-20 18:20:00 - data_layer - INFO - ================================================================================
2025-11-20 18:20:00 - data_layer - INFO - Addressing rating skew problem: 95% 5-star ratings
2025-11-20 18:20:00 - data_layer - INFO - Strategy: Extract quality signals from review comments
2025-11-20 18:20:00 - data_layer - INFO - Processing 369,099 interactions
2025-11-20 18:20:00 - data_layer - INFO - 
Computing comment quality scores from 'processed_comment'...
2025-11-20 18:20:00 - data_layer - INFO - Quality scoring criteria:
2025-11-20 18:20:00 - data_layer - INFO -   - Length bonus: +0.1 (≥5 words), +0.2 (≥10 words)
2025-11-20 18:20:00 - data_layer - INFO -   - Keyword bonus: +0.1 per positive keyword (max +0.3)
2025-11-20 18:20:00 - data_layer - INFO -   - Vocabulary: 22 Vietnamese keywords
2025-11-20 18:20:05 - data_layer - INFO - 
Computing confidence scores = rating + comment_quality...
2025-11-20 18:20:06 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:06 - data_layer - INFO - COMMENT QUALITY SUMMARY
2025-11-20 18:20:06 - data_layer - INFO - ================================================================================
2025-11-20 18:20:06 - data_layer - INFO - Total interactions:             369,099
2025-11-20 18:20:06 - data_layer - INFO - Rows with comments:             359,418 (97.38%)
2025-11-20 18:20:06 - data_layer - INFO - Rows without comments:            9,681 (2.62%)
2025-11-20 18:20:06 - data_layer - INFO - 
Comment Quality Distribution:
2025-11-20 18:20:06 - data_layer - INFO -   Min:    0.000
2025-11-20 18:20:06 - data_layer - INFO -   Mean:   0.223
2025-11-20 18:20:06 - data_layer - INFO -   Median: 0.200
2025-11-20 18:20:06 - data_layer - INFO -   Max:    0.500
2025-11-20 18:20:06 - data_layer - INFO -   Std:    0.100
2025-11-20 18:20:06 - data_layer - INFO - 
Confidence Score Distribution:
2025-11-20 18:20:06 - data_layer - INFO -   Min:    1.000
2025-11-20 18:20:06 - data_layer - INFO -   Mean:   5.146
2025-11-20 18:20:06 - data_layer - INFO -   Median: 5.200
2025-11-20 18:20:06 - data_layer - INFO -   Max:    5.500
2025-11-20 18:20:06 - data_layer - INFO -   Std:    0.443
2025-11-20 18:20:06 - data_layer - INFO - 
Quality Score Breakdown:
2025-11-20 18:20:06 - data_layer - INFO -   Zero quality (0.0):              27,957 (7.57%)
2025-11-20 18:20:06 - data_layer - INFO -   Low quality (0.0-0.2):          212,076 (57.46%)
2025-11-20 18:20:06 - data_layer - INFO -   Medium quality (0.2-0.5):       129,066 (34.97%)
2025-11-20 18:20:06 - data_layer - INFO -   High quality (0.5-1.0):               0 (0.00%)
2025-11-20 18:20:06 - data_layer - INFO - ================================================================================

2025-11-20 18:20:06 - data_layer - INFO - ✓ All quality and confidence scores validated
2025-11-20 18:20:06 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:06 - data_layer - INFO - STEP 2.2: BPR POSITIVE LABELS
2025-11-20 18:20:06 - data_layer - INFO - ================================================================================
2025-11-20 18:20:06 - data_layer - INFO - Positive threshold: rating >= 4.0
2025-11-20 18:20:06 - data_layer - INFO - 
Positive interactions:  362,313 (98.16%)
2025-11-20 18:20:06 - data_layer - INFO - Negative interactions:  6,786 (1.84%)
2025-11-20 18:20:06 - data_layer - INFO - 
Positive label distribution by rating:
2025-11-20 18:20:06 - data_layer - INFO -   Rating 1: 0/2,271 positive (0.0%)
2025-11-20 18:20:06 - data_layer - INFO -   Rating 2: 0/1,308 positive (0.0%)
2025-11-20 18:20:06 - data_layer - INFO -   Rating 3: 0/3,207 positive (0.0%)
2025-11-20 18:20:06 - data_layer - INFO -   Rating 4: 9,147/9,147 positive (100.0%)
2025-11-20 18:20:06 - data_layer - INFO -   Rating 5: 353,166/353,166 positive (100.0%)
2025-11-20 18:20:06 - data_layer - INFO - ✓ Positive labels created
2025-11-20 18:20:06 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:06 - data_layer - INFO - STEP 2.2: HARD NEGATIVE MINING
2025-11-20 18:20:06 - data_layer - INFO - ================================================================================
2025-11-20 18:20:06 - data_layer - INFO - Dual strategy: Explicit (low ratings) + Implicit (popular items not bought)
2025-11-20 18:20:06 - data_layer - INFO - 
Strategy 1: Explicit hard negatives (rating <= 3.0)
2025-11-20 18:20:06 - data_layer - INFO -   Found 6,786 explicit hard negatives
2025-11-20 18:20:06 - data_layer - INFO - 
Strategy 2: Implicit hard negatives (Top-50 popular items)
2025-11-20 18:20:06 - data_layer - WARNING - ⚠ Products DataFrame not provided - skipping implicit negatives
2025-11-20 18:20:06 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:20:06 - data_layer - INFO - HARD NEGATIVE MINING SUMMARY
2025-11-20 18:20:06 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:06 - data_layer - INFO - Total hard negatives:      6,786 (1.84%)
2025-11-20 18:20:06 - data_layer - INFO -   - Explicit (low rating): 6,786
2025-11-20 18:20:06 - data_layer - INFO - Users with hard negatives: 6,694
2025-11-20 18:20:06 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:06 - data_layer - INFO - ✓ Hard negative mining completed
2025-11-20 18:20:06 - data_layer - INFO - 
Validating BPR labels...
2025-11-20 18:20:06 - data_layer - INFO - ✓ BPR labels validation passed
2025-11-20 18:20:06 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:06 - data_layer - INFO - STEP 2.3: USER FILTERING & SEGMENTATION
2025-11-20 18:20:06 - data_layer - INFO - ================================================================================
2025-11-20 18:20:06 - data_layer - INFO - Segmenting users: Trainable (≥2 interactions, ≥1 positive) vs Cold-start
2025-11-20 18:20:06 - data_layer - INFO - Configuration:
2025-11-20 18:20:06 - data_layer - INFO -   - Min user interactions: 2
2025-11-20 18:20:06 - data_layer - INFO -   - Min user positives: 1
2025-11-20 18:20:06 - data_layer - INFO -   - Positive threshold: rating ≥ 4.0
2025-11-20 18:20:31 - data_layer - INFO - 
User interaction statistics:
2025-11-20 18:20:31 - data_layer - INFO -   Total unique users: 304,708
2025-11-20 18:20:31 - data_layer - INFO -   Mean interactions per user: 1.21
2025-11-20 18:20:31 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 18:20:31 - data_layer - INFO -   Max interactions per user: 20
2025-11-20 18:20:31 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:20:31 - data_layer - INFO - TRAINABLE USER CRITERIA
2025-11-20 18:20:31 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:31 - data_layer - INFO - Trainable users: 46,319 (15.20%)
2025-11-20 18:20:31 - data_layer - INFO -   Criteria: ≥2 interactions AND ≥1 positive
2025-11-20 18:20:31 - data_layer - INFO - Cold-start users: 258,389 (84.80%)
2025-11-20 18:20:31 - data_layer - INFO -   Criteria: <2 interactions OR no positives
2025-11-20 18:20:31 - data_layer - INFO - 
Special cases (forced to cold-start): 54
2025-11-20 18:20:31 - data_layer - INFO -   Users with exactly 2 interactions, both negative (rating < 4.0)
2025-11-20 18:20:31 - data_layer - INFO - 
Trainable user details:
2025-11-20 18:20:31 - data_layer - INFO -   Interactions from trainable users: 110,643
2025-11-20 18:20:31 - data_layer - INFO -   Average interactions per trainable user: 2.39
2025-11-20 18:20:31 - data_layer - INFO -   Positive rate among trainable users: 99.04%
2025-11-20 18:20:31 - data_layer - INFO - 
Estimated CF matrix density:
2025-11-20 18:20:31 - data_layer - INFO -   Trainable users: 46,319
2025-11-20 18:20:31 - data_layer - INFO -   Total items: 2,231
2025-11-20 18:20:31 - data_layer - INFO -   Interactions: 110,643
2025-11-20 18:20:31 - data_layer - INFO -   Density: 0.1071%
2025-11-20 18:20:31 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:31 - data_layer - INFO - ✓ User segmentation completed
2025-11-20 18:20:32 - data_layer - INFO - 
################################################################################
2025-11-20 18:20:32 - data_layer - INFO - # STEP 2.3: COMPLETE USER & ITEM FILTERING PIPELINE
2025-11-20 18:20:32 - data_layer - INFO - ################################################################################
2025-11-20 18:20:32 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:32 - data_layer - INFO - STEP 2.3: USER FILTERING & SEGMENTATION
2025-11-20 18:20:32 - data_layer - INFO - ================================================================================
2025-11-20 18:20:32 - data_layer - INFO - Segmenting users: Trainable (≥2 interactions, ≥1 positive) vs Cold-start
2025-11-20 18:20:32 - data_layer - INFO - Configuration:
2025-11-20 18:20:32 - data_layer - INFO -   - Min user interactions: 2
2025-11-20 18:20:32 - data_layer - INFO -   - Min user positives: 1
2025-11-20 18:20:32 - data_layer - INFO -   - Positive threshold: rating ≥ 4.0
2025-11-20 18:20:46 - data_layer - INFO - 
User interaction statistics:
2025-11-20 18:20:46 - data_layer - INFO -   Total unique users: 304,708
2025-11-20 18:20:46 - data_layer - INFO -   Mean interactions per user: 1.21
2025-11-20 18:20:46 - data_layer - INFO -   Median interactions per user: 1.0
2025-11-20 18:20:46 - data_layer - INFO -   Max interactions per user: 20
2025-11-20 18:20:46 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:20:46 - data_layer - INFO - TRAINABLE USER CRITERIA
2025-11-20 18:20:46 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:46 - data_layer - INFO - Trainable users: 46,319 (15.20%)
2025-11-20 18:20:46 - data_layer - INFO -   Criteria: ≥2 interactions AND ≥1 positive
2025-11-20 18:20:46 - data_layer - INFO - Cold-start users: 258,389 (84.80%)
2025-11-20 18:20:46 - data_layer - INFO -   Criteria: <2 interactions OR no positives
2025-11-20 18:20:46 - data_layer - INFO - 
Special cases (forced to cold-start): 54
2025-11-20 18:20:46 - data_layer - INFO -   Users with exactly 2 interactions, both negative (rating < 4.0)
2025-11-20 18:20:46 - data_layer - INFO - 
Trainable user details:
2025-11-20 18:20:46 - data_layer - INFO -   Interactions from trainable users: 110,643
2025-11-20 18:20:46 - data_layer - INFO -   Average interactions per trainable user: 2.39
2025-11-20 18:20:46 - data_layer - INFO -   Positive rate among trainable users: 99.04%
2025-11-20 18:20:46 - data_layer - INFO - 
Estimated CF matrix density:
2025-11-20 18:20:46 - data_layer - INFO -   Trainable users: 46,319
2025-11-20 18:20:46 - data_layer - INFO -   Total items: 2,231
2025-11-20 18:20:46 - data_layer - INFO -   Interactions: 110,643
2025-11-20 18:20:46 - data_layer - INFO -   Density: 0.1071%
2025-11-20 18:20:46 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:46 - data_layer - INFO - ✓ User segmentation completed
2025-11-20 18:20:46 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:46 - data_layer - INFO - ITERATIVE ITEM FILTERING
2025-11-20 18:20:46 - data_layer - INFO - ================================================================================
2025-11-20 18:20:46 - data_layer - INFO - Removing items with < 5 positive interactions from trainable users
2025-11-20 18:20:46 - data_layer - INFO - Iteration 1:
2025-11-20 18:20:46 - data_layer - INFO -   Removed 637 cold items (< 5 positives)
2025-11-20 18:20:46 - data_layer - INFO -   Items: 2,231 → 1,594
2025-11-20 18:20:46 - data_layer - INFO -   Interactions: 369,099 → 362,264
2025-11-20 18:20:46 - data_layer - INFO - Iteration 2: Converged (no more items to remove)
2025-11-20 18:20:46 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:20:46 - data_layer - INFO - ITEM FILTERING SUMMARY
2025-11-20 18:20:46 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:46 - data_layer - INFO - Initial items:       2,231
2025-11-20 18:20:46 - data_layer - INFO - Final items:         1,594
2025-11-20 18:20:46 - data_layer - INFO - Items removed:       637
2025-11-20 18:20:46 - data_layer - INFO - Initial interactions: 369,099
2025-11-20 18:20:46 - data_layer - INFO - Final interactions:   362,264
2025-11-20 18:20:46 - data_layer - INFO - Retention rate:       98.15%
2025-11-20 18:20:46 - data_layer - INFO - Iterations:           2
2025-11-20 18:20:46 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:20:46 - data_layer - INFO - ✓ Item filtering completed
2025-11-20 18:20:46 - data_layer - INFO - 
================================================================================
2025-11-20 18:20:46 - data_layer - INFO - FINAL FILTERING SUMMARY
2025-11-20 18:20:46 - data_layer - INFO - ================================================================================
2025-11-20 18:20:46 - data_layer - INFO - Trainable users:     46,179
2025-11-20 18:20:46 - data_layer - INFO - Cold-start users:    252,900
2025-11-20 18:20:46 - data_layer - INFO - Final items:         1,594
2025-11-20 18:20:46 - data_layer - INFO - Trainable interactions: 109,302
2025-11-20 18:20:46 - data_layer - INFO - Total interactions:  362,264
2025-11-20 18:20:46 - data_layer - INFO - Matrix density:      0.1485%
2025-11-20 18:20:46 - data_layer - INFO - ================================================================================
2025-11-20 18:20:46 - data_layer - INFO - ✓ Complete filtering pipeline finished
2025-11-20 18:31:58 - data_layer - INFO - 
================================================================================
2025-11-20 18:31:58 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:31:58 - data_layer - INFO - ================================================================================
2025-11-20 18:31:58 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:31:58 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:58 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:31:58 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:58 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:31:58 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:31:58 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:31:58 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:31:58 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:31:58 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:31:58 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:58 - data_layer - INFO - USER MAPPING
2025-11-20 18:31:58 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:58 - data_layer - INFO - Created user mappings:
2025-11-20 18:31:58 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:31:58 - data_layer - INFO -   Example mappings:
2025-11-20 18:31:58 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:31:58 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:31:58 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:31:58 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:31:58 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:31:58 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:58 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:31:58 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:58 - data_layer - INFO - Created item mappings:
2025-11-20 18:31:58 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:31:58 - data_layer - INFO -   Example mappings:
2025-11-20 18:31:58 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:31:58 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:31:58 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:31:58 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:31:58 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:31:58 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:58 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:31:58 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:31:59 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:31:59 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:31:59 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:31:59 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:31:59 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:31:59 - data_layer - INFO - 
================================================================================
2025-11-20 18:31:59 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:31:59 - data_layer - INFO - 
================================================================================
2025-11-20 18:31:59 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:31:59 - data_layer - INFO - ================================================================================
2025-11-20 18:31:59 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:31:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:31:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:31:59 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:31:59 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:31:59 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:31:59 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:31:59 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:31:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - USER MAPPING
2025-11-20 18:31:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - Created user mappings:
2025-11-20 18:31:59 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:31:59 - data_layer - INFO -   Example mappings:
2025-11-20 18:31:59 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:31:59 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:31:59 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:31:59 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:31:59 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:31:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:31:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - Created item mappings:
2025-11-20 18:31:59 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:31:59 - data_layer - INFO -   Example mappings:
2025-11-20 18:31:59 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:31:59 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:31:59 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:31:59 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:31:59 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:31:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:31:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:31:59 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:31:59 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:31:59 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:31:59 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:31:59 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:31:59 - data_layer - INFO - 
================================================================================
2025-11-20 18:31:59 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:31:59 - data_layer - INFO - 
================================================================================
2025-11-20 18:31:59 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:31:59 - data_layer - INFO - ================================================================================
2025-11-20 18:31:59 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:31:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:31:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:31:59 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:31:59 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:31:59 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:31:59 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:31:59 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:31:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - USER MAPPING
2025-11-20 18:31:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - Created user mappings:
2025-11-20 18:31:59 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:31:59 - data_layer - INFO -   Example mappings:
2025-11-20 18:31:59 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:31:59 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:31:59 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:31:59 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:31:59 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:31:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:31:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - Created item mappings:
2025-11-20 18:31:59 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:31:59 - data_layer - INFO -   Example mappings:
2025-11-20 18:31:59 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:31:59 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:31:59 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:31:59 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:31:59 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:31:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:31:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:31:59 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:31:59 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:31:59 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:31:59 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:31:59 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:31:59 - data_layer - INFO - 
================================================================================
2025-11-20 18:31:59 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:31:59 - data_layer - INFO - 
================================================================================
2025-11-20 18:31:59 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:31:59 - data_layer - INFO - ================================================================================
2025-11-20 18:31:59 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:31:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:31:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:31:59 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:31:59 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:31:59 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:31:59 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:31:59 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:31:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - USER MAPPING
2025-11-20 18:31:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:31:59 - data_layer - INFO - Created user mappings:
2025-11-20 18:31:59 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:31:59 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:00 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:32:00 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:32:00 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:32:00 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:32:00 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:32:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:32:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - Created item mappings:
2025-11-20 18:32:00 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:32:00 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:00 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:32:00 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:32:00 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:32:00 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:32:00 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:32:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:32:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:32:00 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:32:00 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:00 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:32:00 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:32:00 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:00 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:00 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:32:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:32:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - Applied mappings to 369,099 interactions
2025-11-20 18:32:00 - data_layer - INFO -   Added u_idx column: user_id → contiguous [0, 304707]
2025-11-20 18:32:00 - data_layer - INFO -   Added i_idx column: product_id → contiguous [0, 2230]
2025-11-20 18:32:00 - data_layer - INFO - ✓ No missing mappings detected
2025-11-20 18:32:00 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:00 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:32:00 - data_layer - INFO - ================================================================================
2025-11-20 18:32:00 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:32:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:32:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:32:00 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:32:00 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:32:00 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:32:00 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:32:00 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:32:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - USER MAPPING
2025-11-20 18:32:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - Created user mappings:
2025-11-20 18:32:00 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:32:00 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:00 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:32:00 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:32:00 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:32:00 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:32:00 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:32:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:32:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - Created item mappings:
2025-11-20 18:32:00 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:32:00 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:00 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:32:00 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:32:00 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:32:00 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:32:00 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:32:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:32:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:32:00 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:32:00 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:00 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:32:00 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:32:00 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:00 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:00 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:32:00 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:00 - data_layer - INFO - SAVING MAPPINGS TO JSON
2025-11-20 18:32:00 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:04 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:04 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:32:04 - data_layer - INFO - ================================================================================
2025-11-20 18:32:04 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:32:04 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:04 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:32:04 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:04 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:32:04 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:32:04 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:32:04 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:32:04 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:32:04 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:32:04 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:04 - data_layer - INFO - USER MAPPING
2025-11-20 18:32:04 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:04 - data_layer - INFO - Created user mappings:
2025-11-20 18:32:04 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:32:04 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:04 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:32:04 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:32:04 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:32:04 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:32:04 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:32:04 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:04 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:32:04 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:04 - data_layer - INFO - Created item mappings:
2025-11-20 18:32:04 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:32:04 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:04 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:32:04 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:32:04 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:32:04 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:32:04 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:32:04 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:04 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:32:04 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:04 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:32:04 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:32:04 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:04 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:32:04 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:32:04 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:04 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:04 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:32:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:13 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:32:13 - data_layer - INFO - ================================================================================
2025-11-20 18:32:13 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:32:13 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:32:13 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:32:13 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:32:13 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:32:13 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - USER MAPPING
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - Created user mappings:
2025-11-20 18:32:13 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:32:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:13 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:32:13 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:32:13 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:32:13 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:32:13 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - Created item mappings:
2025-11-20 18:32:13 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:32:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:13 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:32:13 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:32:13 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:32:13 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:32:13 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:32:13 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:32:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:13 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:32:13 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:32:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:13 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:32:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:13 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:32:13 - data_layer - INFO - ================================================================================
2025-11-20 18:32:13 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:32:13 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:32:13 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:32:13 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:32:13 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:32:13 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - USER MAPPING
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - Created user mappings:
2025-11-20 18:32:13 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:32:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:13 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:32:13 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:32:13 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:32:13 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:32:13 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - Created item mappings:
2025-11-20 18:32:13 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:32:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:13 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:32:13 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:32:13 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:32:13 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:32:13 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:32:13 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:32:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:13 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:32:13 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:32:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:13 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - Applied mappings to 369,099 interactions
2025-11-20 18:32:13 - data_layer - INFO -   Added u_idx column: user_id → contiguous [0, 304707]
2025-11-20 18:32:13 - data_layer - INFO -   Added i_idx column: product_id → contiguous [0, 2230]
2025-11-20 18:32:13 - data_layer - INFO - ✓ No missing mappings detected
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:13 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:32:13 - data_layer - INFO - ================================================================================
2025-11-20 18:32:13 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:32:13 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:32:13 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:32:13 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:32:13 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:32:13 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - USER MAPPING
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - Created user mappings:
2025-11-20 18:32:13 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:32:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:13 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:32:13 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:32:13 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:32:13 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:32:13 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - Created item mappings:
2025-11-20 18:32:13 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:32:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:32:13 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:32:13 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:32:13 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:32:13 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:32:13 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:32:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:32:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:32:13 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:32:13 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:32:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:13 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:32:13 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:32:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:32:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:32:13 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:34:52 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:52 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:34:52 - data_layer - INFO - ================================================================================
2025-11-20 18:34:52 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:34:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:34:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:34:52 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:34:52 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:34:52 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:34:52 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:34:52 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:34:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - USER MAPPING
2025-11-20 18:34:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - Created user mappings:
2025-11-20 18:34:52 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:34:52 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:52 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:34:52 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:34:52 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:34:52 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:34:52 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:34:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:34:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - Created item mappings:
2025-11-20 18:34:52 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:34:52 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:52 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:34:52 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:34:52 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:34:52 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:34:52 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:34:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:34:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:34:52 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:34:52 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:52 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:34:52 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:34:52 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:52 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:52 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:34:52 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:52 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:34:52 - data_layer - INFO - ================================================================================
2025-11-20 18:34:52 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:34:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:34:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:34:52 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:34:52 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:34:52 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:34:52 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:34:52 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:34:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - USER MAPPING
2025-11-20 18:34:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - Created user mappings:
2025-11-20 18:34:52 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:34:52 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:52 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:34:52 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:34:52 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:34:52 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:34:52 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:34:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:34:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - Created item mappings:
2025-11-20 18:34:52 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:34:52 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:52 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:34:52 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:34:52 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:34:52 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:34:52 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:34:52 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:34:52 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:52 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:34:52 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:34:52 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:52 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:34:52 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:34:52 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:52 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:52 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:34:53 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:53 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:34:53 - data_layer - INFO - ================================================================================
2025-11-20 18:34:53 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:34:53 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:34:53 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:34:53 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:34:53 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:34:53 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - USER MAPPING
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - Created user mappings:
2025-11-20 18:34:53 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:34:53 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:53 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:34:53 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:34:53 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:34:53 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:34:53 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - Created item mappings:
2025-11-20 18:34:53 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:34:53 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:53 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:34:53 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:34:53 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:34:53 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:34:53 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:34:53 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:34:53 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:53 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:34:53 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:34:53 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:53 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:53 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:34:53 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:53 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:34:53 - data_layer - INFO - ================================================================================
2025-11-20 18:34:53 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:34:53 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:34:53 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:34:53 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:34:53 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:34:53 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - USER MAPPING
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - Created user mappings:
2025-11-20 18:34:53 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:34:53 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:53 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:34:53 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:34:53 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:34:53 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:34:53 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - Created item mappings:
2025-11-20 18:34:53 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:34:53 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:53 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:34:53 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:34:53 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:34:53 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:34:53 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:34:53 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:34:53 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:53 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:34:53 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:34:53 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:53 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:53 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - Applied mappings to 369,099 interactions
2025-11-20 18:34:53 - data_layer - INFO -   Added u_idx column: user_id → contiguous [0, 304707]
2025-11-20 18:34:53 - data_layer - INFO -   Added i_idx column: product_id → contiguous [0, 2230]
2025-11-20 18:34:53 - data_layer - INFO - ✓ No missing mappings detected
2025-11-20 18:34:53 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:53 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:34:53 - data_layer - INFO - ================================================================================
2025-11-20 18:34:53 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:34:53 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:34:53 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:34:53 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:34:53 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:34:53 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - USER MAPPING
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - Created user mappings:
2025-11-20 18:34:53 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:34:53 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:53 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:34:53 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:34:53 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:34:53 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:34:53 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - Created item mappings:
2025-11-20 18:34:53 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:34:53 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:53 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:34:53 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:34:53 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:34:53 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:34:53 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:34:53 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:34:53 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:53 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:34:53 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:34:53 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:53 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:53 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:34:53 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:53 - data_layer - INFO - SAVING MAPPINGS TO JSON
2025-11-20 18:34:53 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:58 - data_layer - INFO - Saved mappings to: D:\app\IAI\viecomrec\data\processed\user_item_mappings.json
2025-11-20 18:34:58 - data_layer - INFO -   User mappings: 304,708 entries
2025-11-20 18:34:58 - data_layer - INFO -   Item mappings: 2,231 entries
2025-11-20 18:34:58 - data_layer - INFO -   Metadata included:
2025-11-20 18:34:58 - data_layer - INFO -     - Timestamp: 2025-11-20T18:34:57.562535
2025-11-20 18:34:58 - data_layer - INFO -     - Data hash: 1cbbdf10...
2025-11-20 18:34:58 - data_layer - INFO -     - User ID range: [0, 304707]
2025-11-20 18:34:58 - data_layer - INFO -     - Product ID range: [0, 2235]
2025-11-20 18:34:58 - data_layer - INFO - ✓ Mappings saved successfully
2025-11-20 18:34:59 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:59 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:34:59 - data_layer - INFO - ================================================================================
2025-11-20 18:34:59 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:34:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:59 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:34:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:59 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:34:59 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:34:59 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:34:59 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:34:59 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:34:59 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:34:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:59 - data_layer - INFO - USER MAPPING
2025-11-20 18:34:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:59 - data_layer - INFO - Created user mappings:
2025-11-20 18:34:59 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:34:59 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:59 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:34:59 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:34:59 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:34:59 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:34:59 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:34:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:59 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:34:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:59 - data_layer - INFO - Created item mappings:
2025-11-20 18:34:59 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:34:59 - data_layer - INFO -   Example mappings:
2025-11-20 18:34:59 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:34:59 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:34:59 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:34:59 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:34:59 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:34:59 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:34:59 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:34:59 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:34:59 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:34:59 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:34:59 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:59 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:34:59 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:34:59 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:34:59 - data_layer - INFO - 
================================================================================
2025-11-20 18:34:59 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:35:12 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:12 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:35:12 - data_layer - INFO - ================================================================================
2025-11-20 18:35:12 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:35:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:12 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:35:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:12 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:35:12 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:35:12 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:35:12 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:35:12 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:35:12 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:35:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:12 - data_layer - INFO - USER MAPPING
2025-11-20 18:35:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - Created user mappings:
2025-11-20 18:35:13 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:35:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:13 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:35:13 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:35:13 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:35:13 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:35:13 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:35:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:35:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - Created item mappings:
2025-11-20 18:35:13 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:35:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:13 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:35:13 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:35:13 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:35:13 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:35:13 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:35:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:35:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:35:13 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:35:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:13 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:35:13 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:35:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:13 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:35:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:13 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:35:13 - data_layer - INFO - ================================================================================
2025-11-20 18:35:13 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:35:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:35:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:35:13 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:35:13 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:35:13 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:35:13 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:35:13 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:35:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - USER MAPPING
2025-11-20 18:35:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - Created user mappings:
2025-11-20 18:35:13 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:35:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:13 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:35:13 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:35:13 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:35:13 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:35:13 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:35:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:35:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - Created item mappings:
2025-11-20 18:35:13 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:35:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:13 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:35:13 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:35:13 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:35:13 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:35:13 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:35:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:35:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:35:13 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:35:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:13 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:35:13 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:35:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:13 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:35:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:13 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:35:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - Applied mappings to 369,099 interactions
2025-11-20 18:35:14 - data_layer - INFO -   Added u_idx column: user_id → contiguous [0, 304707]
2025-11-20 18:35:14 - data_layer - INFO -   Added i_idx column: product_id → contiguous [0, 2230]
2025-11-20 18:35:14 - data_layer - INFO - ✓ No missing mappings detected
2025-11-20 18:35:14 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:35:14 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:14 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:35:14 - data_layer - INFO - ================================================================================
2025-11-20 18:35:14 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:35:14 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:35:14 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:35:14 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:35:14 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:35:14 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:35:14 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:35:14 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:35:14 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - USER MAPPING
2025-11-20 18:35:14 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - Created user mappings:
2025-11-20 18:35:14 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:35:14 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:14 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:35:14 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:35:14 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:35:14 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:35:14 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:35:14 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:35:14 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - Created item mappings:
2025-11-20 18:35:14 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:35:14 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:14 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:35:14 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:35:14 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:35:14 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:35:14 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:35:14 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:35:14 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:14 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:35:14 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:35:14 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:14 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:35:14 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:35:14 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:14 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:14 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:35:47 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:47 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:35:47 - data_layer - INFO - ================================================================================
2025-11-20 18:35:47 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:35:47 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:35:47 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:35:47 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:35:47 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:35:47 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:35:47 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:35:47 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:35:47 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - USER MAPPING
2025-11-20 18:35:47 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - Created user mappings:
2025-11-20 18:35:47 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:35:47 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:47 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:35:47 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:35:47 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:35:47 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:35:47 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:35:47 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:35:47 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - Created item mappings:
2025-11-20 18:35:47 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:35:47 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:47 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:35:47 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:35:47 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:35:47 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:35:47 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:35:47 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:35:47 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:35:47 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:35:47 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:47 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:35:47 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:35:47 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:47 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:47 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:35:47 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:47 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:35:47 - data_layer - INFO - ================================================================================
2025-11-20 18:35:47 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:35:47 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:35:47 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:35:47 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:35:47 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:35:47 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:35:47 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:35:47 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:35:47 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - USER MAPPING
2025-11-20 18:35:47 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - Created user mappings:
2025-11-20 18:35:47 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:35:47 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:47 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:35:47 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:35:47 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:35:47 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:35:47 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:35:47 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:35:47 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - Created item mappings:
2025-11-20 18:35:47 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:35:47 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:47 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:35:47 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:35:47 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:35:47 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:35:47 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:35:47 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:47 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:35:47 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:35:48 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:35:48 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:48 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:35:48 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:35:48 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:48 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:48 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:35:48 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:48 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:35:48 - data_layer - INFO - ================================================================================
2025-11-20 18:35:48 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:35:48 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:35:48 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:35:48 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:35:48 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:35:48 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:35:48 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:35:48 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:35:48 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - USER MAPPING
2025-11-20 18:35:48 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - Created user mappings:
2025-11-20 18:35:48 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:35:48 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:48 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:35:48 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:35:48 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:35:48 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:35:48 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:35:48 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:35:48 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - Created item mappings:
2025-11-20 18:35:48 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:35:48 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:48 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:35:48 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:35:48 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:35:48 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:35:48 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:35:48 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:35:48 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:35:48 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:35:48 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:48 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:35:48 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:35:48 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:48 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:48 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:35:48 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:48 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:35:48 - data_layer - INFO - ================================================================================
2025-11-20 18:35:48 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:35:48 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:35:48 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:35:48 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:35:48 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:35:48 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:35:48 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:35:48 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:35:48 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - USER MAPPING
2025-11-20 18:35:48 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - Created user mappings:
2025-11-20 18:35:48 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:35:48 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:48 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:35:48 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:35:48 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:35:48 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:35:48 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:35:48 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:35:48 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - Created item mappings:
2025-11-20 18:35:48 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:35:48 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:48 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:35:48 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:35:48 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:35:48 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:35:48 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:35:48 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:35:48 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:35:48 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:35:48 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:48 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:35:48 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:35:48 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:48 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:48 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:35:48 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:48 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:35:48 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:49 - data_layer - INFO - Applied mappings to 369,099 interactions
2025-11-20 18:35:49 - data_layer - INFO -   Added u_idx column: user_id → contiguous [0, 304707]
2025-11-20 18:35:49 - data_layer - INFO -   Added i_idx column: product_id → contiguous [0, 2230]
2025-11-20 18:35:49 - data_layer - INFO - ✓ No missing mappings detected
2025-11-20 18:35:49 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:49 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:35:49 - data_layer - INFO - ================================================================================
2025-11-20 18:35:49 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:35:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:49 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:35:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:49 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:35:49 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:35:49 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:35:49 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:35:49 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:35:49 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:35:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:49 - data_layer - INFO - USER MAPPING
2025-11-20 18:35:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:49 - data_layer - INFO - Created user mappings:
2025-11-20 18:35:49 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:35:49 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:49 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:35:49 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:35:49 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:35:49 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:35:49 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:35:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:49 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:35:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:49 - data_layer - INFO - Created item mappings:
2025-11-20 18:35:49 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:35:49 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:49 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:35:49 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:35:49 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:35:49 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:35:49 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:35:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:49 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:35:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:49 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:35:49 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:35:49 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:49 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:35:49 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:35:49 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:49 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:49 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:35:49 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:49 - data_layer - INFO - SAVING MAPPINGS TO JSON
2025-11-20 18:35:49 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:56 - data_layer - INFO - Saved mappings to: D:\app\IAI\viecomrec\data\processed\user_item_mappings.json
2025-11-20 18:35:56 - data_layer - INFO -   User mappings: 304,708 entries
2025-11-20 18:35:56 - data_layer - INFO -   Item mappings: 2,231 entries
2025-11-20 18:35:56 - data_layer - INFO -   Metadata included:
2025-11-20 18:35:56 - data_layer - INFO -     - Timestamp: 2025-11-20T18:35:55.330085
2025-11-20 18:35:56 - data_layer - INFO -     - Data hash: 1cbbdf10...
2025-11-20 18:35:56 - data_layer - INFO -     - User ID range: [0, 304707]
2025-11-20 18:35:56 - data_layer - INFO -     - Product ID range: [0, 2235]
2025-11-20 18:35:56 - data_layer - INFO - ✓ Mappings saved successfully
2025-11-20 18:35:57 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:57 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:35:57 - data_layer - INFO - ================================================================================
2025-11-20 18:35:57 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:35:57 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:57 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:35:57 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:57 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:35:57 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:35:57 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:35:57 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:35:57 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:35:57 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:35:57 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:57 - data_layer - INFO - USER MAPPING
2025-11-20 18:35:57 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:57 - data_layer - INFO - Created user mappings:
2025-11-20 18:35:57 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:35:57 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:57 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:35:57 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:35:57 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:35:57 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:35:57 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:35:57 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:57 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:35:57 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:57 - data_layer - INFO - Created item mappings:
2025-11-20 18:35:57 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:35:57 - data_layer - INFO -   Example mappings:
2025-11-20 18:35:57 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:35:57 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:35:57 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:35:57 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:35:57 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:35:57 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:35:57 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:35:57 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:35:57 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:35:57 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:35:57 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:57 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:35:57 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:35:57 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:35:57 - data_layer - INFO - 
================================================================================
2025-11-20 18:35:57 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:36:11 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:11 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:36:11 - data_layer - INFO - ================================================================================
2025-11-20 18:36:11 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:36:11 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:11 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:36:11 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:36:12 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:36:12 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:36:12 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:36:12 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:36:12 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:36:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - USER MAPPING
2025-11-20 18:36:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - Created user mappings:
2025-11-20 18:36:12 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:36:12 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:12 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:36:12 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:36:12 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:36:12 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:36:12 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:36:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:36:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - Created item mappings:
2025-11-20 18:36:12 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:36:12 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:12 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:36:12 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:36:12 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:36:12 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:36:12 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:36:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:36:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:36:12 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:36:12 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:12 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:36:12 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:36:12 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:12 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:12 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:36:12 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:12 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:36:12 - data_layer - INFO - ================================================================================
2025-11-20 18:36:12 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:36:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:36:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:36:12 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:36:12 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:36:12 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:36:12 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:36:12 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:36:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - USER MAPPING
2025-11-20 18:36:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - Created user mappings:
2025-11-20 18:36:12 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:36:12 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:12 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:36:12 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:36:12 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:36:12 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:36:12 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:36:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:36:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - Created item mappings:
2025-11-20 18:36:12 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:36:12 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:12 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:36:12 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:36:12 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:36:12 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:36:12 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:36:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:36:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:36:12 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:36:12 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:12 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:36:12 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:36:12 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:12 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:12 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:36:12 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:12 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:36:12 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - Applied mappings to 369,099 interactions
2025-11-20 18:36:13 - data_layer - INFO -   Added u_idx column: user_id → contiguous [0, 304707]
2025-11-20 18:36:13 - data_layer - INFO -   Added i_idx column: product_id → contiguous [0, 2230]
2025-11-20 18:36:13 - data_layer - INFO - ✓ No missing mappings detected
2025-11-20 18:36:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:36:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:13 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:36:13 - data_layer - INFO - ================================================================================
2025-11-20 18:36:13 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:36:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:36:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:36:13 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:36:13 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:36:13 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:36:13 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:36:13 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:36:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - USER MAPPING
2025-11-20 18:36:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - Created user mappings:
2025-11-20 18:36:13 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:36:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:13 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:36:13 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:36:13 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:36:13 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:36:13 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:36:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:36:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - Created item mappings:
2025-11-20 18:36:13 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:36:13 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:13 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:36:13 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:36:13 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:36:13 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:36:13 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:36:13 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:36:13 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:13 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:36:13 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:36:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:13 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:36:13 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:36:13 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:13 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:13 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:36:50 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:50 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:36:50 - data_layer - INFO - ================================================================================
2025-11-20 18:36:50 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:36:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:36:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:36:50 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:36:50 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:36:50 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:36:50 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:36:50 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:36:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - USER MAPPING
2025-11-20 18:36:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - Created user mappings:
2025-11-20 18:36:50 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:36:50 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:50 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:36:50 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:36:50 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:36:50 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:36:50 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:36:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:36:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - Created item mappings:
2025-11-20 18:36:50 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:36:50 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:50 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:36:50 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:36:50 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:36:50 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:36:50 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:36:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:36:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:36:50 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:36:50 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:50 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:36:50 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:36:50 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:50 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:50 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:36:50 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:50 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:36:50 - data_layer - INFO - ================================================================================
2025-11-20 18:36:50 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:36:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:36:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:36:50 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:36:50 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:36:50 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:36:50 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:36:50 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:36:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - USER MAPPING
2025-11-20 18:36:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - Created user mappings:
2025-11-20 18:36:50 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:36:50 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:50 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:36:50 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:36:50 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:36:50 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:36:50 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:36:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:36:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - Created item mappings:
2025-11-20 18:36:50 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:36:50 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:50 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:36:50 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:36:50 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:36:50 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:36:50 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:36:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:36:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:36:50 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:36:50 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:50 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:36:50 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:36:50 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:50 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:50 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:36:50 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:50 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:36:50 - data_layer - INFO - ================================================================================
2025-11-20 18:36:50 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:36:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:36:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:36:50 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:36:50 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:36:50 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:36:50 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:36:50 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:36:50 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:50 - data_layer - INFO - USER MAPPING
2025-11-20 18:36:50 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - Created user mappings:
2025-11-20 18:36:51 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:36:51 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:51 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:36:51 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:36:51 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:36:51 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:36:51 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - Created item mappings:
2025-11-20 18:36:51 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:36:51 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:51 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:36:51 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:36:51 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:36:51 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:36:51 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:36:51 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:36:51 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:51 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:36:51 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:36:51 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:51 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:51 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:36:51 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:51 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:36:51 - data_layer - INFO - ================================================================================
2025-11-20 18:36:51 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:36:51 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:36:51 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:36:51 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:36:51 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:36:51 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - USER MAPPING
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - Created user mappings:
2025-11-20 18:36:51 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:36:51 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:51 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:36:51 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:36:51 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:36:51 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:36:51 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - Created item mappings:
2025-11-20 18:36:51 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:36:51 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:51 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:36:51 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:36:51 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:36:51 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:36:51 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:36:51 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:36:51 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:51 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:36:51 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:36:51 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:51 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:51 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - Applied mappings to 369,099 interactions
2025-11-20 18:36:51 - data_layer - INFO -   Added u_idx column: user_id → contiguous [0, 304707]
2025-11-20 18:36:51 - data_layer - INFO -   Added i_idx column: product_id → contiguous [0, 2230]
2025-11-20 18:36:51 - data_layer - INFO - ✓ No missing mappings detected
2025-11-20 18:36:51 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:51 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:36:51 - data_layer - INFO - ================================================================================
2025-11-20 18:36:51 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:36:51 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:36:51 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:36:51 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:36:51 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:36:51 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - USER MAPPING
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - Created user mappings:
2025-11-20 18:36:51 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:36:51 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:51 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:36:51 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:36:51 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:36:51 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:36:51 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - Created item mappings:
2025-11-20 18:36:51 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:36:51 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:51 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:36:51 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:36:51 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:36:51 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:36:51 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:36:51 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:36:51 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:51 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:36:51 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:36:51 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:51 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:51 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:36:51 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:51 - data_layer - INFO - SAVING MAPPINGS TO JSON
2025-11-20 18:36:51 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:55 - data_layer - INFO - Saved mappings to: D:\app\IAI\viecomrec\data\processed\user_item_mappings.json
2025-11-20 18:36:55 - data_layer - INFO -   User mappings: 304,708 entries
2025-11-20 18:36:55 - data_layer - INFO -   Item mappings: 2,231 entries
2025-11-20 18:36:55 - data_layer - INFO -   Metadata included:
2025-11-20 18:36:55 - data_layer - INFO -     - Timestamp: 2025-11-20T18:36:55.094417
2025-11-20 18:36:55 - data_layer - INFO -     - Data hash: 1cbbdf10...
2025-11-20 18:36:55 - data_layer - INFO -     - User ID range: [0, 304707]
2025-11-20 18:36:55 - data_layer - INFO -     - Product ID range: [0, 2235]
2025-11-20 18:36:55 - data_layer - INFO - ✓ Mappings saved successfully
2025-11-20 18:36:56 - data_layer - INFO - 
Loading mappings from: D:\app\IAI\viecomrec\data\processed\user_item_mappings.json
2025-11-20 18:36:56 - data_layer - INFO -   Loaded metadata:
2025-11-20 18:36:56 - data_layer - INFO -     - Created at: 2025-11-20T18:36:55.094417
2025-11-20 18:36:56 - data_layer - INFO -     - Num users: 304,708
2025-11-20 18:36:56 - data_layer - INFO -     - Num items: 2,231
2025-11-20 18:36:56 - data_layer - INFO -     - Data hash: 1cbbdf10...
2025-11-20 18:36:56 - data_layer - INFO - ✓ Loaded 304,708 user mappings, 2,231 item mappings
2025-11-20 18:36:56 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:56 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:36:56 - data_layer - INFO - ================================================================================
2025-11-20 18:36:56 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:36:56 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:56 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:36:56 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:57 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:36:57 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:36:57 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:36:57 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:36:57 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:36:57 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:36:57 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:57 - data_layer - INFO - USER MAPPING
2025-11-20 18:36:57 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:57 - data_layer - INFO - Created user mappings:
2025-11-20 18:36:57 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:36:57 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:57 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:36:57 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:36:57 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:36:57 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:36:57 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:36:57 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:57 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:36:57 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:57 - data_layer - INFO - Created item mappings:
2025-11-20 18:36:57 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:36:57 - data_layer - INFO -   Example mappings:
2025-11-20 18:36:57 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:36:57 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:36:57 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:36:57 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:36:57 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:36:57 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:36:57 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:36:57 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:36:57 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:36:57 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:36:57 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:57 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:36:57 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:36:57 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:36:57 - data_layer - INFO - 
================================================================================
2025-11-20 18:36:57 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:37:07 - data_layer - INFO - 
================================================================================
2025-11-20 18:37:07 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:37:07 - data_layer - INFO - ================================================================================
2025-11-20 18:37:07 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:37:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:37:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:37:07 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:37:07 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:37:07 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:37:07 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:37:07 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:37:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - USER MAPPING
2025-11-20 18:37:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - Created user mappings:
2025-11-20 18:37:07 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:37:07 - data_layer - INFO -   Example mappings:
2025-11-20 18:37:07 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:37:07 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:37:07 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:37:07 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:37:07 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:37:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:37:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - Created item mappings:
2025-11-20 18:37:07 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:37:07 - data_layer - INFO -   Example mappings:
2025-11-20 18:37:07 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:37:07 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:37:07 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:37:07 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:37:07 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:37:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:37:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:37:07 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:37:07 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:37:07 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:37:07 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:37:07 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:37:07 - data_layer - INFO - 
================================================================================
2025-11-20 18:37:07 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:37:07 - data_layer - INFO - 
================================================================================
2025-11-20 18:37:07 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:37:07 - data_layer - INFO - ================================================================================
2025-11-20 18:37:07 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:37:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:37:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:37:07 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:37:07 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:37:07 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:37:07 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:37:07 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:37:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - USER MAPPING
2025-11-20 18:37:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - Created user mappings:
2025-11-20 18:37:07 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:37:07 - data_layer - INFO -   Example mappings:
2025-11-20 18:37:07 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:37:07 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:37:07 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:37:07 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:37:07 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:37:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:37:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - Created item mappings:
2025-11-20 18:37:07 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:37:07 - data_layer - INFO -   Example mappings:
2025-11-20 18:37:07 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:37:07 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:37:07 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:37:07 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:37:07 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:37:07 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:37:07 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:07 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:37:07 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:37:07 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:37:07 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:37:07 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:37:07 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:37:07 - data_layer - INFO - 
================================================================================
2025-11-20 18:37:07 - data_layer - INFO - ✓ ID mappings created successfully
2025-11-20 18:37:08 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:37:08 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - Applied mappings to 369,099 interactions
2025-11-20 18:37:08 - data_layer - INFO -   Added u_idx column: user_id → contiguous [0, 304707]
2025-11-20 18:37:08 - data_layer - INFO -   Added i_idx column: product_id → contiguous [0, 2230]
2025-11-20 18:37:08 - data_layer - INFO - ✓ No missing mappings detected
2025-11-20 18:37:08 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - APPLYING MAPPINGS TO INTERACTIONS
2025-11-20 18:37:08 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - 
================================================================================
2025-11-20 18:37:08 - data_layer - INFO - STEP 3: ID MAPPING (CONTIGUOUS INDEXING)
2025-11-20 18:37:08 - data_layer - INFO - ================================================================================
2025-11-20 18:37:08 - data_layer - INFO - Mapping sparse IDs to contiguous indices for efficient matrix operations
2025-11-20 18:37:08 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - EXTRACTING UNIQUE IDs
2025-11-20 18:37:08 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - Unique users: 304,708
2025-11-20 18:37:08 - data_layer - INFO -   Original user_id range: [0, 304707]
2025-11-20 18:37:08 - data_layer - INFO -   Sparse user_id range span: 304,707
2025-11-20 18:37:08 - data_layer - INFO - 
Unique items: 2,231
2025-11-20 18:37:08 - data_layer - INFO -   Original product_id range: [0, 2235]
2025-11-20 18:37:08 - data_layer - INFO -   Sparse product_id range span: 2,235
2025-11-20 18:37:08 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - USER MAPPING
2025-11-20 18:37:08 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - Created user mappings:
2025-11-20 18:37:08 - data_layer - INFO -   user_id (sparse) → u_idx (contiguous 0-304707)
2025-11-20 18:37:08 - data_layer - INFO -   Example mappings:
2025-11-20 18:37:08 - data_layer - INFO -     user_id 0 → u_idx 0
2025-11-20 18:37:08 - data_layer - INFO -     user_id 1 → u_idx 1
2025-11-20 18:37:08 - data_layer - INFO -     user_id 2 → u_idx 2
2025-11-20 18:37:08 - data_layer - INFO -     user_id 3 → u_idx 3
2025-11-20 18:37:08 - data_layer - INFO -     user_id 4 → u_idx 4
2025-11-20 18:37:08 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - ITEM MAPPING
2025-11-20 18:37:08 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - Created item mappings:
2025-11-20 18:37:08 - data_layer - INFO -   product_id (sparse) → i_idx (contiguous 0-2230)
2025-11-20 18:37:08 - data_layer - INFO -   Example mappings:
2025-11-20 18:37:08 - data_layer - INFO -     product_id 0 → i_idx 0
2025-11-20 18:37:08 - data_layer - INFO -     product_id 1 → i_idx 1
2025-11-20 18:37:08 - data_layer - INFO -     product_id 2 → i_idx 2
2025-11-20 18:37:08 - data_layer - INFO -     product_id 3 → i_idx 3
2025-11-20 18:37:08 - data_layer - INFO -     product_id 4 → i_idx 4
2025-11-20 18:37:08 - data_layer - INFO - 
--------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - VALIDATING MAPPINGS
2025-11-20 18:37:08 - data_layer - INFO - --------------------------------------------------------------------------------
2025-11-20 18:37:08 - data_layer - INFO - ✓ User mappings validated:
2025-11-20 18:37:08 - data_layer - INFO -   - Contiguous indices: [0, 304707]
2025-11-20 18:37:08 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:37:08 - data_layer - INFO - ✓ Item mappings validated:
2025-11-20 18:37:08 - data_layer - INFO -   - Contiguous indices: [0, 2230]
2025-11-20 18:37:08 - data_layer - INFO -   - Bidirectional consistency: OK
2025-11-20 18:37:08 - data_layer - INFO - 
================================================================================
2025-11-20 18:37:08 - data_layer - INFO - ✓ ID mappings created successfully
